<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="1/14/2021 2:06:05 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="2WNP172"
  DTS:CreatorName="VAGASTEC\fiama.cristi"
  DTS:DTSID="{B161C41B-9577-44B0-A97F-89CBA13F92BD}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="14.0.3026.27"
  DTS:LocaleID="1046"
  DTS:ObjectName="ContatosVagas"
  DTS:PackageType="5"
  DTS:ProtectionLevel="2"
  DTS:VersionBuild="84"
  DTS:VersionGUID="{CCD4B16F-24D7-498D-A0A8-2A65CA5ED498}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[CSV ContatosVagas]"
      DTS:CreationName="FLATFILE"
      DTS:DTSID="{ED3F49EB-7413-41D9-A8B4-449E8FB5DC63}"
      DTS:ObjectName="CSV ContatosVagas">
      <DTS:PropertyExpression
        DTS:Name="ConnectionString">@[$Project::CSV_DIR] + "\\" + REPLACE(SUBSTRING((DT_STR,30,1252)GETDATE(),1,10),"-","_") + "\\" + @[$Package::CSV_NAME]</DTS:PropertyExpression>
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:Format="Delimited"
          DTS:LocaleID="1046"
          DTS:HeaderRowDelimiter="_x000D__x000A_"
          DTS:ColumnNamesInFirstDataRow="True"
          DTS:RowDelimiter=""
          DTS:TextQualifier="_x003C_none_x003E_"
          DTS:CodePage="1252"
          DTS:ConnectionString="C:\Users\fiama.cristi\Documents\integracao_sensedata\ftp\2021_01_19\contatos_vagas.csv">
          <DTS:FlatFileColumns>
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:DataType="3"
              DTS:TextQualified="True"
              DTS:ObjectName="ID_Integracao"
              DTS:DTSID="{CD0E3B6F-E92F-451C-AF0D-FDF3924762FF}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:DataType="3"
              DTS:TextQualified="True"
              DTS:ObjectName="Cod_cli"
              DTS:DTSID="{1ECAE453-46B6-4B11-B197-C5AA2C4038E1}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:DataType="3"
              DTS:TextQualified="True"
              DTS:ObjectName="Cod_func"
              DTS:DTSID="{24ED1AB8-6FDF-47ED-B489-3C53F42B88DB}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="300"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Nome"
              DTS:DTSID="{905D3811-DC19-4AAC-BD7A-519C1E497960}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="300"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Email"
              DTS:DTSID="{921122C4-AE7A-4E06-9960-F8AD7112E6AC}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="8000"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Telefone1"
              DTS:DTSID="{E8F41C2F-B990-4CAF-BB3E-55C4A3423419}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="8000"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Telefone2"
              DTS:DTSID="{A04C2A6E-E4B8-400B-8D84-D4BEB67FA6BD}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="300"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="ID_Contato_CRM"
              DTS:DTSID="{1590E861-433A-422C-953A-B8A26D73C756}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="300"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="ID_Cliente_CRM"
              DTS:DTSID="{A7AE613A-44B0-4701-A2A4-BFF0DB5BD59C}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="300"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Cargo"
              DTS:DTSID="{49A980AB-793A-4AEE-AFBC-D7B1B29F309A}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="300"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Tipo_usuario"
              DTS:DTSID="{523EE30B-3514-48D8-9174-59A0C7FF9424}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="300"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Dias_ultimo_treinamento"
              DTS:DTSID="{BFE78F48-1615-4C0D-B00E-08678E2C55D0}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="300"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Treinamentos_realizados"
              DTS:DTSID="{14E930F9-8A23-4FE4-8F92-264B30A791E9}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:DataType="133"
              DTS:TextQualified="True"
              DTS:ObjectName="Data_ultimo_treinamento"
              DTS:DTSID="{C9FF6907-198D-4114-BC7F-1561E98D9FFC}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="300"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Ultimo_login"
              DTS:DTSID="{2DCC573B-36E5-42F2-B1AD-47E64A51BC15}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="300"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Divisao"
              DTS:DTSID="{0B7F7E49-E19F-4EC5-AEF1-C04369D81E6E}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="300"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Sponsor"
              DTS:DTSID="{C16712D6-E7A2-40DF-9B73-F1188D9B7869}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="300"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Elegivel_disparos"
              DTS:DTSID="{5F114534-C445-40CC-9149-CDF5E266598A}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:DataType="133"
              DTS:TextQualified="True"
              DTS:ObjectName="Data_atualizacao_contato"
              DTS:DTSID="{47BE18D9-1EB1-46ED-B947-3DB3F3B4FD3F}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="3"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Email_duplicado"
              DTS:DTSID="{A2603C8E-9865-49EA-A6C3-1355ECEB049C}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="300"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Usuario_ativo"
              DTS:DTSID="{B4B55532-60D3-4FAA-8634-6BA523468A1A}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:DataType="133"
              DTS:TextQualified="True"
              DTS:ObjectName="Data_ultimo_login"
              DTS:DTSID="{490D8538-DEC0-47FE-89B3-5B94A97B089C}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x000D__x000A_"
              DTS:MaximumWidth="8000"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Modulos_de_treinamentos_realizados"
              DTS:DTSID="{DE9A88E9-BC4D-4026-B603-8C2DF82A660F}"
              DTS:CreationName="" />
          </DTS:FlatFileColumns>
        </DTS:ConnectionManager>
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:PackageParameters>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{FE3B743D-95D4-44AE-AC3A-6792538ACB55}"
      DTS:ObjectName="CSV_NAME">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">contatos_vagas.csv</DTS:Property>
    </DTS:PackageParameter>
  </DTS:PackageParameters>
  <DTS:Variables />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Altera o collation pra gerar a tabela Contatos_sensedata_integracao"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarefa Executar SQL"
      DTS:DTSID="{C878E553-009D-40CE-BE26-7EA0A49AED60}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Altera o collation pra gerar a tabela Contatos_sensedata_integracao"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C9C5C2E3-4F23-4A32-8949-107BB2A1C923}"
          SQLTask:SqlStatementSource="-- Ajusta o Collation pra fazer o merge dos registros:&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata] ALTER COLUMN Nome VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata] ALTER COLUMN Email VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata] ALTER COLUMN Telefone1 VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata] ALTER COLUMN Telefone2 VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata] ALTER COLUMN Cod_contato_CRM VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata] ALTER COLUMN Cod_conta_CRM VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata] ALTER COLUMN Cargo VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata] ALTER COLUMN Tipo_usuario VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata] ALTER COLUMN Dias_ultimo_treinamento VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata] ALTER COLUMN Treinamentos_realizados VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata] ALTER COLUMN Ultimo_login VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata] ALTER COLUMN Divisao VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata] ALTER COLUMN Sponsor VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata] ALTER COLUMN Elegivel_disparos VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata] ALTER COLUMN Linkedin VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata] ALTER COLUMN Contato_ativo VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata] ALTER COLUMN Usuario_ativo VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;&#xA;-- Ajusta o Collation pra fazer o merge dos registros:&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata_CRM] ALTER COLUMN Nome VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata_CRM] ALTER COLUMN Email VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata_CRM] ALTER COLUMN Telefone1 VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata_CRM] ALTER COLUMN Telefone2 VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata_CRM] ALTER COLUMN Cod_contato_CRM VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata_CRM] ALTER COLUMN Cod_conta_CRM VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata_CRM] ALTER COLUMN Cargo VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata_CRM] ALTER COLUMN Tipo_usuario VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata_CRM] ALTER COLUMN Dias_ultimo_treinamento VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata_CRM] ALTER COLUMN Treinamentos_realizados VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata_CRM] ALTER COLUMN Ultimo_login VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata_CRM] ALTER COLUMN Divisao VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata_CRM] ALTER COLUMN Sponsor VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata_CRM] ALTER COLUMN Elegivel_disparos VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata_CRM] ALTER COLUMN Linkedin VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata_CRM] ALTER COLUMN Contato_ativo VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;ALTER TABLE [stage].[VAGAS_DW].[Contatos_sensedata_CRM] ALTER COLUMN Usuario_ativo VARCHAR(300) COLLATE SQL_Latin1_General_CP1_CI_AI ;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Contatos_CRM -&gt; Contatos_sensedata_stage_CRM"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarefa Executar SQL"
      DTS:DTSID="{EE39B5E7-EADB-4A2E-B8B9-BEB1D91FAB3D}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Contatos_CRM -&gt; Contatos_sensedata_stage_CRM"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C9C5C2E3-4F23-4A32-8949-107BB2A1C923}"
          SQLTask:SqlStatementSource="DROP TABLE IF EXISTS [stage].[VAGAS_DW].[Contatos_sensedata_stage_CRM]&#xA;SELECT&#x9;NULL AS Cod_func,&#xA;&#x9;&#x9;CONCAT(Contt_CRM.NOME,' ', Contt_CRM.SOBRENOME) Nome,&#xA;&#x9;&#x9;Contt_CRM.EMAIL AS Email,&#xA;&#x9;&#x9;ISNULL(Contt_CRM.TELEFONE_CELULAR, Contt_CRM.TELEFONE_CONTATO) AS Telefone1,&#xA;&#x9;&#x9;Contt_CRM.TELEFONE_OUTRO AS Telefone2,&#xA;&#x9;&#x9;Contt_CRM.COD_CONTATO AS Cod_contato_CRM,&#xA;&#x9;&#x9;Contt_CRM.COD_CONTA_CRM AS Cod_conta_CRM,&#xA;&#x9;&#x9;(SELECT TOP 1 Cod_cli&#xA;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[SNAPSHOT_CLIENTES_SENSEDATA_STATUS] AS Snp_sdt_A1&#xA;&#x9;&#x9;&#x9;WHERE&#x9;Contt_CRM.COD_CONTA_CRM = Snp_sdt_A1.CONTA_ID) AS Cod_cli,&#xA;&#x9;&#x9;Contt_CRM.CARGO AS Cargo,&#xA;&#x9;&#x9;'Contato CRM' AS Tipo_usuario,&#xA;&#x9;&#x9;(SELECT&#x9;CONVERT(DATE, MAX(Trn.DATA_REALIZACAO_INICIO)) AS Data_ultimo_treinamento&#xA;&#x9;&#x9; FROM&#x9;[vagas_dw].[VAGAS_DW].[TREINAMENTOS_PARTICIPANTES_CRM] AS Trn_particip_A1&#x9;&#x9;INNER JOIN [vagas_dw].[VAGAS_DW].[TREINAMENTOS_CRM] AS Trn&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ON Trn_particip_A1.ID_TREINAMENTO = Trn.ID_TREINAMENTO&#xA;&#x9;&#x9; WHERE&#x9;Trn_particip_A1.STATUS_PARTICIPANTE = 'PARTICIPOU'&#xA;&#x9;&#x9;&#x9;&#x9;AND Trn.STATUS = 'REALIZADO'&#xA;&#x9;&#x9;&#x9;&#x9;AND Contt_CRM.COD_CONTATO = Trn_particip_A1.COD_CONTATO_TREINAMENTO) AS Data_ultimo_treinamento,&#xA;&#x9;&#x9;(SELECT&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN DATEDIFF (DAY, CONVERT(DATE, MAX(Trn.DATA_REALIZACAO_INICIO)), CONVERT(DATE, GETDATE())) &lt;= 30   THEN '[1ª faixa - 0 a 30 dias]'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN DATEDIFF (DAY, CONVERT(DATE, MAX(Trn.DATA_REALIZACAO_INICIO)), CONVERT(DATE, GETDATE())) &gt; 30  and  DATEDIFF (DAY, CONVERT(DATE, MAX(Trn.DATA_REALIZACAO_INICIO)), CONVERT(DATE, GETDATE())) &lt;= 90 THEN '[2ª faixa - 31 a 90 dias]'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN DATEDIFF (DAY, CONVERT(DATE, MAX(Trn.DATA_REALIZACAO_INICIO)), CONVERT(DATE, GETDATE())) &gt; 90 THEN '[3ª faixa - acima de 90 dias]'&#xA;&#x9;&#x9;&#x9;&#x9;END AS Dias_ultimo_treinamento&#xA;&#x9;&#x9; FROM&#x9;[vagas_dw].[VAGAS_DW].[TREINAMENTOS_PARTICIPANTES_CRM] AS Trn_particip_A1&#x9;&#x9;INNER JOIN [vagas_dw].[VAGAS_DW].[TREINAMENTOS_CRM] AS Trn&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ON Trn_particip_A1.ID_TREINAMENTO = Trn.ID_TREINAMENTO&#xA;&#x9;&#x9; WHERE&#x9;Trn_particip_A1.STATUS_PARTICIPANTE = 'PARTICIPOU'&#xA;&#x9;&#x9;&#x9;&#x9;AND Trn.STATUS = 'REALIZADO'&#xA;&#x9;&#x9;&#x9;&#x9;AND Contt_CRM.COD_CONTATO = Trn_particip_A1.COD_CONTATO_TREINAMENTO) AS Dias_ultimo_treinamento,&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;(SELECT&#x9;STRING_AGG('['+Trn_A1.NOME_TREINAMENTO+']', ',') AS Treinamentos_realizados&#xA;&#x9;&#x9; FROM&#x9;[vagas_dw].[VAGAS_DW].[CONTATOS_CRM] AS Contt_CRM_A1&#x9;INNER JOIN &#xA;&#x9;&#x9; (SELECT Trn_particip_AA1.COD_CONTATO_TREINAMENTO,&#xA;&#x9;&#x9;&#x9;&#x9; Trn_AA1.NOME_TREINAMENTO&#xA;&#x9;&#x9;  FROM&#x9; [vagas_dw].[VAGAS_DW].[TREINAMENTOS_PARTICIPANTES_CRM] AS Trn_particip_AA1&#x9;&#x9;INNER JOIN [vagas_dw].[VAGAS_DW].[TREINAMENTOS_CRM] AS Trn_AA1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ON Trn_particip_AA1.ID_TREINAMENTO = Trn_AA1.ID_TREINAMENTO&#xA;&#x9;&#x9;  WHERE&#x9; Trn_particip_AA1.STATUS_PARTICIPANTE = 'PARTICIPOU'&#xA;&#x9;&#x9;&#x9;&#x9; AND Trn_AA1.STATUS = 'REALIZADO'&#xA;&#x9;&#x9;&#x9;&#x9; AND Contt_CRM.COD_CONTATO = Trn_particip_AA1.COD_CONTATO_TREINAMENTO) AS Trn_A1 ON Contt_CRM_A1.COD_CONTATO = Trn_A1.COD_CONTATO_TREINAMENTO&#xA;&#x9;&#x9;  GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;Contt_CRM_A1.COD_CONTATO) AS Treinamentos_realizados,&#xA;&#x9;&#x9;NULL AS Ultimo_login,&#xA;&#x9;&#x9;NULL AS Divisao,&#xA;&#x9;&#x9;Contt_CRM.CONTATO_PRINCIPAL AS Sponsor,&#xA;&#x9;&#x9;NULL AS Elegivel_disparos,&#xA;&#x9;&#x9;NULL AS Linkedin,&#xA;&#x9;&#x9;NULL AS Contato_ativo,&#xA;&#x9;&#x9;Contt_CRM.DATA_MODIFICACAO AS Data_modificacao,&#xA;&#x9;&#x9;Contt_CRM.DtUltAtividade AS Data_ultima_atividade,&#xA;&#x9;&#x9;IIF(Contt_CRM.FUNCIONARIO_DESLIGADO = 'SIM', 'Sim', 'Não')  AS Usuario_ativo&#xA;INTO&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_stage_CRM]&#xA;FROM&#x9;[vagas_dw].[VAGAS_DW].[CONTATOS_CRM] AS Contt_CRM&#xA;WHERE&#x9;EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[SNAPSHOT_CLIENTES_SENSEDATA_STATUS] AS Snp_sdt&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Contt_CRM.COD_CONTA_CRM = Snp_sdt.CONTA_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND LEFT(Snp_sdt.STATUS_CONTA_ID, 5) = 'ATIVO')&#xA;&#x9;&#x9;AND ISNULL(Contt_CRM.EMAIL, '') &lt;&gt; '' ;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Contatos_sensedata - Elegíveis pro Merge"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarefa Executar SQL"
      DTS:DTSID="{A014D469-4951-415A-B633-A79082A082C0}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Contatos_sensedata - Elegíveis pro Merge"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C9C5C2E3-4F23-4A32-8949-107BB2A1C923}"
          SQLTask:SqlStatementSource="-- Limpa o campo que informa se o registro é elegível pro Merge, pois esta informação pode ser alterada com o passar do tempo:&#xA;UPDATE [stage].[VAGAS_DW].[Contatos_sensedata] SET RegElegivelMerge_Controle = NULL ;&#xA;&#xA;-- E-mail existe 1x no VFB (E-mail e Cod_cli): (Base origem VFB pro Merge)&#xA;UPDATE&#x9;[stage].[VAGAS_DW].[Contatos_sensedata]&#xA;SET&#x9;&#x9;RegElegivelMerge_Controle = 1&#xA;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata] AS Contt_VFB&#xA;WHERE&#x9;NOT EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata] AS Contt_VFB_A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Contt_VFB.Cod_func = Contt_VFB_A1.Cod_func&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND EXISTS (SELECT&#x9;COUNT(*)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata] AS Contt_VFB_AA1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Contt_VFB_A1.Email = Contt_VFB_AA1.Email&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Contt_VFB_A1.Cod_cli = Contt_VFB_AA1.Cod_cli&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Email&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;HAVING COUNT(*) &gt; 1)) ;&#xA;&#xA;&#xA;-- E-mail duplica no VFB (E-mail e Cod_cli) --&gt; Não será considerado no Merge, serão carregados puramente com os dados do VFB&#xA;UPDATE&#x9;[stage].[VAGAS_DW].[Contatos_sensedata]&#xA;SET&#x9;&#x9;RegElegivelMerge_Controle = 0&#xA;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata] AS Contt_VFB&#xA;WHERE&#x9;EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata] AS Contt_VFB_A1&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Contt_VFB.Cod_func = Contt_VFB_A1.Cod_func&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND EXISTS (SELECT&#x9;COUNT(*)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata] AS Contt_VFB_AA1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Contt_VFB_A1.Email = Contt_VFB_AA1.Email&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Contt_VFB_A1.Cod_cli = Contt_VFB_AA1.Cod_cli&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Email&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;HAVING COUNT(*) &gt; 1)) ;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Contatos_sensedata -&gt; Contatos_sensedata_log (VFB)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarefa Executar SQL"
      DTS:Disabled="True"
      DTS:DTSID="{F42B2938-B984-45BD-8202-F1D8250EEA88}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Contatos_sensedata -&gt; Contatos_sensedata_log (VFB)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C9C5C2E3-4F23-4A32-8949-107BB2A1C923}"
          SQLTask:SqlStatementSource="INSERT INTO [stage].[VAGAS_DW].[Contatos_sensedata_log](cod_func,nome,email,telefone1,telefone2,cod_contato_crm,cod_conta_crm,cod_cli,cargo,tipo_usuario,data_ultimo_treinamento,dias_ultimo_treinamento,treinamentos_realizados,ultimo_login,divisao,sponsor,elegivel_disparos,linkedin,contato_ativo,cod_contato_sd,regelegivelmerge_controle,data_log)&#xA;SELECT Cod_func,Nome,Email,Telefone1,Telefone2,Cod_contato_CRM,Cod_conta_CRM,Cod_cli,Cargo,Tipo_usuario,Data_ultimo_treinamento,Dias_ultimo_treinamento,Treinamentos_realizados,Ultimo_login,Divisao,Sponsor,Elegivel_disparos,Linkedin,Contato_ativo,Cod_contato_SD,RegElegivelMerge_Controle,Data_atualizacao_contato&#xA;FROM [stage].[VAGAS_DW].[Contatos_sensedata]  AS Ctt&#xA;WHERE&#x9;NOT EXISTS   (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;  FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_log] AS Ctt_log_A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;  WHERE&#x9;Ctt.Cod_func = Ctt_log_A1.Cod_func&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Ctt_log_A1.Data_log =  (SELECT&#x9;Ctt_A1.Data_atualizacao_contato&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAs_DW].[Contatos_sensedata] AS Ctt_A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Ctt.Cod_func = Ctt_A1.Cod_func))&#xA;&#x9;&#x9;AND Ctt.Contato_ativo = 'Não' ;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Contatos_sensedata_integracao"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarefa Executar SQL"
      DTS:DTSID="{E32D7D37-F13A-4DFF-B562-4F6B788F7067}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Contatos_sensedata_integracao"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C9C5C2E3-4F23-4A32-8949-107BB2A1C923}"
          SQLTask:SqlStatementSource="-- Gera a tabela [stage].[VAGAS_DW].[contatos_sensedata_integracao]:&#xA;DROP TABLE IF EXISTS [stage].[VAGAS_DW].[contatos_sensedata_integracao] ;&#xA;SELECT&#x9;ID_Integracao,&#xA;&#x9;&#x9;Cod_cli,&#xA;&#x9;&#x9;Cod_func,&#xA;&#x9;&#x9;REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(Nome)),CHAR(9),''),CHAR(10),''),CHAR(13),'') AS Nome,&#xA;&#x9;&#x9;REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(Email)),CHAR(9),''),CHAR(10),''),CHAR(13),'') AS Email,&#xA;&#x9;&#x9;--  IIF(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone1))),CHAR(9),''),CHAR(10),''),CHAR(13),'') = REPLICATE(LEFT(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone1))),CHAR(9),''),CHAR(10),''),CHAR(13),''),1),LEN(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone1))),CHAR(9),''),CHAR(10),''),CHAR(13),''))), '', REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone1))),CHAR(9),''),CHAR(10),''),CHAR(13),'')) AS Telefone1,&#xA;&#x9;&#x9;  CASE WHEN IIF(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone1))),CHAR(9),''),CHAR(10),''),CHAR(13),'') = REPLICATE(LEFT(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone1))),CHAR(9),''),CHAR(10),''),CHAR(13),''),1),LEN(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone1))),CHAR(9),''),CHAR(10),''),CHAR(13),''))), '', REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone1))),CHAR(9),''),CHAR(10),''),CHAR(13),'')) &lt;&gt; '' AND LEN(IIF(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone1))),CHAR(9),''),CHAR(10),''),CHAR(13),'') = REPLICATE(LEFT(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone1))),CHAR(9),''),CHAR(10),''),CHAR(13),''),1),LEN(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone1))),CHAR(9),''),CHAR(10),''),CHAR(13),''))), '', REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone1))),CHAR(9),''),CHAR(10),''),CHAR(13),''))) &lt; 8 THEN '' ELSE IIF(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone1))),CHAR(9),''),CHAR(10),''),CHAR(13),'') = REPLICATE(LEFT(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone1))),CHAR(9),''),CHAR(10),''),CHAR(13),''),1),LEN(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone1))),CHAR(9),''),CHAR(10),''),CHAR(13),''))), '', REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone1))),CHAR(9),''),CHAR(10),''),CHAR(13),'')) END AS Telefone1,&#xA;&#x9;&#x9;  --IIF(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone2))),CHAR(9),''),CHAR(10),''),CHAR(13),'') = REPLICATE(LEFT(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone2))),CHAR(9),''),CHAR(10),''),CHAR(13),''),1),LEN(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone2))),CHAR(9),''),CHAR(10),''),CHAR(13),''))), '', REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone2))),CHAR(9),''),CHAR(10),''),CHAR(13),'')) AS Telefone2,&#xA;&#x9;&#x9;  CASE WHEN IIF(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone2))),CHAR(9),''),CHAR(10),''),CHAR(13),'') = REPLICATE(LEFT(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone2))),CHAR(9),''),CHAR(10),''),CHAR(13),''),1),LEN(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone2))),CHAR(9),''),CHAR(10),''),CHAR(13),''))), '', REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone2))),CHAR(9),''),CHAR(10),''),CHAR(13),'')) &lt;&gt; '' AND LEN(IIF(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone2))),CHAR(9),''),CHAR(10),''),CHAR(13),'') = REPLICATE(LEFT(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone2))),CHAR(9),''),CHAR(10),''),CHAR(13),''),1),LEN(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone2))),CHAR(9),''),CHAR(10),''),CHAR(13),''))), '', REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone2))),CHAR(9),''),CHAR(10),''),CHAR(13),''))) &lt; 8 THEN '' ELSE IIF(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone2))),CHAR(9),''),CHAR(10),''),CHAR(13),'') = REPLICATE(LEFT(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone2))),CHAR(9),''),CHAR(10),''),CHAR(13),''),1),LEN(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone2))),CHAR(9),''),CHAR(10),''),CHAR(13),''))), '', REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(dbo.fn_GetNumbersOnly(Telefone2))),CHAR(9),''),CHAR(10),''),CHAR(13),'')) END AS Telefone2,&#xA;&#x9;&#x9;REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(ID_Contato_CRM)),CHAR(9),''),CHAR(10),''),CHAR(13),'') AS ID_Contato_CRM,&#xA;&#x9;&#x9;REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(ID_Cliente_CRM)),CHAR(9),''),CHAR(10),''),CHAR(13),'') AS ID_Cliente_CRM,&#xA;&#x9;&#x9;REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(Cargo)),CHAR(9),''),CHAR(10),''),CHAR(13),'') AS Cargo,&#xA;&#x9;&#x9;REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(Tipo_usuario)),CHAR(9),''),CHAR(10),''),CHAR(13),'') AS Tipo_usuario,&#xA;&#x9;&#x9;Dias_ultimo_treinamento,&#xA;&#x9;&#x9;REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(Treinamentos_realizados)),CHAR(9),''),CHAR(10),''),CHAR(13),'') AS Treinamentos_realizados,&#xA;&#x9;&#x9;Data_ultimo_treinamento,&#xA;&#x9;&#x9;REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(Ultimo_login)),CHAR(9),''),CHAR(10),''),CHAR(13),'') AS Ultimo_login,&#xA;&#x9;&#x9;REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(Divisao)),CHAR(9),''),CHAR(10),''),CHAR(13),'') AS Divisao,&#xA;&#x9;&#x9;REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(Sponsor)),CHAR(9),''),CHAR(10),''),CHAR(13),'') AS Sponsor,&#xA;&#x9;&#x9;REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(Elegivel_disparos)),CHAR(9),''),CHAR(10),''),CHAR(13),'') AS Elegivel_disparos,&#xA;&#x9;&#x9;Linkedin,&#xA;&#x9;&#x9;Data_atualizacao_contato,&#xA;&#x9;&#x9;Email_duplicado,&#xA;&#x9;&#x9;Usuario_ativo ,&#xA;&#x9;&#x9;Fonte_contato_SD&#xA;INTO&#x9;[stage].[VAGAS_DW].[contatos_sensedata_integracao]&#xA;FROM&#x9;(&#xA;SELECT&#x9;ID_Integracao,&#xA;&#x9;&#x9;Cod_cli,&#xA;&#x9;&#x9;Cod_func,&#xA;&#x9;&#x9;REPLACE(REPLACE(Nome,'|','/'),';','') AS Nome,&#xA;&#x9;&#x9;REPLACE(REPLACE(Email,'|','/'),';','') AS Email,&#xA;&#x9;&#x9;REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(Telefone1)),CHAR(9),''),CHAR(10),''),CHAR(13),''), '+', ''), '-', ''), ',', ''), '.', ''),'|','/'),';','') AS Telefone1,&#xA;&#x9;&#x9;REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(Telefone2)),CHAR(9),''),CHAR(10),''),CHAR(13),''), '+', ''), '-', ''), ',', ''), '.', ''),'|','/'),';','') AS Telefone2,&#xA;&#x9;&#x9;ID_Contato_CRM,&#xA;&#x9;&#x9;ID_Cliente_CRM,&#xA;&#x9;&#x9;REPLACE(Cargo,'|','/') AS Cargo,&#xA;&#x9;&#x9;Tipo_usuario,&#xA;&#x9;&#x9;Dias_ultimo_treinamento,&#xA;&#x9;&#x9;Treinamentos_realizados,&#xA;&#x9;&#x9;Data_ultimo_treinamento,&#xA;&#x9;&#x9;Ultimo_login,&#xA;&#x9;&#x9;Contato_ativo,&#xA;&#x9;&#x9;Fonte_contato_SD,&#xA;&#x9;&#x9;REPLACE(REPLACE(Divisao,'|','/'),';','') AS Divisao,&#xA;&#x9;&#x9;IIF(Sponsor = 1, 'Sim', 'Não') AS Sponsor,&#xA;&#x9;&#x9;IIF(Elegivel_disparos IS NULL AND Fonte_contato_SD IN ('CRM -  Atividade no último ano','CRM -  Atualização no último ano','CRM -  Main Sponsor')&#xA;&#x9;&#x9;&#x9;OR Elegivel_disparos = 'Sim', 'Sim', 'Não') AS Elegivel_disparos,&#xA;&#x9;&#x9;Linkedin,&#xA;&#x9;&#x9;Data_atualizacao_contato,&#xA;&#x9;&#x9;Email_duplicado,&#xA;&#x9;&#x9;Usuario_ativo&#xA;FROM [stage].[VAGAS_DW].[Contatos_sensedata_integracao_stage]&#xA;WHERE&#x9;Email NOT LIKE '%@vagas.com%') AS Subquery ;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Contatos_sensedata_integracao_stage"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarefa Executar SQL"
      DTS:DTSID="{8A7946E1-5B6B-415D-87B8-0B12FD0337E9}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Contatos_sensedata_integracao_stage"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C9C5C2E3-4F23-4A32-8949-107BB2A1C923}"
          SQLTask:SqlStatementSource="DROP TABLE IF EXISTS [stage].[VAGAS_DW].[Contatos_sensedata_integracao_stage] ;&#xA;SELECT&#x9;Ctt_sdt.Cod_contato_SD AS ID_Integracao,&#xA;&#x9;&#x9;Ctt_sdt.Cod_cli,&#xA;&#x9;&#x9;Ctt_sdt.Cod_func,&#xA;&#x9;&#x9;ISNULL(IIF(ISNULL(Ctt_sdt.Nome, '') = '', Ctt_CRM.Nome, Ctt_sdt.Nome) COLLATE SQL_Latin1_General_CP1_CI_AI, '') AS Nome,&#xA;&#x9;&#x9;ISNULL(IIF(ISNULL(Ctt_sdt.Email, '') = '', Ctt_CRM.Email, Ctt_sdt.Email) COLLATE SQL_Latin1_General_CP1_CI_AI, '') AS Email,&#xA;&#x9;&#x9;ISNULL(IIF(ISNULL(Ctt_sdt.Telefone1, '') = '', Ctt_CRM.Telefone1, Ctt_sdt.Telefone1) COLLATE SQL_Latin1_General_CP1_CI_AI, '') AS Telefone1,&#xA;&#x9;&#x9;ISNULL(IIF(ISNULL(Ctt_sdt.Telefone2, '') = '', Ctt_CRM.Telefone2, Ctt_sdt.Telefone2) COLLATE SQL_Latin1_General_CP1_CI_AI, '') AS Telefone2,&#xA;&#x9;&#x9;ISNULL(IIF(ISNULL(Ctt_sdt.Cod_contato_CRM, '') = '', Ctt_CRM.Cod_contato_CRM, Ctt_sdt.Cod_contato_CRM) COLLATE SQL_Latin1_General_CP1_CI_AI, '') ID_Contato_CRM,&#xA;&#x9;&#x9;ISNULL(IIF(ISNULL(Ctt_sdt.Cod_conta_CRM, '') = '', Ctt_CRM.Cod_conta_CRM, Ctt_sdt.Cod_conta_CRM) COLLATE SQL_Latin1_General_CP1_CI_AI, '') ID_Cliente_CRM,&#xA;&#x9;&#x9;ISNULL(IIF(ISNULL(Ctt_sdt.Cargo, '') = '', Ctt_CRM.Cargo, Ctt_sdt.Cargo) COLLATE SQL_Latin1_General_CP1_CI_AI, '') AS Cargo,&#xA;&#x9;&#x9;ISNULL(IIF(ISNULL(Ctt_sdt.Tipo_usuario, '') = '', Ctt_CRM.Tipo_usuario, Ctt_sdt.Tipo_usuario) COLLATE SQL_Latin1_General_CP1_CI_AI, '') AS Tipo_usuario,&#xA;&#x9;&#x9;Ctt_CRM.Dias_ultimo_treinamento,&#xA;&#x9;&#x9;Ctt_CRM.Treinamentos_realizados,&#xA;&#x9;&#x9;Ctt_CRM.Data_ultimo_treinamento,&#xA;&#x9;&#x9;IIF(ISNULL(Ctt_sdt.Ultimo_login, '') = '', Ctt_CRM.Ultimo_login, Ctt_sdt.Ultimo_login) COLLATE SQL_Latin1_General_CP1_CI_AI AS Ultimo_login,&#xA;&#x9;&#x9;Ctt_sdt.Contato_ativo,&#xA;&#x9;&#x9;'VFB - Merge' COLLATE SQL_Latin1_General_CP1_CI_AI AS Fonte_contato_SD,&#xA;&#x9;&#x9;Ctt_sdt.Divisao,&#xA;&#x9;&#x9;Ctt_CRM.Sponsor,&#xA;&#x9;&#x9;Ctt_sdt.Elegivel_disparos,&#xA;&#x9;&#x9;Ctt_CRM.Linkedin,&#xA;&#x9;&#x9;CONVERT(DATE, GETDATE()) AS Data_atualizacao_contato,&#xA;&#x9;&#x9;'Não' AS Email_duplicado,&#xA;&#x9;&#x9;ISNULL(Ctt_sdt.Usuario_ativo, Ctt_CRM.Usuario_ativo) AS Usuario_ativo&#xA;INTO&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_integracao_stage]&#xA;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata] AS Ctt_sdt&#x9;&#x9;INNER JOIN [stage].[VAGAS_DW].[Contatos_sensedata_CRM] AS Ctt_CRM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ON Ctt_sdt.Email = Ctt_CRM.Email COLLATE SQL_Latin1_General_CP1_CI_AI&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Ctt_sdt.Cod_conta_CRM = Ctt_CRM.Cod_conta_CRM&#xA;WHERE&#x9;Ctt_sdt.RegElegivelMerge_Controle = 1&#xA;&#x9;&#x9;AND Ctt_CRM.RegElegivelMerge_Controle = 'Merge'&#xA;UNION ALL&#xA;SELECT&#x9;Ctt_sdt.Cod_contato_SD AS ID_Integracao,&#xA;&#x9;&#x9;Ctt_sdt.Cod_Cli,&#xA;&#x9;&#x9;Ctt_sdt.Cod_func,&#xA;&#x9;&#x9;ISNULL(Ctt_sdt.Nome, '') COLLATE SQL_Latin1_General_CP1_CI_AI AS Nome,&#xA;&#x9;&#x9;ISNULL(Ctt_sdt.Email, '') COLLATE SQL_Latin1_General_CP1_CI_AI AS Email,&#xA;&#x9;&#x9;ISNULL(Ctt_sdt.Telefone1, '') COLLATE SQL_Latin1_General_CP1_CI_AI AS Telefone1,&#xA;&#x9;&#x9;ISNULL(Ctt_sdt.Telefone2, '') COLLATE SQL_Latin1_General_CP1_CI_AI AS Telefone2,&#xA;&#x9;&#x9;ISNULL(Ctt_sdt.Cod_contato_CRM, '') COLLATE SQL_Latin1_General_CP1_CI_AI ID_Contato_CRM,&#xA;&#x9;&#x9;ISNULL(Ctt_sdt.Cod_conta_CRM, '') COLLATE SQL_Latin1_General_CP1_CI_AI ID_Cliente_CRM,&#xA;&#x9;&#x9;ISNULL(Ctt_sdt.Cargo, '') COLLATE SQL_Latin1_General_CP1_CI_AI AS Cargo,&#xA;&#x9;&#x9;ISNULL(Ctt_sdt.Tipo_usuario, '') COLLATE SQL_Latin1_General_CP1_CI_AI AS Tipo_usuario,&#xA;&#x9;&#x9;NULL AS Dias_ultimo_treinamento,&#xA;&#x9;&#x9;NULL AS Treinamentos_realizados,&#xA;&#x9;&#x9;NULL AS Data_ultimo_treinamento,&#xA;&#x9;&#x9;ISNULL(Ctt_sdt.Ultimo_login, '') COLLATE SQL_Latin1_General_CP1_CI_AI AS Ultimo_login,&#xA;&#x9;&#x9;Ctt_sdt.Contato_ativo,&#xA;&#x9;&#x9;'VFB - Único não existe no CRM' COLLATE SQL_Latin1_General_CP1_CI_AI AS Fonte_contato_SD,&#xA;&#x9;&#x9;Ctt_sdt.Divisao,&#xA;&#x9;&#x9;Sponsor,&#xA;&#x9;&#x9;Elegivel_disparos,&#xA;&#x9;&#x9;Linkedin,&#xA;&#x9;&#x9;CONVERT(DATE, GETDATE()) AS Data_atualizacao_contato,&#xA;&#x9;&#x9;'Não' AS Email_duplicado,&#xA;&#x9;&#x9;Ctt_sdt.Usuario_ativo&#xA;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata] AS Ctt_sdt&#xA;WHERE&#x9;Ctt_sdt.RegElegivelMerge_Controle  = 1&#xA;&#x9;&#x9;AND NOT EXISTS (SELECT * &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_CRM] AS Ctt_CRM_A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Ctt_sdt.Email = Ctt_CRM_A1.Email COLLATE SQL_Latin1_General_CP1_CI_AI&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Ctt_sdt.Cod_conta_CRM = Ctt_CRM_A1.Cod_conta_CRM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Ctt_CRM_A1.RegElegivelMerge_Controle = 'Merge')&#xA;UNION ALL&#xA;SELECT&#x9;Ctt_sdt.Cod_contato_SD AS ID_Integracao,&#xA;&#x9;&#x9;Ctt_sdt.Cod_Cli,&#xA;&#x9;&#x9;Ctt_sdt.Cod_func,&#xA;&#x9;&#x9;ISNULL(Ctt_sdt.Nome, '') COLLATE SQL_Latin1_General_CP1_CI_AI AS Nome,&#xA;&#x9;&#x9;ISNULL(Ctt_sdt.Email, '') COLLATE SQL_Latin1_General_CP1_CI_AI AS Email,&#xA;&#x9;&#x9;ISNULL(Ctt_sdt.Telefone1, '') COLLATE SQL_Latin1_General_CP1_CI_AI AS Telefone1,&#xA;&#x9;&#x9;ISNULL(Ctt_sdt.Telefone2, '') COLLATE SQL_Latin1_General_CP1_CI_AI AS Telefone2,&#xA;&#x9;&#x9;ISNULL(Ctt_sdt.Cod_contato_CRM, '') COLLATE SQL_Latin1_General_CP1_CI_AI ID_Contato_CRM,&#xA;&#x9;&#x9;ISNULL(Ctt_sdt.Cod_conta_CRM, '') COLLATE SQL_Latin1_General_CP1_CI_AI ID_Cliente_CRM,&#xA;&#x9;&#x9;ISNULL(Ctt_sdt.Cargo, '') COLLATE SQL_Latin1_General_CP1_CI_AI AS Cargo,&#xA;&#x9;&#x9;ISNULL(Ctt_sdt.Tipo_usuario, '') COLLATE SQL_Latin1_General_CP1_CI_AI AS Tipo_usuario,&#xA;&#x9;&#x9;NULL AS Dias_ultimo_treinamento,&#xA;&#x9;&#x9;NULL AS Treinamentos_realizados,&#xA;&#x9;&#x9;NULL AS Data_ultimo_treinamento,&#xA;&#x9;&#x9;ISNULL(Ctt_sdt.Ultimo_login, '') COLLATE SQL_Latin1_General_CP1_CI_AI AS Ultimo_login,&#xA;&#x9;&#x9;Ctt_sdt.Contato_ativo,&#xA;&#x9;&#x9;'VFB - Duplicado não elegível pro Merge' COLLATE SQL_Latin1_General_CP1_CI_AI AS Fonte_contato_SD,&#xA;&#x9;&#x9;Ctt_sdt.Divisao,&#xA;&#x9;&#x9;Sponsor,&#xA;&#x9;&#x9;Elegivel_disparos,&#xA;&#x9;&#x9;Linkedin,&#xA;&#x9;&#x9;CONVERT(DATE, GETDATE()) AS Data_atualizacao_contato,&#xA;&#x9;&#x9;'Sim' AS Email_duplicado,&#xA;&#x9;&#x9;Ctt_sdt.Usuario_ativo&#xA;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata] AS Ctt_sdt&#xA;WHERE&#x9;Ctt_sdt.RegElegivelMerge_Controle  = 0&#xA;UNION ALL&#xA;SELECT&#x9;Ctt_CRM_chaves.Cod_contato_SD AS ID_Integracao,&#xA;&#x9;&#x9;Ctt_CRM.Cod_Cli,&#xA;&#x9;&#x9;Ctt_CRM.Cod_func,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Nome, '') AS Nome,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Email, '') COLLATE SQL_Latin1_General_CP1_CI_AI AS Email,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Telefone1, '') AS Telefone1,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Telefone2, '') AS Telefone2,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Cod_contato_CRM, '') ID_Contato_CRM,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Cod_conta_CRM, '') ID_Cliente_CRM,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Cargo, '') AS Cargo,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Tipo_usuario, '') AS Tipo_usuario,&#xA;&#x9;&#x9;Ctt_CRM.Dias_ultimo_treinamento,&#xA;&#x9;&#x9;Ctt_CRM.Treinamentos_realizados,&#xA;&#x9;&#x9;Ctt_CRM.Data_ultimo_treinamento,&#xA;&#x9;&#x9;NULL AS Ultimo_login,&#xA;&#x9;&#x9;Ctt_CRM.Contato_ativo,&#xA;&#x9;&#x9;'CRM - ' + ' ' + Ctt_CRM.RegElegivelMerge_Controle COLLATE SQL_Latin1_General_CP1_CI_AI AS Fonte_contato_SD,&#xA;&#x9;&#x9;NULL AS Divisao,&#xA;&#x9;&#x9;Sponsor,&#xA;&#x9;&#x9;Elegivel_disparos,&#xA;&#x9;&#x9;Linkedin,&#xA;&#x9;&#x9;CONVERT(DATE, GETDATE()) AS Data_atualizacao_contato,&#xA;&#x9;&#x9;NULL AS Email_duplicado,&#xA;&#x9;&#x9;Ctt_CRM.Usuario_ativo&#xA;FROM&#x9; [stage].[VAGAS_DW].[Contatos_sensedata_CRM] AS Ctt_CRM&#x9;&#x9;&#x9;INNER JOIN [stage].[VAGAS_DW].[Contatos_chaves_sensedata_stage] AS Ctt_CRM_chaves&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ON Ctt_CRM.Cod_contato_CRM = Ctt_CRM_chaves.Cod_contato_CRM COLLATE SQL_Latin1_General_CP1_CI_AI&#xA;WHERE&#x9;RegElegivelMerge_Controle = 'Main Sponsor'&#xA;&#x9;&#x9;AND&#x9;NOT EXISTS (SELECT&#x9;*&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata] AS Ctt_sdt_A1&#x9;&#x9;INNER JOIN [stage].[VAGAS_DW].[Contatos_sensedata_CRM] AS Ctt_CRM_A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ON Ctt_sdt_A1.Email = Ctt_CRM_A1.Email COLLATE SQL_Latin1_General_CP1_CI_AI&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Ctt_sdt_A1.Cod_conta_CRM = Ctt_CRM_A1.Cod_conta_CRM&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Ctt_sdt_A1.RegElegivelMerge_Controle = 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Ctt_CRM_A1.RegElegivelMerge_Controle = 'Merge'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Ctt_CRM.Cod_contato_CRM = Ctt_CRM_A1.Cod_contato_CRM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Ctt_CRM.Cod_conta_CRM = Ctt_CRM_A1.Cod_conta_CRM)&#xA;UNION ALL&#xA;SELECT&#x9;Ctt_CRM_chaves.Cod_contato_SD AS ID_Integracao,&#xA;&#x9;&#x9;Ctt_CRM.Cod_cli,&#xA;&#x9;&#x9;Ctt_CRM.Cod_func,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Nome, '') AS Nome,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Email, '') COLLATE SQL_Latin1_General_CP1_CI_AI AS Email,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Telefone1, '') AS Telefone1,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Telefone2, '') AS Telefone2,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Cod_contato_CRM, '') ID_Contato_CRM,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Cod_conta_CRM, '') ID_Cliente_CRM,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Cargo, '') AS Cargo,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Tipo_usuario, '') AS Tipo_usuario,&#xA;&#x9;&#x9;Ctt_CRM.Dias_ultimo_treinamento,&#xA;&#x9;&#x9;Ctt_CRM.Treinamentos_realizados,&#xA;&#x9;&#x9;Ctt_CRM.Data_ultimo_treinamento,&#xA;&#x9;&#x9;NULL AS Ultimo_login,&#xA;&#x9;&#x9;Ctt_CRM.Contato_ativo,&#xA;&#x9;&#x9;'CRM - ' + ' ' + Ctt_CRM.RegElegivelMerge_Controle COLLATE SQL_Latin1_General_CP1_CI_AI AS Fonte_contato_SD,&#xA;&#x9;&#x9;NULL AS Divisao,&#xA;&#x9;&#x9;Sponsor,&#xA;&#x9;&#x9;Elegivel_disparos,&#xA;&#x9;&#x9;Linkedin,&#xA;&#x9;&#x9;CONVERT(DATE, GETDATE()) AS Data_atualizacao_contato,&#xA;&#x9;&#x9;NULL AS Email_duplicado,&#xA;&#x9;&#x9;Ctt_CRM.Usuario_ativo&#xA;FROM&#x9; [stage].[VAGAS_DW].[Contatos_sensedata_CRM] AS Ctt_CRM&#x9;&#x9;&#x9;INNER JOIN [stage].[VAGAS_DW].[Contatos_chaves_sensedata_stage] AS Ctt_CRM_chaves&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ON Ctt_CRM.Cod_contato_CRM = Ctt_CRM_chaves.Cod_contato_CRM COLLATE SQL_Latin1_General_CP1_CI_AI&#xA;WHERE&#x9;RegElegivelMerge_Controle = 'Atualização no último ano'&#xA;&#x9;&#x9;AND&#x9;NOT EXISTS (SELECT&#x9;*&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata] AS Ctt_sdt_A1&#x9;&#x9;INNER JOIN [stage].[VAGAS_DW].[Contatos_sensedata_CRM] AS Ctt_CRM_A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ON Ctt_sdt_A1.Email = Ctt_CRM_A1.Email COLLATE SQL_Latin1_General_CP1_CI_AI&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Ctt_sdt_A1.Cod_conta_CRM = Ctt_CRM_A1.Cod_conta_CRM&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Ctt_sdt_A1.RegElegivelMerge_Controle = 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Ctt_CRM_A1.RegElegivelMerge_Controle = 'Merge'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Ctt_CRM.Cod_contato_CRM = Ctt_CRM_A1.Cod_contato_CRM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Ctt_CRM.Cod_conta_CRM = Ctt_CRM_A1.Cod_conta_CRM)&#xA;UNION ALL&#xA;SELECT&#x9;Ctt_CRM_chaves.Cod_contato_SD AS ID_Integracao,&#xA;&#x9;&#x9;Ctt_CRM.Cod_cli,&#xA;&#x9;&#x9;Ctt_CRM.Cod_func,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Nome, '') AS Nome,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Email, '') COLLATE SQL_Latin1_General_CP1_CI_AI AS Email,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Telefone1, '') AS Telefone1,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Telefone2, '') AS Telefone2,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Cod_contato_CRM, '') ID_Contato_CRM,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Cod_conta_CRM, '') ID_Cliente_CRM,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Cargo, '') AS Cargo,&#xA;&#x9;&#x9;ISNULL(Ctt_CRM.Tipo_usuario, '') AS Tipo_usuario,&#xA;&#x9;&#x9;Ctt_CRM.Dias_ultimo_treinamento,&#xA;&#x9;&#x9;Ctt_CRM.Treinamentos_realizados,&#xA;&#x9;&#x9;Ctt_CRM.Data_ultimo_treinamento,&#xA;&#x9;&#x9;NULL AS Ultimo_login,&#xA;&#x9;&#x9;Ctt_CRM.Contato_ativo,&#xA;&#x9;&#x9;'CRM - ' + ' ' + Ctt_CRM.RegElegivelMerge_Controle COLLATE SQL_Latin1_General_CP1_CI_AI AS Fonte_contato_SD,&#xA;&#x9;&#x9;NULL AS Divisao,&#xA;&#x9;&#x9;Sponsor,&#xA;&#x9;&#x9;Elegivel_disparos,&#xA;&#x9;&#x9;Linkedin,&#xA;&#x9;&#x9;CONVERT(DATE, GETDATE()) AS Data_atualizacao_contato,&#xA;&#x9;&#x9;NULL AS Email_duplicado,&#xA;&#x9;&#x9;Ctt_CRM.Usuario_ativo&#xA;FROM&#x9; [stage].[VAGAS_DW].[Contatos_sensedata_CRM] AS Ctt_CRM&#x9;&#x9;&#x9;INNER JOIN [stage].[VAGAS_DW].[Contatos_chaves_sensedata_stage] AS Ctt_CRM_chaves&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ON Ctt_CRM.Cod_contato_CRM = Ctt_CRM_chaves.Cod_contato_CRM COLLATE SQL_Latin1_General_CP1_CI_AI&#x9;&#x9;&#xA;WHERE&#x9;RegElegivelMerge_Controle = 'Atividade no último ano'&#xA;&#x9;&#x9;AND&#x9;NOT EXISTS (SELECT&#x9;*&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata] AS Ctt_sdt_A1&#x9;&#x9;INNER JOIN [stage].[VAGAS_DW].[Contatos_sensedata_CRM] AS Ctt_CRM_A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ON Ctt_sdt_A1.Email = Ctt_CRM_A1.Email COLLATE SQL_Latin1_General_CP1_CI_AI&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Ctt_sdt_A1.Cod_conta_CRM = Ctt_CRM_A1.Cod_conta_CRM&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Ctt_sdt_A1.RegElegivelMerge_Controle = 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Ctt_CRM_A1.RegElegivelMerge_Controle = 'Merge'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Ctt_CRM.Cod_contato_CRM = Ctt_CRM_A1.Cod_contato_CRM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Ctt_CRM.Cod_conta_CRM = Ctt_CRM_A1.Cod_conta_CRM) ;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Contatos_sensedata_stage - Marcar inativos"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarefa Executar SQL"
      DTS:Disabled="True"
      DTS:DTSID="{FF1BDE2C-2904-4662-9A73-037B992360FC}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Contatos_sensedata_stage - Marcar inativos"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C9C5C2E3-4F23-4A32-8949-107BB2A1C923}"
          SQLTask:SqlStatementSource="-- Marca contatos como inativos: Serão marcados como inativos, os contatos (Cod_func) que não estão sendo computados como ativos na data da carga:&#xA;UPDATE&#x9;[stage].[VAGAS_DW].[Contatos_sensedata]&#xA;SET&#x9;&#x9;Contato_ativo = 'Não',&#xA;&#x9;&#x9;Data_atualizacao_contato = CONVERT(DATE, GETDATE())&#xA;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata]  AS Contt&#xA;WHERE&#x9;NOT EXISTS (SELECT * &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;FROM [stage].[VAGAS_DW].[Contatos_sensedata_stage] AS Contt_A1 &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE Contt.Cod_func = Contt_A1.Cod_func_SD)&#xA;&#x9;&#x9;AND Contt.Contato_ativo = 'Sim' ;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Contatos_sensedata_stage --&gt; Contatos_sensedata"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarefa Executar SQL"
      DTS:DTSID="{BC44CD06-1B57-4D52-BA24-9D6935D0BC51}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Contatos_sensedata_stage --&gt; Contatos_sensedata"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C9C5C2E3-4F23-4A32-8949-107BB2A1C923}"
          SQLTask:SqlStatementSource="-- Levantamento dos campos que serão carregados na SD:&#xA;TRUNCATE TABLE [stage].[VAGAS_DW].[Contatos_sensedata] ;&#xA;&#xA;INSERT INTO [stage].[VAGAS_DW].[Contatos_sensedata] (&#xA;Cod_func,Nome,Email,Telefone1,Telefone2,Cod_contato_CRM,Cod_conta_CRM,Cod_cli,Cargo,Tipo_usuario,Data_ultimo_treinamento,Dias_ultimo_treinamento,Treinamentos_realizados,Ultimo_login,Divisao,Sponsor,Elegivel_disparos,Linkedin,Contato_ativo,Cod_contato_SD,RegElegivelMerge_Controle,Data_atualizacao_contato,Usuario_ativo)&#xA;SELECT&#x9;Cod_func_SD,&#xA;&#x9;&#x9;Nome_SD,&#xA;&#x9;&#x9;Email_SD,&#xA;&#x9;&#x9;Telefone1,&#xA;&#x9;&#x9;Telefone2,&#xA;&#x9;&#x9;ContatosVFB.Cod_contato_CRM,&#xA;&#x9;&#x9;Cod_conta_CRM,&#xA;&#x9;&#x9;Cod_cli,&#xA;&#x9;&#x9;Cargo,&#xA;&#x9;&#x9;Tipo_usuario,&#xA;&#x9;&#x9;Data_ultimo_treinamento,&#xA;&#x9;&#x9;Dias_ultimo_treinamento,&#xA;&#x9;&#x9;Treinamentos_realizados,&#xA;&#x9;&#x9;Ultimo_login,&#xA;&#x9;&#x9;Divisao,&#xA;&#x9;&#x9;Sponsor,&#xA;&#x9;&#x9;Elegivel_disparos,&#xA;&#x9;&#x9;Linkedin,&#xA;&#x9;&#x9;Contato_ativo,&#xA;&#x9;&#x9;ContatosVFB_chave.Cod_contato_SD,&#xA;&#x9;&#x9;NULL AS RegElegivelMerge_Controle,&#xA;&#x9;&#x9;CONVERT(DATE, GETDATE()) AS Data_atualizacao_contato,&#xA;&#x9;&#x9;Usuario_ativo&#xA;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_stage] AS ContatosVFB&#x9;&#x9;INNER JOIN [stage].[VAGAS_DW].[Contatos_chaves_sensedata_stage] AS ContatosVFB_Chave&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ON ContatosVFB.Cod_func_SD = ContatosVFB_Chave.Cod_func ;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Contatos_sensedata_stage_CRM (classificação da base)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarefa Executar SQL"
      DTS:DTSID="{78B43186-6FBB-495B-BB7D-B96D1633FB97}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Contatos_sensedata_stage_CRM (classificação da base)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C9C5C2E3-4F23-4A32-8949-107BB2A1C923}"
          SQLTask:SqlStatementSource="-- Contatos do CRM elegíveis pro Merge, que possuem correspondência pelo Email e Código da conta dos registros provindos do VFB:&#xA;DROP TABLE IF EXISTS [stage].[VAGAS_DW].[Tmp_contatos_CRM_Merge] ;&#xA;SELECT&#x9;*, 'Merge' AS RegElegivelMerge_Controle&#xA;INTO&#x9;[stage].[VAGAS_DW].[Tmp_contatos_CRM_Merge]&#xA;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_stage_CRM] AS Contt_CRM&#xA;WHERE&#x9;NOT EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_stage_CRM] AS Contt_CRM_A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Contt_CRM.Email = Contt_CRM_A1.Email&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Contt_CRM.Cod_conta_CRM = Contt_CRM_A1.Cod_conta_CRM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Contt_CRM_A1.Email&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;HAVING COUNT(*) &gt; 1)&#xA;&#x9;&#x9;AND EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata] AS Contt_sdt_A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Contt_CRM.Email = Contt_sdt_A1.Email COLLATE SQL_Latin1_General_CP1_CI_AI&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Contt_CRM.Cod_conta_CRM = Contt_sdt_A1.Cod_conta_CRM COLLATE SQL_Latin1_General_CP1_CI_AI&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Contt_sdt_A1.RegElegivelMerge_Controle = 1) ;&#xA;&#xA;&#xA;-- Contato Principal: &#xA;DROP TABLE IF EXISTS [stage].[VAGAS_DW].[Tmp_contatos_MainSponsor] ;&#xA;SELECT&#x9;Contt_CRM.*, 'Main Sponsor' AS RegElegivelMerge_Controle&#xA;INTO&#x9;[stage].[VAGAS_DW].[Tmp_contatos_MainSponsor]&#xA;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_stage_CRM] AS Contt_CRM&#x9;&#x9;INNER JOIN [VAGAS_DW].[VAGAS_DW].[CONTATOS_CRM] AS Contt_CRM2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ON Contt_CRM.Cod_contato_CRM = Contt_CRM2.COD_CONTATO&#xA;WHERE&#x9;Contt_CRM2.CONTATO_PRINCIPAL = 1&#xA;&#x9;&#x9;AND NOT EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Tmp_contatos_CRM_Merge] AS Contt_A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Contt_CRM.Cod_contato_CRM = Contt_A1.Cod_contato_CRM) ;&#xA;&#xA;-- Data da última atualização no último ano:&#xA;DROP TABLE IF EXISTS [stage].[VAGAS_DW].[Tmp_contatos_Atualizacao_UltAno] ;&#xA;SELECT&#x9;Contt_CRM.*, 'Atualização no último ano' AS RegElegivelMerge_Controle&#xA;INTO&#x9;[stage].[VAGAS_DW].[Tmp_contatos_Atualizacao_UltAno]&#xA;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_stage_CRM] AS Contt_CRM&#x9;&#x9;INNER JOIN [VAGAS_DW].[VAGAS_DW].[CONTATOS_CRM] AS Contt_CRM2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ON Contt_CRM.Cod_contato_CRM = Contt_CRM2.COD_CONTATO&#xA;WHERE&#x9;NOT EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Tmp_contatos_CRM_Merge] AS Contt_A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Contt_CRM.Cod_contato_CRM = Contt_A1.Cod_contato_CRM)&#xA;&#x9;&#x9;AND NOT EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Tmp_contatos_MainSponsor] AS Contt_A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Contt_CRM.Cod_contato_CRM = Contt_A1.Cod_contato_CRM)&#xA;&#x9;&#x9;AND Contt_CRM2.DATA_MODIFICACAO &gt;= DATEADD(YEAR, -1, CONVERT(DATE, GETDATE())) ;&#xA;&#xA;&#xA;-- Data da última atividade no último ano:&#xA;DROP TABLE IF EXISTS [stage].[VAGAS_DW].[Tmp_contatos_CRM_Atividade_UltAno] ;&#xA;SELECT&#x9;Contt_CRM.*, 'Atividade no último ano' AS RegElegivelMerge_Controle&#xA;INTO&#x9;[stage].[VAGAS_DW].[Tmp_contatos_CRM_Atividade_UltAno]&#xA;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_stage_CRM] AS Contt_CRM&#x9;&#x9;INNER JOIN [VAGAS_DW].[VAGAS_DW].[CONTATOS_CRM] AS Contt_CRM2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ON Contt_CRM.Cod_contato_CRM = Contt_CRM2.COD_CONTATO&#xA;WHERE&#x9;NOT EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Tmp_contatos_CRM_Merge] AS Contt_A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Contt_CRM.Cod_contato_CRM = Contt_A1.Cod_contato_CRM)&#xA;&#x9;&#x9;AND NOT EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Tmp_contatos_MainSponsor] AS Contt_A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Contt_CRM.Cod_contato_CRM = Contt_A1.Cod_contato_CRM)&#xA;&#x9;&#x9;AND NOT EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Tmp_contatos_Atualizacao_UltAno] AS Contt_A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Contt_CRM.Cod_contato_CRM = Contt_A1.Cod_contato_CRM)&#xA;&#x9;&#x9;AND Contt_CRM2.DtUltAtividade &gt;= DATEADD(YEAR, -1, CONVERT(DATE, GETDATE())) ;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Contatos_sensedata_stage_CRM -&gt; Contatos_sensedata_stage_CRM_MERGE"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarefa Executar SQL"
      DTS:DTSID="{7EEBDE47-C4B2-49D6-9742-73263D82EBBB}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Contatos_sensedata_stage_CRM -&gt; Contatos_sensedata_stage_CRM_MERGE"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C9C5C2E3-4F23-4A32-8949-107BB2A1C923}"
          SQLTask:SqlStatementSource="-- Carga dos contatos levantados no CRM (Elegíveis pro Merge, Main Sponsor, Atualizado último ano, Atividade último ano):&#xA;DROP TABLE IF EXISTS [stage].[VAGAS_DW].[Contatos_sensedata_stage_CRM_MERGE]&#xA;SELECT * INTO [stage].[VAGAS_DW].[Contatos_sensedata_stage_CRM_MERGE] FROM [stage].[VAGAS_DW].[Tmp_contatos_CRM_Merge] UNION ALL&#xA;SELECT * FROM [stage].[VAGAS_DW].[Tmp_contatos_MainSponsor] UNION ALL&#xA;SELECT * FROM [stage].[VAGAS_DW].[Tmp_contatos_Atualizacao_UltAno] UNION ALL&#xA;SELECT * FROM [stage].[VAGAS_DW].[Tmp_contatos_CRM_Atividade_UltAno] ;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Contatos_sensedata_stage_CRM_MERGE -&gt; Contatos_sensedata_CRM"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarefa Executar SQL"
      DTS:DTSID="{766B660C-8D5C-4B05-A884-5E27892D26A1}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Contatos_sensedata_stage_CRM_MERGE -&gt; Contatos_sensedata_CRM"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C9C5C2E3-4F23-4A32-8949-107BB2A1C923}"
          SQLTask:SqlStatementSource="-- Insere os registros na tabela [Contatos_sensedata_CRM]:&#xA;TRUNCATE TABLE [stage].[VAGAS_DW].[Contatos_sensedata_CRM]&#xA;INSERT INTO [stage].[VAGAS_DW].[Contatos_sensedata_CRM]&#xA;SELECT&#x9;Cod_func,Nome,Email,Telefone1,Telefone2,Cod_contato_CRM,Cod_conta_CRM,Cod_cli,Cargo,Tipo_usuario,Data_ultimo_treinamento,Dias_ultimo_treinamento,Treinamentos_realizados,Ultimo_login,Divisao,Sponsor,Elegivel_disparos,Linkedin,Contato_ativo,Data_modificacao,Data_ultima_atividade,RegElegivelMerge_Controle,Usuario_ativo&#xA;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_stage_CRM_MERGE] AS ContatosCRM&#xA;WHERE&#x9;NOT EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_CRM] AS ContatosCRM_A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;ContatosCRM.Cod_contato_CRM = ContatosCRM_A1.Cod_contato_CRM)&#xA;&#x9;&#x9;AND EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_stage_CRM_MERGE] AS Contatos_CRM_chaves_A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;ContatosCRM.Cod_contato_CRM = Contatos_CRM_chaves_A1.Cod_contato_CRM) ;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Exportação CSV"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:DelayValidation="True"
      DTS:Description="Tarefa Fluxo de Dados"
      DTS:DTSID="{E41782A9-4028-4DFD-84DE-234604865B32}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="Exportação CSV"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\Exportação CSV\Contatos_vagas"
              componentClassID="Microsoft.OLEDBSource"
              contactInfo="Origem OLE DB;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation;  Todos os Direitos Reservados; http://www.microsoft.com/sql/support;7"
              description="Origem OLE DB"
              name="Contatos_vagas"
              usesDispositions="true"
              version="7">
              <properties>
                <property
                  dataType="System.Int32"
                  description="O tempo em segundos antes que um comando expire. Zero indica uma expiração infinita."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Especifica o nome do objeto de banco de dados usado para abrir um conjunto de linhas."
                  name="OpenRowset"></property>
                <property
                  dataType="System.String"
                  description="Especifica a variável que contém o nome do objeto de banco de dados usado para abrir um conjunto de linhas."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="O comando SQL a ser executado."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">-- Consulta que gera o CSV:
SELECT	Ctt_sdt.*,
		CONVERT(DATE, Ctt_stage.Data_ultimo_login_SD) AS Data_ultimo_login,
		(SELECT	STRING_AGG('['+Trn_A1.MODULO+']', ',') AS Modulos_de_treinamentos_realizados
		 FROM	[vagas_dw].[VAGAS_DW].[CONTATOS_CRM] AS Contt_CRM_A1	INNER JOIN 
		 (SELECT Trn_particip_AA1.COD_CONTATO_TREINAMENTO,
				 Trn_AA1.NOME_TREINAMENTO,
				 Trn_AA1.MODULO
		  FROM	 [vagas_dw].[VAGAS_DW].[TREINAMENTOS_PARTICIPANTES_CRM] AS Trn_particip_AA1		INNER JOIN [vagas_dw].[VAGAS_DW].[TREINAMENTOS_CRM] AS Trn_AA1
																								ON Trn_particip_AA1.ID_TREINAMENTO = Trn_AA1.ID_TREINAMENTO
		  WHERE	 Trn_particip_AA1.STATUS_PARTICIPANTE = 'PARTICIPOU'
				 AND Trn_AA1.STATUS = 'REALIZADO'
				 AND Ctt_sdt.ID_Contato_CRM = Trn_particip_AA1.COD_CONTATO_TREINAMENTO) AS Trn_A1 ON Contt_CRM_A1.COD_CONTATO = Trn_A1.COD_CONTATO_TREINAMENTO
		  GROUP BY
				Contt_CRM_A1.COD_CONTATO) AS Modulos_de_treinamentos_realizados
FROM [stage].[VAGAS_DW].[contatos_sensedata_integracao]	AS Ctt_sdt	LEFT OUTER JOIN  [stage].[VAGAS_DW].[Contatos_sensedata_stage] AS Ctt_stage
																	ON	Ctt_sdt.Cod_func = Ctt_stage.Cod_func_SD ;</property>
                <property
                  dataType="System.String"
                  description="A variável que contém o comando SQL a ser executado."
                  name="SqlCommandVariable"></property>
                <property
                  dataType="System.Int32"
                  description="Especifica a página de código de coluna a ser usada quando não há informações de página de código disponíveis a partir da fonte de dados."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forca o uso do valor da propriedade DefaultCodePage durante a descrição dos dados de caractere."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Especifica o modo usado para acessar o banco de dados."
                  name="AccessMode"
                  typeConverter="AccessMode">2</property>
                <property
                  dataType="System.String"
                  description="Os mapeamentos entre os parâmetros no comando SQL e as variáveis."
                  name="ParameterMapping"></property>
              </properties>
              <connections>
                <connection
                  refId="Package\Exportação CSV\Contatos_vagas.Connections[OleDbConnection]"
                  connectionManagerID="{C9C5C2E3-4F23-4A32-8949-107BB2A1C923}:external"
                  connectionManagerRefId="Project.ConnectionManagers[STAGE]"
                  description="A conexão de tempo de execução OLE DB usada para acessar o banco de dados."
                  name="OleDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB]"
                  name="Saída de Origem OLE DB">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[ID_Integracao]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[ID_Integracao]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[ID_Integracao]"
                      name="ID_Integracao"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Cod_cli]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Cod_cli]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Cod_cli]"
                      name="Cod_cli"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Cod_func]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Cod_func]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Cod_func]"
                      name="Cod_func"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Telefone1]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Telefone1]"
                      length="8000"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Telefone1]"
                      name="Telefone1"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Telefone2]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Telefone2]"
                      length="8000"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Telefone2]"
                      name="Telefone2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[ID_Contato_CRM]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[ID_Contato_CRM]"
                      length="300"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[ID_Contato_CRM]"
                      name="ID_Contato_CRM"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[ID_Cliente_CRM]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[ID_Cliente_CRM]"
                      length="300"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[ID_Cliente_CRM]"
                      name="ID_Cliente_CRM"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Cargo]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Cargo]"
                      length="300"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Cargo]"
                      name="Cargo"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Tipo_usuario]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Tipo_usuario]"
                      length="300"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Tipo_usuario]"
                      name="Tipo_usuario"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Dias_ultimo_treinamento]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Dias_ultimo_treinamento]"
                      length="300"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Dias_ultimo_treinamento]"
                      name="Dias_ultimo_treinamento"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Treinamentos_realizados]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Treinamentos_realizados]"
                      length="300"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Treinamentos_realizados]"
                      name="Treinamentos_realizados"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Data_ultimo_treinamento]"
                      dataType="dbDate"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Data_ultimo_treinamento]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Data_ultimo_treinamento]"
                      name="Data_ultimo_treinamento"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Ultimo_login]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Ultimo_login]"
                      length="300"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Ultimo_login]"
                      name="Ultimo_login"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Divisao]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Divisao]"
                      length="300"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Divisao]"
                      name="Divisao"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Sponsor]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Sponsor]"
                      length="300"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Sponsor]"
                      name="Sponsor"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Elegivel_disparos]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Elegivel_disparos]"
                      length="300"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Elegivel_disparos]"
                      name="Elegivel_disparos"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Data_atualizacao_contato]"
                      dataType="dbDate"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Data_atualizacao_contato]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Data_atualizacao_contato]"
                      name="Data_atualizacao_contato"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Email_duplicado]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Email_duplicado]"
                      length="3"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Email_duplicado]"
                      name="Email_duplicado"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Usuario_ativo]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Usuario_ativo]"
                      length="300"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Usuario_ativo]"
                      name="Usuario_ativo"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Data_ultimo_login]"
                      dataType="dbDate"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Data_ultimo_login]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Data_ultimo_login]"
                      name="Data_ultimo_login"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Modulos_de_treinamentos_realizados]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Modulos_de_treinamentos_realizados]"
                      length="8000"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Modulos_de_treinamentos_realizados]"
                      name="Modulos_de_treinamentos_realizados"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Nome]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Nome]"
                      length="8000"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Nome]"
                      name="Nome"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Email]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Email]"
                      length="8000"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Email]"
                      name="Email"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[ID_Integracao]"
                      dataType="i4"
                      name="ID_Integracao" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Cod_cli]"
                      dataType="i4"
                      name="Cod_cli" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Cod_func]"
                      dataType="i4"
                      name="Cod_func" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Telefone1]"
                      codePage="1252"
                      dataType="text"
                      name="Telefone1" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Telefone2]"
                      codePage="1252"
                      dataType="text"
                      name="Telefone2" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[ID_Contato_CRM]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      name="ID_Contato_CRM" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[ID_Cliente_CRM]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      name="ID_Cliente_CRM" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Cargo]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      name="Cargo" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Tipo_usuario]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      name="Tipo_usuario" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Dias_ultimo_treinamento]"
                      codePage="1252"
                      dataType="str"
                      length="300"
                      name="Dias_ultimo_treinamento" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Treinamentos_realizados]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      name="Treinamentos_realizados" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Data_ultimo_treinamento]"
                      dataType="dbDate"
                      name="Data_ultimo_treinamento" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Ultimo_login]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      name="Ultimo_login" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Fonte_contato_SD]"
                      codePage="1252"
                      dataType="str"
                      length="38"
                      name="Fonte_contato_SD" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Divisao]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      name="Divisao" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Sponsor]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      name="Sponsor" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Elegivel_disparos]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      name="Elegivel_disparos" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Linkedin]"
                      codePage="1252"
                      dataType="str"
                      length="300"
                      name="Linkedin" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Data_atualizacao_contato]"
                      dataType="dbDate"
                      name="Data_atualizacao_contato" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Email_duplicado]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="Email_duplicado" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Usuario_ativo]"
                      codePage="1252"
                      dataType="str"
                      length="300"
                      name="Usuario_ativo" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Data_ultimo_login]"
                      dataType="dbDate"
                      name="Data_ultimo_login" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Modulos_de_treinamentos_realizados]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      name="Modulos_de_treinamentos_realizados" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Nome]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      name="Nome" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].ExternalColumns[Email]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      name="Email" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB]"
                  isErrorOut="true"
                  name="Saída de Erro de Origem OLE DB">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[ID_Integracao]"
                      dataType="i4"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[ID_Integracao]"
                      name="ID_Integracao" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Cod_cli]"
                      dataType="i4"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Cod_cli]"
                      name="Cod_cli" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Cod_func]"
                      dataType="i4"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Cod_func]"
                      name="Cod_func" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Nome]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Nome]"
                      name="Nome" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Email]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Email]"
                      name="Email" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Telefone1]"
                      codePage="1252"
                      dataType="text"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Telefone1]"
                      name="Telefone1" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Telefone2]"
                      codePage="1252"
                      dataType="text"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Telefone2]"
                      name="Telefone2" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[ID_Contato_CRM]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[ID_Contato_CRM]"
                      name="ID_Contato_CRM" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[ID_Cliente_CRM]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[ID_Cliente_CRM]"
                      name="ID_Cliente_CRM" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Cargo]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Cargo]"
                      name="Cargo" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Tipo_usuario]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Tipo_usuario]"
                      name="Tipo_usuario" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Dias_ultimo_treinamento]"
                      codePage="1252"
                      dataType="str"
                      length="300"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Dias_ultimo_treinamento]"
                      name="Dias_ultimo_treinamento" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Treinamentos_realizados]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Treinamentos_realizados]"
                      name="Treinamentos_realizados" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Data_ultimo_treinamento]"
                      dataType="dbDate"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Data_ultimo_treinamento]"
                      name="Data_ultimo_treinamento" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Ultimo_login]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Ultimo_login]"
                      name="Ultimo_login" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Divisao]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Divisao]"
                      name="Divisao" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Sponsor]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Sponsor]"
                      name="Sponsor" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Elegivel_disparos]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Elegivel_disparos]"
                      name="Elegivel_disparos" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Data_atualizacao_contato]"
                      dataType="dbDate"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Data_atualizacao_contato]"
                      name="Data_atualizacao_contato" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Email_duplicado]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Email_duplicado]"
                      name="Email_duplicado" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Usuario_ativo]"
                      codePage="1252"
                      dataType="str"
                      length="300"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Usuario_ativo]"
                      name="Usuario_ativo" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Data_ultimo_login]"
                      dataType="dbDate"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Data_ultimo_login]"
                      name="Data_ultimo_login" />
                    <outputColumn
                      refId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Modulos_de_treinamentos_realizados]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Erro de Origem OLE DB].Columns[Modulos_de_treinamentos_realizados]"
                      name="Modulos_de_treinamentos_realizados" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Exportação CSV\CSV ContatosVagas"
              componentClassID="Microsoft.FlatFileDestination"
              contactInfo="Destino de Arquivo Simples;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation;  Todos os Direitos Reservados; http://www.microsoft.com/sql/support;0"
              description="Destino de Arquivo Simples"
              localeId="1046"
              name="CSV ContatosVagas">
              <properties>
                <property
                  dataType="System.Boolean"
                  description="Especifica se os dados substituirão o arquivo de destino ou serão anexados a ele."
                  name="Overwrite">true</property>
                <property
                  dataType="System.Null"
                  description="Especifica o texto a ser gravado no arquivo de destino antes da gravação de quaisquer dados."
                  expressionType="Notify"
                  name="Header" />
              </properties>
              <connections>
                <connection
                  refId="Package\Exportação CSV\CSV ContatosVagas.Connections[FlatFileConnection]"
                  connectionManagerID="Package.ConnectionManagers[CSV ContatosVagas]"
                  connectionManagerRefId="Package.ConnectionManagers[CSV ContatosVagas]"
                  name="FlatFileConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples]"
                  hasSideEffects="true"
                  name="Entrada de Destino de Arquivo Simples">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[ID_Integracao]"
                      cachedDataType="i4"
                      cachedName="ID_Integracao"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[ID_Integracao]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[ID_Integracao]" />
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[Cod_cli]"
                      cachedDataType="i4"
                      cachedName="Cod_cli"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Cod_cli]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Cod_cli]" />
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[Cod_func]"
                      cachedDataType="i4"
                      cachedName="Cod_func"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Cod_func]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Cod_func]" />
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[Telefone1]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="8000"
                      cachedName="Telefone1"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Telefone1]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Telefone1]" />
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[Telefone2]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="8000"
                      cachedName="Telefone2"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Telefone2]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Telefone2]" />
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[ID_Contato_CRM]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="300"
                      cachedName="ID_Contato_CRM"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[ID_Contato_CRM]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[ID_Contato_CRM]" />
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[ID_Cliente_CRM]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="300"
                      cachedName="ID_Cliente_CRM"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[ID_Cliente_CRM]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[ID_Cliente_CRM]" />
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[Cargo]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="300"
                      cachedName="Cargo"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Cargo]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Cargo]" />
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[Tipo_usuario]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="300"
                      cachedName="Tipo_usuario"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Tipo_usuario]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Tipo_usuario]" />
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[Dias_ultimo_treinamento]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="300"
                      cachedName="Dias_ultimo_treinamento"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Dias_ultimo_treinamento]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Dias_ultimo_treinamento]" />
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[Treinamentos_realizados]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="300"
                      cachedName="Treinamentos_realizados"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Treinamentos_realizados]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Treinamentos_realizados]" />
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[Data_ultimo_treinamento]"
                      cachedDataType="dbDate"
                      cachedName="Data_ultimo_treinamento"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Data_ultimo_treinamento]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Data_ultimo_treinamento]" />
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[Ultimo_login]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="300"
                      cachedName="Ultimo_login"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Ultimo_login]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Ultimo_login]" />
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[Divisao]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="300"
                      cachedName="Divisao"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Divisao]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Divisao]" />
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[Sponsor]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="300"
                      cachedName="Sponsor"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Sponsor]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Sponsor]" />
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[Elegivel_disparos]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="300"
                      cachedName="Elegivel_disparos"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Elegivel_disparos]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Elegivel_disparos]" />
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[Data_atualizacao_contato]"
                      cachedDataType="dbDate"
                      cachedName="Data_atualizacao_contato"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Data_atualizacao_contato]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Data_atualizacao_contato]" />
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[Email_duplicado]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="3"
                      cachedName="Email_duplicado"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Email_duplicado]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Email_duplicado]" />
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[Usuario_ativo]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="300"
                      cachedName="Usuario_ativo"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Usuario_ativo]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Usuario_ativo]" />
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[Data_ultimo_login]"
                      cachedDataType="dbDate"
                      cachedName="Data_ultimo_login"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Data_ultimo_login]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Data_ultimo_login]" />
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[Modulos_de_treinamentos_realizados]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="8000"
                      cachedName="Modulos_de_treinamentos_realizados"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Modulos_de_treinamentos_realizados]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Modulos_de_treinamentos_realizados]" />
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[Nome]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="8000"
                      cachedName="Nome"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Nome]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Nome]" />
                    <inputColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].Columns[Email]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="8000"
                      cachedName="Email"
                      externalMetadataColumnId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Email]"
                      lineageId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB].Columns[Email]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[ID_Integracao]"
                      dataType="i4"
                      name="ID_Integracao" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Cod_cli]"
                      dataType="i4"
                      name="Cod_cli" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Cod_func]"
                      dataType="i4"
                      name="Cod_func" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Nome]"
                      codePage="1252"
                      dataType="str"
                      length="300"
                      name="Nome" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Email]"
                      codePage="1252"
                      dataType="str"
                      length="300"
                      name="Email" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Telefone1]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      name="Telefone1" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Telefone2]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      name="Telefone2" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[ID_Contato_CRM]"
                      codePage="1252"
                      dataType="str"
                      length="300"
                      name="ID_Contato_CRM" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[ID_Cliente_CRM]"
                      codePage="1252"
                      dataType="str"
                      length="300"
                      name="ID_Cliente_CRM" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Cargo]"
                      codePage="1252"
                      dataType="str"
                      length="300"
                      name="Cargo" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Tipo_usuario]"
                      codePage="1252"
                      dataType="str"
                      length="300"
                      name="Tipo_usuario" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Dias_ultimo_treinamento]"
                      codePage="1252"
                      dataType="str"
                      length="300"
                      name="Dias_ultimo_treinamento" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Treinamentos_realizados]"
                      codePage="1252"
                      dataType="str"
                      length="300"
                      name="Treinamentos_realizados" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Data_ultimo_treinamento]"
                      dataType="dbDate"
                      name="Data_ultimo_treinamento" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Ultimo_login]"
                      codePage="1252"
                      dataType="str"
                      length="300"
                      name="Ultimo_login" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Divisao]"
                      codePage="1252"
                      dataType="str"
                      length="300"
                      name="Divisao" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Sponsor]"
                      codePage="1252"
                      dataType="str"
                      length="300"
                      name="Sponsor" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Elegivel_disparos]"
                      codePage="1252"
                      dataType="str"
                      length="300"
                      name="Elegivel_disparos" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Data_atualizacao_contato]"
                      dataType="dbDate"
                      name="Data_atualizacao_contato" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Email_duplicado]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="Email_duplicado" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Usuario_ativo]"
                      codePage="1252"
                      dataType="str"
                      length="300"
                      name="Usuario_ativo" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Data_ultimo_login]"
                      dataType="dbDate"
                      name="Data_ultimo_login" />
                    <externalMetadataColumn
                      refId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Modulos_de_treinamentos_realizados]"
                      codePage="1252"
                      dataType="str"
                      length="8000"
                      name="Modulos_de_treinamentos_realizados" />
                  </externalMetadataColumns>
                </input>
              </inputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Exportação CSV.Paths[Saída de Origem OLE DB]"
              endId="Package\Exportação CSV\CSV ContatosVagas.Inputs[Entrada de Destino de Arquivo Simples]"
              name="Saída de Origem OLE DB"
              startId="Package\Exportação CSV\Contatos_vagas.Outputs[Saída de Origem OLE DB]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Higienização - Contatos_sensedata_stage"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarefa Executar SQL"
      DTS:Disabled="True"
      DTS:DTSID="{28A52643-511F-431A-9FDA-5140FCD1D486}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Higienização - Contatos_sensedata_stage"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C9C5C2E3-4F23-4A32-8949-107BB2A1C923}"
          SQLTask:SqlStatementSource="-- Tratamento de contatos que não serão carregados:&#xA;DELETE FROM [stage].[VAGAS_DW].[Contatos_sensedata_stage]&#xA;WHERE Email_SD IN ('revendedor@ipiranga.com.br', 'revendedores@ipiranga.com.br') ;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\ID da integração - CRM"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarefa Executar SQL"
      DTS:DTSID="{75BB440A-9881-49D1-8249-E8F953D56F13}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="ID da integração - CRM"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C9C5C2E3-4F23-4A32-8949-107BB2A1C923}"
          SQLTask:SqlStatementSource="INSERT INTO [stage].[VAGAS_DW].[Contatos_chaves_sensedata_stage] (Cod_contato_CRM)&#xA;SELECT&#x9;Cod_contato_CRM&#xA;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_stage_CRM_MERGE] AS ContatosCRM&#xA;WHERE NOT EXISTS (SELECT * FROM [stage].[VAGAS_DW].[Contatos_chaves_sensedata_stage] AS Contatos_chaves&#xA;&#x9;&#x9;&#x9;&#x9;  WHERE&#x9;ContatosCRM.Cod_contato_CRM = Contatos_chaves.Cod_contato_CRM COLLATE SQL_Latin1_General_CP1_CI_AI) ;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\ID da integração - VFB"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarefa Executar SQL"
      DTS:DTSID="{D78F1B42-5517-4463-B666-A42D38BE905B}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="ID da integração - VFB"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C9C5C2E3-4F23-4A32-8949-107BB2A1C923}"
          SQLTask:SqlStatementSource="-- Carrega os Cod_func e cria a chave sequencial associada ao Cod_func:&#xA;INSERT INTO [stage].[VAGAS_DW].[Contatos_chaves_sensedata_stage] (Cod_func,Cod_contato_CRM)&#xA;SELECT&#x9;Cod_func_SD,&#xA;&#x9;&#x9;Cod_contato_CRM&#xA;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_stage] AS ContatosVFB&#xA;WHERE&#x9;NOT EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata] AS ContatosVFB_A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;ContatosVFB.Cod_func_SD = ContatosVFB_A1.Cod_func)&#xA;&#x9;&#x9;AND NOT EXISTS (SELECT * FROM [stage].[VAGAS_DW].[Contatos_chaves_sensedata_stage] AS Contatos_chaves&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;ContatosVFB.Cod_func_SD = Contatos_chaves.Cod_func) ;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Marca o e-mail duplicado"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarefa Executar SQL"
      DTS:DTSID="{4F57138B-E1CD-4646-8600-2F0D113E03B9}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Marca o e-mail duplicado"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C9C5C2E3-4F23-4A32-8949-107BB2A1C923}"
          SQLTask:SqlStatementSource="-- Preenche o campo Email_duplicado que informa se o registro duplica na base final:&#xA;-- VFB&#xA;UPDATE&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_integracao_stage]&#xA;SET&#x9;&#x9;Email_duplicado = 'Sim'&#xA;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_integracao_stage] AS Ctt&#xA;WHERE&#x9;Fonte_contato_SD &lt;&gt; 'VFB - Merge'&#xA;&#x9;&#x9;AND LEFT(Fonte_contato_SD, 3) = 'VFB'&#xA;&#x9;&#x9;AND EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_integracao_stage] AS Ctt_A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Ctt.Email = Ctt_A1.Email&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Ctt.Cod_cli = Ctt_A1.Cod_cli&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Ctt.Cod_func &lt;&gt; Ctt_A1.Cod_func) ;&#xA;&#xA;-- CRM&#xA;UPDATE&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_integracao_stage]&#xA;SET&#x9;&#x9;Email_duplicado = 'Sim'&#xA;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_integracao_stage] AS Ctt&#xA;WHERE&#x9;Fonte_contato_SD &lt;&gt; 'VFB - Merge'&#xA;&#x9;&#x9;AND LEFT(Fonte_contato_SD, 3) = 'CRM'&#xA;&#x9;&#x9;AND EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_integracao_stage] AS Ctt_A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Ctt.Email = Ctt_A1.Email&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Ctt.ID_Cliente_CRM = Ctt_A1.ID_Cliente_CRM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Ctt.ID_Contato_CRM &lt;&gt; Ctt_A1.ID_Contato_CRM) ;&#xA;&#xA;UPDATE&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_integracao_stage]&#xA;SET&#x9;&#x9;Email_duplicado = 'Não'&#xA;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_integracao_stage] AS Ctt&#xA;WHERE&#x9;Email_duplicado IS NULL ;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Marca se o contato está ativo"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarefa Executar SQL"
      DTS:Disabled="True"
      DTS:DTSID="{E25D2748-88B9-4AD7-B9AB-A8FD2FEEF0ED}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Marca se o contato está ativo"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C9C5C2E3-4F23-4A32-8949-107BB2A1C923}"
          SQLTask:SqlStatementSource="-- Limpa o campo:&#xA;UPDATE&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_integracao]&#xA;SET&#x9;&#x9;Contato_ativo = NULL ;&#xA;&#xA;-- Marca o usuário ativo provindo do VFB:&#xA;UPDATE&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_integracao]&#xA;SET&#x9;&#x9;Contato_ativo = 'Sim'&#xA;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_integracao] AS Ctt_sdt&#xA;WHERE&#x9;EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_stage] AS Ctt_sdt_A1&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Ctt_sdt.Cod_func = Ctt_sdt_A1.Cod_func_SD)&#xA;&#x9;&#x9;AND LEFT(Ctt_sdt.Fonte_contato_SD, 3) = 'VFB'&#xA;&#xA;-- Marca o usuário ativo provindo do CRM:&#xA;UPDATE&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_integracao]&#xA;SET&#x9;&#x9;Contato_ativo= 'Sim'&#xA;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_integracao] AS Ctt_sdt&#xA;WHERE&#x9;EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_stage_CRM] AS Ctt_sdt_A1&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Ctt_sdt.ID_Contato_CRM = Ctt_sdt_A1.Cod_contato_CRM)&#xA;&#x9;&#x9;AND LEFT(Ctt_sdt.Fonte_contato_SD, 3) = 'CRM'&#xA;&#xA;-- Marca o usuário inativo que restou das validações de usuário ativo (está na base stage do VFB ou CRM segundo as regras previamente definidas):&#xA;UPDATE [stage].[VAGAS_DW].[Contatos_sensedata_integracao]&#xA;SET&#x9;Contato_ativo = 'Não'&#xA;FROM [stage].[VAGAS_DW].[Contatos_sensedata_integracao]&#xA;WHERE Contato_ativo IS NULL ;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Tratamentos tabela Contatos_sensedata_integracao"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarefa Executar SQL"
      DTS:DTSID="{6263982D-3392-4D73-B3ED-7A835D0B20E2}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Tratamentos tabela Contatos_sensedata_integracao"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C9C5C2E3-4F23-4A32-8949-107BB2A1C923}"
          SQLTask:SqlStatementSource="-- Limpa os telefones que contém uma sequência de dígitos seguidos iguais:&#xA;SELECT&#x9;*,&#xA;&#x9;&#x9;IIF(TamanhoTelefone1 - Qtd_vezes_repete_digito &lt;= 3, 1, 0) AS Tel1_VezesMesmoDigito&#xA;INTO&#x9;#Tel1_Digitos&#xA;FROM&#x9;(&#xA;SELECT&#x9;ID_integracao,&#xA;&#x9;&#x9;Telefone1, &#xA;&#x9;&#x9;'0' AS Digito,&#xA;&#x9;&#x9;dbo.GetSubstringCount(Telefone1,0) AS Qtd_vezes_repete_digito,&#xA;&#x9;&#x9;LEN(Telefone1) AS TamanhoTelefone1&#xA;FROM stage.VAGAS_DW.contatos_sensedata_integracao&#xA;WHERE&#x9;Telefone1 &lt;&gt; ''&#xA;&#x9;&#x9;AND dbo.GetSubstringCount(Telefone1,0) &gt; 0&#xA;UNION ALL&#xA;SELECT&#x9;ID_integracao,&#xA;&#x9;&#x9;Telefone1, &#xA;&#x9;&#x9;'1' AS Digito,&#xA;&#x9;&#x9;dbo.GetSubstringCount(Telefone1,1) AS [1],&#xA;&#x9;&#x9;LEN(Telefone1) AS Tamanho_total&#xA;FROM stage.VAGAS_DW.contatos_sensedata_integracao&#xA;WHERE&#x9;Telefone1 &lt;&gt; ''&#xA;&#x9;&#x9;AND dbo.GetSubstringCount(Telefone1,1) &gt; 0&#xA;UNION ALL&#xA;SELECT&#x9;ID_integracao,&#xA;&#x9;&#x9;Telefone1, &#xA;&#x9;&#x9;'2' AS Digito,&#xA;&#x9;&#x9;dbo.GetSubstringCount(Telefone1,2) AS [2],&#xA;&#x9;&#x9;LEN(Telefone1)&#xA;FROM stage.VAGAS_DW.contatos_sensedata_integracao&#xA;WHERE&#x9;Telefone1 &lt;&gt; ''&#xA;&#x9;&#x9;AND dbo.GetSubstringCount(Telefone1,2) &gt; 0&#xA;UNION ALL&#xA;SELECT&#x9;ID_integracao,&#xA;&#x9;&#x9;Telefone1, &#xA;&#x9;&#x9;'3' AS Digito,&#xA;&#x9;&#x9;dbo.GetSubstringCount(Telefone1,3) AS [3],&#xA;&#x9;&#x9;LEN(Telefone1)&#xA;FROM stage.VAGAS_DW.contatos_sensedata_integracao&#xA;WHERE&#x9;Telefone1 &lt;&gt; ''&#xA;&#x9;&#x9;AND dbo.GetSubstringCount(Telefone1,3) &gt; 0&#xA;UNION ALL&#xA;SELECT&#x9;ID_integracao,&#xA;&#x9;&#x9;Telefone1, &#xA;&#x9;&#x9;'4' AS Digito,&#xA;&#x9;&#x9;dbo.GetSubstringCount(Telefone1,4) AS [4],&#xA;&#x9;&#x9;LEN(Telefone1)&#xA;FROM stage.VAGAS_DW.contatos_sensedata_integracao&#xA;WHERE&#x9;Telefone1 &lt;&gt; ''&#xA;&#x9;&#x9;AND dbo.GetSubstringCount(Telefone1,4) &gt; 0&#xA;UNION ALL&#xA;SELECT&#x9;ID_integracao,&#xA;&#x9;&#x9;Telefone1, &#xA;&#x9;&#x9;'5' AS Digito,&#xA;&#x9;&#x9;dbo.GetSubstringCount(Telefone1,5) AS [5],&#xA;&#x9;&#x9;LEN(Telefone1)&#xA;FROM stage.VAGAS_DW.contatos_sensedata_integracao&#xA;WHERE&#x9;Telefone1 &lt;&gt; ''&#xA;&#x9;&#x9;AND dbo.GetSubstringCount(Telefone1,5) &gt; 0&#xA;UNION ALL&#xA;SELECT&#x9;ID_integracao,&#xA;&#x9;&#x9;Telefone1, &#xA;&#x9;&#x9;'6' AS Digito,&#xA;&#x9;&#x9;dbo.GetSubstringCount(Telefone1,6) AS [6],&#xA;&#x9;&#x9;LEN(Telefone1)&#xA;FROM stage.VAGAS_DW.contatos_sensedata_integracao&#xA;WHERE&#x9;Telefone1 &lt;&gt; ''&#xA;&#x9;&#x9;AND dbo.GetSubstringCount(Telefone1,6) &gt; 0&#xA;UNION ALL&#xA;SELECT&#x9;ID_integracao,&#xA;&#x9;&#x9;Telefone1, &#xA;&#x9;&#x9;'7' AS Digito,&#xA;&#x9;&#x9;dbo.GetSubstringCount(Telefone1,7) AS [7],&#xA;&#x9;&#x9;LEN(Telefone1)&#xA;FROM stage.VAGAS_DW.contatos_sensedata_integracao&#xA;WHERE&#x9;Telefone1 &lt;&gt; ''&#xA;&#x9;&#x9;AND dbo.GetSubstringCount(Telefone1,7) &gt; 0&#xA;UNION ALL&#xA;SELECT&#x9;ID_integracao,&#xA;&#x9;&#x9;Telefone1, &#xA;&#x9;&#x9;'8' AS Digito,&#xA;&#x9;&#x9;dbo.GetSubstringCount(Telefone1,8) AS [8],&#xA;&#x9;&#x9;LEN(Telefone1)&#xA;FROM stage.VAGAS_DW.contatos_sensedata_integracao&#xA;WHERE&#x9;Telefone1 &lt;&gt; ''&#xA;&#x9;&#x9;AND dbo.GetSubstringCount(Telefone1,8) &gt; 0&#xA;UNION ALL&#xA;SELECT&#x9;ID_integracao,&#xA;&#x9;&#x9;Telefone1, &#xA;&#x9;&#x9;'9' AS Digito,&#xA;&#x9;&#x9;dbo.GetSubstringCount(Telefone1,9) AS [9],&#xA;&#x9;&#x9;LEN(Telefone1)&#xA;FROM stage.VAGAS_DW.contatos_sensedata_integracao&#xA;WHERE&#x9;Telefone1 &lt;&gt; ''&#xA;&#x9;&#x9;AND dbo.GetSubstringCount(Telefone1,9) &gt; 0) AS OrdemTamanhoCaracteres&#xA;WHERE&#x9;IIF(TamanhoTelefone1 - Qtd_vezes_repete_digito &lt;= 3, 1, 0) = 1&#xA;&#x9;&#x9;--AND TamanhoTelefone1 &gt;= 10&#xA;ORDER BY&#xA;&#x9;&#x9;ID_integracao,&#xA;&#x9;&#x9;Qtd_vezes_repete_digito DESC ;&#xA;&#xA;&#xA;-- Se existir qualquer dígito entre a menor posição e a maior posição mais repetitivo, não zerar o telefone, senão zerar, pois é uma sequência:&#xA;SELECT&#x9;*, &#xA;&#x9;&#x9;CHARINDEX(Digito, Telefone1, 1) AS PrimPosicao_Digito,&#xA;&#x9;&#x9;SUBSTRING(Telefone1, CHARINDEX(Digito, Telefone1, 1), TamanhoTelefone1 -  CHARINDEX(Digito, Telefone1, 1)) AS Tel1_parcial,&#xA;&#x9;&#x9;REPLICATE(LEFT(SUBSTRING(Telefone1, CHARINDEX(Digito, Telefone1, 1), TamanhoTelefone1 -  CHARINDEX(Digito, Telefone1, 1)),1),LEN(SUBSTRING(Telefone1, CHARINDEX(Digito, Telefone1, 1), TamanhoTelefone1 -  CHARINDEX(Digito, Telefone1, 1)))) AS Telefone1Parcial_Comparar,&#xA;&#x9;&#x9;IIF(SUBSTRING(Telefone1, CHARINDEX(Digito, Telefone1, 1), TamanhoTelefone1 -  CHARINDEX(Digito, Telefone1, 1)) = &#x9;&#x9;REPLICATE(LEFT(SUBSTRING(Telefone1, CHARINDEX(Digito, Telefone1, 1), TamanhoTelefone1 -  CHARINDEX(Digito, Telefone1, 1)),1),LEN(SUBSTRING(Telefone1, CHARINDEX(Digito, Telefone1, 1), TamanhoTelefone1 -  CHARINDEX(Digito, Telefone1, 1)))) OR Qtd_vezes_repete_digito &gt;= 8, 1, 0) AS Tel1_Digitos&#xA;INTO&#x9;#Tel1_Digitos_tratado&#xA;FROM&#x9;#Tel1_Digitos ;&#xA;&#xA;-- Atualização:&#xA;UPDATE&#x9;[stage].[VAGAS_DW].[contatos_sensedata_integracao]&#xA;SET&#x9;&#x9;Telefone1 = ''&#xA;FROM&#x9;#Tel1_Digitos_tratado AS Tel1_Digitos&#x9;&#x9;INNER JOIN [stage].[VAGAS_DW].[contatos_sensedata_integracao] AS Ctt&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ON Tel1_Digitos.ID_integracao = Ctt.ID_integracao&#xA;WHERE&#x9;Tel1_Digitos = 1 ;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Upload S3 Bucket"
      DTS:CreationName="Microsoft.ExecutePackageTask"
      DTS:Description="Tarefa Executar Pacote"
      DTS:DTSID="{8fbe9e7f-bc57-4d00-8a2a-e8054a24f8b2}"
      DTS:ExecutableType="Microsoft.ExecutePackageTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Upload S3 Bucket"
      DTS:TaskContact="Microsoft Corporation; Microsoft SQL Server; Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:ObjectData>
        <ExecutePackageTask>
          <UseProjectReference>True</UseProjectReference>
          <PackageName>CargaPython.dtsx</PackageName>
          <ParameterAssignment>
            <ParameterName>CSV_NAME</ParameterName>
            <BindedVariableOrParameterName>$Package::CSV_NAME</BindedVariableOrParameterName>
          </ParameterAssignment>
        </ExecutePackageTask>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\VFB -&gt; Contatos_sensedata_stage"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarefa Executar SQL"
      DTS:DTSID="{8D01C637-AB3F-4469-B0F6-2E9756E547EE}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="VFB -&gt; Contatos_sensedata_stage"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C9C5C2E3-4F23-4A32-8949-107BB2A1C923}"
          SQLTask:SqlStatementSource="-- Carrega a tabela [stage].[VAGAS_DW].[Contatos_sensedata_stage]:&#xA;DROP TABLE IF EXISTS [stage].[VAGAS_DW].[Contatos_sensedata_stage] ;&#xA;SELECT&#x9;Func.Cod_func AS Cod_func_SD,&#xA;&#x9;&#x9;REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(Func.Nome_func)), CHAR(9), ''), CHAR(10), ''), CHAR(13), '') AS Nome_SD,&#xA;&#x9;&#x9;REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(Func.Email_func)), CHAR(9), ''), CHAR(10), ''), CHAR(13), '') AS Email_SD,&#xA;&#x9;&#x9;IIF(Func.StatusAcesso_func = 0, 'Sim', 'Não') AS Usuario_ativo,&#xA;&#x9;&#x9;DataUlt_Login.Data_ultimo_login AS Data_ultimo_login_SD,&#xA;&#x9;&#x9;REVERSE(SUBSTRING(REVERSE(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(Func.Email_func)), CHAR(9), ''), CHAR(10), ''), CHAR(13), '')), 1, CHARINDEX('@', REVERSE(REPLACE(REPLACE(REPLACE(LTRIM(RTRIM(Func.Email_func)), CHAR(9), ''), CHAR(10), ''), CHAR(13), ''))))) AS Dominio_Controle,&#xA;&#x9;&#x9;Func.CodCli_func AS Cod_cli_SD,&#xA;&#x9;&#x9;Func.Fone_func AS Telefone1,&#xA;&#x9;&#x9;Func.Celular_func AS Telefone2,&#xA;&#x9;&#x9;NULL AS Cod_contato_CRM,&#xA;&#x9;&#x9;(SELECT&#x9;TOP 1 CONTA_ID&#xA;&#x9;&#x9; FROM&#x9;[stage].[VAGAS_DW].[SNAPSHOT_CLIENTES_SENSEDATA_STATUS] AS Sdt_A1&#xA;&#x9;&#x9; WHERE&#x9;Func.CodCli_func = Sdt_A1.COD_CLI) AS Cod_conta_CRM,&#xA;&#x9;&#x9; Func.CodCli_func AS Cod_cli,&#xA;&#x9;&#x9; Func.CargoDepto_func AS Cargo,&#xA;&#x9;&#x9; IIF(Func.Admin_func = 1, 'Admin', 'Recrutador') AS Tipo_usuario,&#xA;&#x9;&#x9; NULL AS Data_ultimo_treinamento,&#xA;&#x9;&#x9; NULL AS Dias_ultimo_treinamento,&#xA;&#x9;&#x9; NULL AS Treinamentos_realizados,&#xA;&#x9;&#x9; CASE&#xA;&#x9;&#x9;&#x9;WHEN DATEDIFF (DAY, Data_ultimo_login, CONVERT(DATE, GETDATE())) &lt;= 30   THEN '[1ª faixa - 0 a 30 dias]'&#xA;&#x9;&#x9;&#x9;WHEN DATEDIFF (DAY, Data_ultimo_login, CONVERT(DATE, GETDATE())) &gt; 30  and  DATEDIFF (DAY, Data_ultimo_login, CONVERT(DATE, GETDATE())) &lt;= 90 THEN '[2ª faixa - 31 a 90 dias]'&#xA;&#x9;&#x9;&#x9;WHEN DATEDIFF (DAY, Data_ultimo_login, CONVERT(DATE, GETDATE())) &gt; 90 THEN '[3ª faixa - acima de 90 dias]'&#xA;&#x9;&#x9;END AS Ultimo_login,&#xA;&#x9;&#x9;Div.Nome_div AS Divisao,&#xA;&#x9;&#x9;NULL AS Sponsor,&#xA;&#x9;&#x9;IIF(Cli.OptinVAGASAcontece_cli = 1 AND OptinVAGASExpress_cli  = 1 AND Func.OptinVAGASAcontece_func = 1 AND Func.OptinVAGASExpress_func = 1, 'Sim', 'Não') AS Elegivel_disparos,&#xA;&#x9;&#x9;-- Ao invés de usar o MalaDireta_func, olhar pra OptinVAGASExpress_func e OptinVAGASAcontece_func&#xA;&#x9;&#x9;NULL AS Linkedin,&#xA;&#x9;&#x9;'Sim' AS Contato_ativo&#xA;INTO&#x9;[stage].[VAGAS_DW].[Contatos_sensedata_stage]&#xA;FROM&#x9;[hrh-data].[dbo].[Funcionarios] AS Func&#x9;&#x9;OUTER APPLY (SELECT TOP 1 CONVERT(SMALLDATETIME, Data_log) AS Data_ultimo_login&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; FROM&#x9;[hrh-data].[dbo].[Clientes-Login] AS Login_A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; WHERE&#x9;Func.Cod_func = Login_A1.CodFunc_Log&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; &#x9;&#x9;AND Login_A1.Op_log = 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND ISNULL(CodUsuManut_log , 0) &lt; 1 -- Funcionários que já efetuaram login em algum momento.&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; ORDER BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Login_A1.Data_log DESC) AS DataUlt_Login&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN [hrh-data].[dbo].[Divisoes] AS Div&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ON Func.CodDiv_func = Div.Cod_div&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN [hrh-data].[dbo].[Clientes] AS Cli&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ON Func.CodCli_func = Cli.Cod_cli&#xA;WHERE&#x9;ISNULL(Func.Email_func, '') &lt;&gt; ''&#xA;&#x9;&#x9;AND EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[hrh-data].[dbo].[Clientes-Login] AS Login_A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Func.Cod_func = Login_A1.CodFunc_Log&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Login_A1.Op_log = 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND ISNULL(Login_A1.CodUsuManut_log , 0) &lt; 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND Login_A1.Data_log &gt;= DATEADD(YEAR, -1, CONVERT(DATE, GETDATE()))) -- Funcionários que fetuaram login no último ano&#xA;&#x9;&#x9;AND Func.Removido_func = 0 -- Funcionários não removidos.&#xA;&#x9;&#x9;AND EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[SNAPSHOT_CLIENTES_SENSEDATA_STATUS] AS Spn_sdt&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Func.CodCli_func = Spn_sdt.Cod_cli&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND LEFT(Spn_sdt.STATUS_CONTA_ID, 5) = 'ATIVO') -- Funcionários atrelados a algum Cod_cli carregado na Sensedata." xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restrição]"
      DTS:CreationName=""
      DTS:DTSID="{C266B884-67DA-4571-94DE-535ACA2CF542}"
      DTS:From="Package\VFB -&gt; Contatos_sensedata_stage"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restrição"
      DTS:To="Package\Higienização - Contatos_sensedata_stage" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restrição 1]"
      DTS:CreationName=""
      DTS:DTSID="{01A5CAEC-1FC2-4E44-9FF6-C20362757CDB}"
      DTS:From="Package\Higienização - Contatos_sensedata_stage"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restrição 1"
      DTS:To="Package\ID da integração - VFB" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restrição 10]"
      DTS:CreationName=""
      DTS:DTSID="{F309F876-B206-4A2D-8DAC-4A1FB47D7C5E}"
      DTS:From="Package\ID da integração - CRM"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restrição 10"
      DTS:To="Package\Contatos_sensedata_stage_CRM_MERGE -&gt; Contatos_sensedata_CRM" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restrição 11]"
      DTS:CreationName=""
      DTS:DTSID="{66AAB1B9-5EF6-474F-8819-6BAE05832686}"
      DTS:From="Package\Contatos_sensedata_stage_CRM_MERGE -&gt; Contatos_sensedata_CRM"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restrição 11"
      DTS:To="Package\Altera o collation pra gerar a tabela Contatos_sensedata_integracao" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restrição 12]"
      DTS:CreationName=""
      DTS:DTSID="{A90F354D-127E-4AA2-9587-FF3E69612779}"
      DTS:From="Package\Altera o collation pra gerar a tabela Contatos_sensedata_integracao"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restrição 12"
      DTS:To="Package\Contatos_sensedata_integracao_stage" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restrição 13]"
      DTS:CreationName=""
      DTS:DTSID="{476F28BB-13B6-4B5B-9E9E-DC1B164E917D}"
      DTS:From="Package\Contatos_sensedata_integracao_stage"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restrição 13"
      DTS:To="Package\Marca o e-mail duplicado" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restrição 14]"
      DTS:CreationName=""
      DTS:DTSID="{73FDBA6C-C005-40AA-9126-5507F36EC2E1}"
      DTS:From="Package\Marca o e-mail duplicado"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restrição 14"
      DTS:To="Package\Marca se o contato está ativo" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restrição 15]"
      DTS:CreationName=""
      DTS:DTSID="{190F1C85-E046-4C57-9CA7-B82D484762DF}"
      DTS:From="Package\Marca se o contato está ativo"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restrição 15"
      DTS:To="Package\Contatos_sensedata_integracao" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restrição 16]"
      DTS:CreationName=""
      DTS:DTSID="{C7C3F526-505C-4970-9D0C-486FE2FF751C}"
      DTS:From="Package\Exportação CSV"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restrição 16"
      DTS:To="Package\Upload S3 Bucket" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restrição 17]"
      DTS:CreationName=""
      DTS:DTSID="{C55D2D4F-8B65-4AFE-94E6-3D39492ED2DE}"
      DTS:From="Package\Contatos_sensedata_integracao"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restrição 17"
      DTS:To="Package\Tratamentos tabela Contatos_sensedata_integracao" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restrição 18]"
      DTS:CreationName=""
      DTS:DTSID="{F63C1F1E-5B3A-4216-AAD7-670E63512D0F}"
      DTS:From="Package\Tratamentos tabela Contatos_sensedata_integracao"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restrição 18"
      DTS:To="Package\Exportação CSV" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restrição 2]"
      DTS:CreationName=""
      DTS:DTSID="{B64C3A31-7F56-4818-A633-F34DF67A9612}"
      DTS:From="Package\ID da integração - VFB"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restrição 2"
      DTS:To="Package\Contatos_sensedata_stage --&gt; Contatos_sensedata" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restrição 3]"
      DTS:CreationName=""
      DTS:DTSID="{79D8A822-1003-4F92-9FD4-D602D81ECE7C}"
      DTS:From="Package\Contatos_sensedata_stage --&gt; Contatos_sensedata"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restrição 3"
      DTS:To="Package\Contatos_sensedata_stage - Marcar inativos" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restrição 4]"
      DTS:CreationName=""
      DTS:DTSID="{4D1155CA-4261-4F61-898B-BCBB87E9F961}"
      DTS:From="Package\Contatos_sensedata_stage - Marcar inativos"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restrição 4"
      DTS:To="Package\Contatos_sensedata -&gt; Contatos_sensedata_log (VFB)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restrição 5]"
      DTS:CreationName=""
      DTS:DTSID="{49C21FB5-A17B-4606-B7DB-F8FF2A5CE727}"
      DTS:From="Package\Contatos_sensedata_stage - Marcar inativos"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restrição 5"
      DTS:To="Package\Contatos_sensedata - Elegíveis pro Merge" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restrição 6]"
      DTS:CreationName=""
      DTS:DTSID="{2E51CD5F-4162-4742-B792-BA32EBB644BC}"
      DTS:From="Package\Contatos_sensedata - Elegíveis pro Merge"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restrição 6"
      DTS:To="Package\Contatos_CRM -&gt; Contatos_sensedata_stage_CRM" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restrição 7]"
      DTS:CreationName=""
      DTS:DTSID="{383BCBD0-EC55-4E93-817A-F26D06400B54}"
      DTS:From="Package\Contatos_CRM -&gt; Contatos_sensedata_stage_CRM"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restrição 7"
      DTS:To="Package\Contatos_sensedata_stage_CRM (classificação da base)" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restrição 8]"
      DTS:CreationName=""
      DTS:DTSID="{061DAB5B-1088-450D-8B89-0D1F2632201C}"
      DTS:From="Package\Contatos_sensedata_stage_CRM (classificação da base)"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restrição 8"
      DTS:To="Package\Contatos_sensedata_stage_CRM -&gt; Contatos_sensedata_stage_CRM_MERGE" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restrição 9]"
      DTS:CreationName=""
      DTS:DTSID="{D3D0A2F0-3DC9-49D0-8AAC-5BBD0ACCDDDE}"
      DTS:From="Package\Contatos_sensedata_stage_CRM -&gt; Contatos_sensedata_stage_CRM_MERGE"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restrição 9"
      DTS:To="Package\ID da integração - CRM" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--Esta seção CDATA contém as informações de layout do pacote. A seção inclui informações como coordenadas (x,y), largura e altura.-->
<!--Se você editar manualmente esta seção e cometer algum erro, poderá excluí-la. -->
<!--O pacote ainda poderá ser carregado normalmente, mas as informações de layout anteriores serão perdidas e o designer reorganizará automaticamente os elementos na superfície de design.-->
<Objects
  Version="8">
  <!--Cada nó abaixo conterá propriedades que não afetam o comportamento em tempo de execução.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="64" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="399,42"
          Id="Package\Altera o collation pra gerar a tabela Contatos_sensedata_integracao"
          TopLeft="1432.66666666667,977.333333333333" />
        <NodeLayout
          Size="319,42"
          Id="Package\Contatos_CRM -&gt; Contatos_sensedata_stage_CRM"
          TopLeft="1069.66666666667,487.333333333333" />
        <NodeLayout
          Size="276,42"
          Id="Package\Contatos_sensedata - Elegíveis pro Merge"
          TopLeft="403,387" />
        <NodeLayout
          Size="339,42"
          Id="Package\Contatos_sensedata -&gt; Contatos_sensedata_log (VFB)"
          TopLeft="723,337" />
        <NodeLayout
          Size="229,42"
          Id="Package\Contatos_sensedata_integracao"
          TopLeft="1945,1383" />
        <NodeLayout
          Size="260,42"
          Id="Package\Contatos_sensedata_integracao_stage"
          TopLeft="1939.66666666667,1129.33333333333" />
        <NodeLayout
          Size="287,42"
          Id="Package\Contatos_sensedata_stage - Marcar inativos"
          TopLeft="393,295" />
        <NodeLayout
          Size="322,42"
          Id="Package\Contatos_sensedata_stage --&gt; Contatos_sensedata"
          TopLeft="370,213" />
        <NodeLayout
          Size="341,42"
          Id="Package\Contatos_sensedata_stage_CRM (classificação da base)"
          TopLeft="1060.66666666667,578.333333333333" />
        <NodeLayout
          Size="443,42"
          Id="Package\Contatos_sensedata_stage_CRM -&gt; Contatos_sensedata_stage_CRM_MERGE"
          TopLeft="1124.66666666667,682.333333333333" />
        <NodeLayout
          Size="412,42"
          Id="Package\Contatos_sensedata_stage_CRM_MERGE -&gt; Contatos_sensedata_CRM"
          TopLeft="1430.66666666667,894.333333333333" />
        <NodeLayout
          Size="153,42"
          Id="Package\Exportação CSV"
          TopLeft="1995,1565" />
        <NodeLayout
          Size="274,42"
          Id="Package\Higienização - Contatos_sensedata_stage"
          TopLeft="74,116" />
        <NodeLayout
          Size="189,42"
          Id="Package\ID da integração - CRM"
          TopLeft="1254.66666666667,775.333333333333" />
        <NodeLayout
          Size="186,42"
          Id="Package\ID da integração - VFB"
          TopLeft="119,207" />
        <NodeLayout
          Size="197,42"
          Id="Package\Marca o e-mail duplicado"
          TopLeft="1960.66666666667,1216.33333333333" />
        <NodeLayout
          Size="217,42"
          Id="Package\Marca se o contato está ativo"
          TopLeft="1944.66666666667,1291.33333333333" />
        <NodeLayout
          Size="324,42"
          Id="Package\Tratamentos tabela Contatos_sensedata_integracao"
          TopLeft="1902,1478" />
        <NodeLayout
          Size="162,42"
          Id="Package\Upload S3 Bucket"
          TopLeft="1995,1668" />
        <NodeLayout
          Size="241,42"
          Id="Package\VFB -&gt; Contatos_sensedata_stage"
          TopLeft="83,17" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restrição]"
          TopLeft="207.25,59">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,57"
              Start="0,0"
              End="0,49.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,49.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restrição 1]"
          TopLeft="211.5,158">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,49"
              Start="0,0"
              End="0,41.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,41.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restrição 10]"
          TopLeft="1349.16666666667,817.333333333333">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="287.5,77"
              Start="0,0"
              End="287.5,69.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,34.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,34.5"
                    Point2="0,38.5"
                    Point3="4,38.5" />
                  <mssgle:LineSegment
                    End="283.5,38.5" />
                  <mssgle:CubicBezierSegment
                    Point1="283.5,38.5"
                    Point2="287.5,38.5"
                    Point3="287.5,42.5" />
                  <mssgle:LineSegment
                    End="287.5,69.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restrição 11]"
          TopLeft="1634.41666666667,936.333333333333">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,41"
              Start="0,0"
              End="0,33.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,33.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restrição 12]"
          TopLeft="1632.16666666667,1019.33333333333">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="437.5,109.999999999997"
              Start="0,0"
              End="437.5,102.499999999997">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,50.9999999999985" />
                  <mssgle:CubicBezierSegment
                    Point1="0,50.9999999999985"
                    Point2="0,54.9999999999985"
                    Point3="4,54.9999999999985" />
                  <mssgle:LineSegment
                    End="433.5,54.9999999999985" />
                  <mssgle:CubicBezierSegment
                    Point1="433.5,54.9999999999985"
                    Point2="437.5,54.9999999999985"
                    Point3="437.5,58.9999999999985" />
                  <mssgle:LineSegment
                    End="437.5,102.499999999997" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restrição 13]"
          TopLeft="2069.66666666667,1171.33333333333">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-10.5,45"
              Start="0,0"
              End="-10.5,37.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,18.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,18.5"
                    Point2="0,22.5"
                    Point3="-4,22.5" />
                  <mssgle:LineSegment
                    End="-6.5,22.5" />
                  <mssgle:CubicBezierSegment
                    Point1="-6.5,22.5"
                    Point2="-10.5,22.5"
                    Point3="-10.5,26.5" />
                  <mssgle:LineSegment
                    End="-10.5,37.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restrição 14]"
          TopLeft="2056.16666666667,1258.33333333333">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,33"
              Start="0,0"
              End="0,25.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,25.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restrição 15]"
          TopLeft="2056.33333333333,1333.33333333333">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,49.6666666666699"
              Start="0,0"
              End="0,42.1666666666699">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,42.1666666666699" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restrição 16]"
          TopLeft="2073.75,1607">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,61"
              Start="0,0"
              End="0,53.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,53.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restrição 17]"
          TopLeft="2061.75,1425">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,53"
              Start="0,0"
              End="0,45.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,45.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restrição 18]"
          TopLeft="2067.75,1520">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,45"
              Start="0,0"
              End="0,37.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,37.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restrição 2]"
          TopLeft="305,231">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="65,0"
              Start="0,0"
              End="57.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="57.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restrição 3]"
          TopLeft="533.75,255">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,40"
              Start="0,0"
              End="0,32.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,32.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restrição 4]"
          TopLeft="680,316">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="43,42"
              Start="0,0"
              End="35.5,42">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="17.5,0" />
                  <mssgle:CubicBezierSegment
                    Point1="17.5,0"
                    Point2="21.5,0"
                    Point3="21.5,4" />
                  <mssgle:LineSegment
                    End="21.5,38" />
                  <mssgle:CubicBezierSegment
                    Point1="21.5,38"
                    Point2="21.5,42"
                    Point3="25.5,42" />
                  <mssgle:LineSegment
                    End="35.5,42" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restrição 5]"
          TopLeft="538.75,337">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,50"
              Start="0,0"
              End="0,42.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,42.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restrição 6]"
          TopLeft="541,429">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="688.166666666667,58.3333333333334"
              Start="0,0"
              End="688.166666666667,50.8333333333334">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,25.1666666666667" />
                  <mssgle:CubicBezierSegment
                    Point1="0,25.1666666666667"
                    Point2="0,29.1666666666667"
                    Point3="4,29.1666666666667" />
                  <mssgle:LineSegment
                    End="684.166666666667,29.1666666666667" />
                  <mssgle:CubicBezierSegment
                    Point1="684.166666666667,29.1666666666667"
                    Point2="688.166666666667,29.1666666666667"
                    Point3="688.166666666667,33.1666666666667" />
                  <mssgle:LineSegment
                    End="688.166666666667,50.8333333333334" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restrição 7]"
          TopLeft="1230.16666666667,529.333333333333">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,49"
              Start="0,0"
              End="0,41.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,41.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restrição 8]"
          TopLeft="1231.16666666667,620.333333333333">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="115,62"
              Start="0,0"
              End="115,54.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,27" />
                  <mssgle:CubicBezierSegment
                    Point1="0,27"
                    Point2="0,31"
                    Point3="4,31" />
                  <mssgle:LineSegment
                    End="111,31" />
                  <mssgle:CubicBezierSegment
                    Point1="111,31"
                    Point2="115,31"
                    Point3="115,35" />
                  <mssgle:LineSegment
                    End="115,54.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restrição 9]"
          TopLeft="1347.66666666667,724.333333333333">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,51"
              Start="0,0"
              End="0,43.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,43.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <TaskHost
    design-time-name="Package\Exportação CSV">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="171,42"
          Id="Package\Exportação CSV\CSV ContatosVagas"
          TopLeft="425,229" />
        <NodeLayout
          Size="153,42"
          Id="Package\Exportação CSV\Contatos_vagas"
          TopLeft="430,123" />
        <EdgeLayout
          Id="Package\Exportação CSV.Paths[Saída de Origem OLE DB]"
          TopLeft="508.5,165">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,64"
              Start="0,0"
              End="0,56.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,56.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Exportação CSV\Contatos_vagas">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>
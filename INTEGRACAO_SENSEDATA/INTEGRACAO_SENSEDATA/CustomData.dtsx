<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="7/31/2019 4:31:33 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="DD9Y1H2"
  DTS:CreatorName="VAGASTEC\diego.gatto"
  DTS:DTSID="{6055D1EB-1FE9-43CC-8A83-4C8B6B02324D}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="14.0.3026.27"
  DTS:LocaleID="1046"
  DTS:ObjectName="CustomData"
  DTS:PackageType="5"
  DTS:ProtectionLevel="2"
  DTS:VersionBuild="108"
  DTS:VersionGUID="{D2A22D29-12DD-4305-BEE5-5E144E88DA38}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[CSV Custom Data]"
      DTS:CreationName="FLATFILE"
      DTS:DTSID="{04DBF2E0-FA46-40BA-AF85-99EFF912DA81}"
      DTS:ObjectName="CSV Custom Data">
      <DTS:PropertyExpression
        DTS:Name="ConnectionString">@[$Project::CSV_DIR] + "\\" + REPLACE(SUBSTRING((DT_STR,30,1252)GETDATE(),1,10),"-","_") +  "\\" + @[$Package::CSV_NAME]</DTS:PropertyExpression>
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:Format="Delimited"
          DTS:LocaleID="1046"
          DTS:HeaderRowDelimiter="_x000D__x000A_"
          DTS:ColumnNamesInFirstDataRow="True"
          DTS:RowDelimiter=""
          DTS:TextQualifier="_x0022_"
          DTS:CodePage="1252"
          DTS:ConnectionString="C:\Users\fiama.cristi\Documents\integracao_sensedata\ftp\2020_10_22\custom_data.csv">
          <DTS:FlatFileColumns>
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="50"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Cliente_VAGAS"
              DTS:DTSID="{1B39B10D-4CC5-436C-A4A7-380AE9041E5C}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="50"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Cod_Cli"
              DTS:DTSID="{A4A20C3F-5CAB-4DCC-B099-373392648E67}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="50"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="IdConta_CRM"
              DTS:DTSID="{9F1C1DC7-3DC2-45D3-A836-574F7BAF1B99}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="50"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Minimo_RE"
              DTS:DTSID="{D44FB982-B583-45BA-9FFC-6A4C1B8E0E1D}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="50"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Maximo_RE"
              DTS:DTSID="{520FE4DB-F33C-4972-8404-DE939B46BE59}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="50"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Capacidade_BCE"
              DTS:DTSID="{1C7C1182-54AA-4AC4-84E3-6DF43058F67B}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="50"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Qtd_BCE"
              DTS:DTSID="{A20A1BE8-257D-4A0F-8716-43C8BD09C2F4}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="50"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="% Uso BCE"
              DTS:DTSID="{C3C83F80-06F4-4D81-9195-DCB0B6CAF644}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="50"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Qtd_Meses_ClienteNovo"
              DTS:DTSID="{9BF5A6FB-FB1C-433B-B78F-D2CDEC830644}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="50"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Qtd_Vagas_Ult_6_Meses"
              DTS:DTSID="{D5350E18-ED79-4291-81CE-8E2C6DDD90EB}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="50"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="MEDIA_Vagas_Ult_6_Meses"
              DTS:DTSID="{9C787CA1-5465-4836-93BB-4F0CAF49D9BD}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="50"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Qtd_processos_Extracao_BCC_Ult_6_meses"
              DTS:DTSID="{6A41CD19-344B-4683-AD1D-E1AAB48B40ED}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="50"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="MEDIA_Extracao_BCC_Ult_6_meses"
              DTS:DTSID="{C466B404-C816-4BC9-A13A-D401BD49A2CE}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="50"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="PerfilUso_6Meses"
              DTS:DTSID="{F8808A69-C21B-4A6D-8006-8F351BA7F231}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="50"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="TaxaUso"
              DTS:DTSID="{B7BFCDE7-0BF1-485C-B1DB-75B1A11E6A96}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="50"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="QtdeRemocoes_Ult_6_meses"
              DTS:DTSID="{8FBC1577-C429-4458-8AF6-3105DBAED7DA}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="50"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="QtdeCVsRemovidos_Ult_6_meses"
              DTS:DTSID="{B40C39AB-A3D3-41B4-9CEA-3A1DDF82DE20}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="50"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="DATA_REFERENCIA"
              DTS:DTSID="{047E5318-FD09-4AFF-A129-265A3F1FD558}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x000D__x000A_"
              DTS:MaximumWidth="50"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="TAXA_USO_RECRUTADOR"
              DTS:DTSID="{2D91E562-33B9-406C-9DC4-96764CF77A85}"
              DTS:CreationName="" />
          </DTS:FlatFileColumns>
        </DTS:ConnectionManager>
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:PackageParameters>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{C8E5178A-7C12-4A3B-9318-C1FB254C2D3F}"
      DTS:ObjectName="CSV_NAME">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">custom_data.csv</DTS:Property>
    </DTS:PackageParameter>
  </DTS:PackageParameters>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{CD419243-E0B2-48A3-9C2A-4323C6FBF7FF}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="DATA_CARGA_INICIO">
      <DTS:VariableValue
        DTS:DataType="8">2018-03-09</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Criar tabelas temporárias"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:DelayValidation="True"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{35040284-250C-4112-8B11-305B264A928B}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Criar tabelas temporárias"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{01D8D567-93B2-4E49-A51A-28782164D7C4}"
          SQLTask:SqlStatementSource="DROP TABLE IF EXISTS STAGE.VAGAS_DW.TMP_CUSTOM_DATA_SENSEDATA&#xA;GO&#xA;&#xA;DECLARE&#x9;@Data_inicio DATE = DATEADD(DAY, 1, DATEADD(DAY, DAY(DATEADD(MONTH, -6, CONVERT(DATE, GETDATE()))) *-1, DATEADD(MONTH, -6, CONVERT(DATE, GETDATE())))),&#xA;&#x9;&#x9;@Data_fim DATE = DATEADD(MONTH, 6, CONVERT(SMALLDATETIME,CONVERT(VARCHAR,DATEADD(MONTH,-6,GETDATE()) - DAY(DATEADD(MONTH,-6,GETDATE())) + 1,112))) ;&#xA;&#xA;IF OBJECT_ID ('tempdb.dbo.#NovosClientes') IS NOT NULL&#xA;DROP TABLE #NovosClientes ;&#xA;&#xA;SELECT&#x9;A.CONTAID ,&#xA;&#x9;&#x9;B.COD_CLI ,&#xA;&#x9;&#x9;A.DataFechamento ,&#xA;&#x9;&#x9;DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, A.DataFechamento)) *-1, CONVERT(DATE, A.DataFechamento))) AS Data_Normalizada ,&#xA;&#x9;&#x9;DATEDIFF(MONTH, DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, A.DataFechamento)) *-1, CONVERT(DATE, A.DataFechamento))), @Data_fim) AS Qtd_Meses_ClienteNovo&#xA;INTO&#x9;#NovosClientes&#xA;FROM&#x9;[VAGAS_DW].[VAGAS_DW].[OPORTUNIDADES] AS A&#x9;&#x9;LEFT OUTER JOIN [VAGAS_DW].[VAGAS_DW].[CLIENTES] AS B ON A.CONTAID = B.CONTA_ID&#xA;WHERE&#x9;A.FASE = 'fechado_e_ganho'&#xA;&#x9;&#x9;AND A.RECORRENTE = 1&#xA;&#x9;&#x9;AND NOT EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[VAGAS_DW].[VAGAS_DW].[OPORTUNIDADES] AS AA1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;A.CONTAID = AA1.CONTAID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND AA1.FASE = 'fechado_e_ganho'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND AA1.RECORRENTE = 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND AA1.OportunidadeID &lt;&gt; A.OportunidadeID)&#xA;&#x9;&#x9;AND A.DataFechamento &gt;= @Data_inicio&#xA;&#x9;&#x9;AND A.DataFechamento &lt; @Data_fim&#xA;&#x9;&#x9;AND EXISTS (SELECT&#x9;*&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[VAGAS_DW].[CLIENTES] AS A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;A.CONTAID = A1.CONTA_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND A1.EX_CLIENTE = 0) &#xA;GROUP BY&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;A.CONTAID ,&#xA;&#x9;&#x9;B.COD_CLI ,&#xA;&#x9;&#x9;A.DataFechamento ,&#xA;&#x9;&#x9;DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, A.DataFechamento)) *-1, CONVERT(DATE, A.DataFechamento))) ,&#xA;&#x9;&#x9;DATEDIFF(MONTH, DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, A.DataFechamento)) *-1, CONVERT(DATE, A.DataFechamento))), @Data_fim)&#xA;UNION ALL&#xA;SELECT&#x9;A.CONTAID ,&#xA;&#x9;&#x9;B.COD_CLI ,&#xA;&#x9;&#x9;UltOppRec.DATAFECHAMENTO ,&#xA;&#x9;&#x9;DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, UltOppRec.DataFechamento)) *-1, CONVERT(DATE, UltOppRec.DataFechamento))) AS Data_Normalizada ,&#xA;&#x9;&#x9;DATEDIFF(MONTH, DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, UltOppRec.DataFechamento)) *-1, CONVERT(DATE, UltOppRec.DataFechamento))), @Data_fim)&#xA;FROM&#x9;[VAGAS_DW].[VAGAS_DW].[OPORTUNIDADES] AS A&#x9;&#x9;OUTER APPLY&#x9;(SELECT&#x9;TOP 1 *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; FROM&#x9;[VAGAS_DW].[VAGAS_DW].[OPORTUNIDADES] AS A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; WHERE&#x9;A.CONTAID = A1.CONTAID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; &#x9;&#x9;&#x9;AND A1.Fase = 'fechado_e_ganho'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND A1.RECORRENTE = 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND A1.OportunidadeCategoria = 'rescisão'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; ORDER BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;A1.DataFechamento DESC) AS UltOppRescisao&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OUTER APPLY (SELECT&#x9;TOP 1 *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; FROM&#x9;[VAGAS_DW].[VAGAS_DW].[OPORTUNIDADES] AS A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; WHERE&#x9;A.CONTAID = A1.CONTAID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND A1.Fase = 'fechado_e_ganho'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND A1.RECORRENTE = 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND A1.OportunidadeCategoria &lt;&gt; 'rescisão'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND A1.DataFechamento &gt; UltOppRescisao.DataFechamento&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; ORDER BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;A1.DataFechamento ASC) AS UltOppRec&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN [VAGAS_DW].[VAGAS_DW].[CLIENTES] AS B ON A.CONTAID = B.CONTA_ID&#xA;WHERE&#x9;A.FASE = 'fechado_e_ganho'&#xA;&#x9;&#x9;AND A.RECORRENTE = 1&#xA;&#x9;&#x9;AND UltOppRec.DataFechamento IS NOT NULL&#xA;&#x9;&#x9;AND UltOppRec.DataFechamento &gt;= @Data_inicio&#xA;&#x9;&#x9;AND UltOppRec.DataFechamento &lt; @Data_fim&#xA;&#x9;&#x9;AND EXISTS (SELECT&#x9;*&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[VAGAS_DW].[CLIENTES] AS A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;A.CONTAID = A1.CONTA_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND A1.EX_CLIENTE = 0)&#xA;GROUP BY&#xA;&#x9;&#x9;A.CONTAID ,&#xA;&#x9;&#x9;B.COD_CLI ,&#xA;&#x9;&#x9;UltOppRec.DataFechamento ,&#xA;&#x9;&#x9;DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, UltOppRec.DataFechamento)) *-1, CONVERT(DATE, UltOppRec.DataFechamento))) ,&#xA;&#x9;&#x9;DATEDIFF(MONTH, DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, UltOppRec.DataFechamento)) *-1, CONVERT(DATE, UltOppRec.DataFechamento))), @Data_fim) ;&#xA;-- (120 rows affected)&#xA;&#xA;-- Taxa de uso do Recrutador:&#xA;DROP TABLE IF EXISTS [stage].[VAGAS_DW].[Dados_Taxa_uso_Recrutador] ;&#xA;&#xA;SELECT&#x9;Cli.Cod_cli,&#xA;&#x9;&#x9;Cli.Ident_cli,&#xA;&#x9;&#x9;Cli.IdContaCRM_cli,&#xA;&#x9;&#x9;CredVagas.Cod_CredV, &#xA;&#x9;&#x9;CONVERT(DATE, CredVagas.Data_CredV) AS Data_contratacao, &#xA;&#x9;&#x9;CONVERT(DATE, CredVagas.DataVal_CredV) AS Data_validade, &#xA;&#x9;&#x9;CredVagas.Credito_CredV AS Qtd_credito_contratado, &#xA;&#x9;&#x9;CredVagas.Usados_CredV AS Qtd_credito_usado, &#xA;&#x9;&#x9;CredVagas.Custo_CredV AS ValorCusto_credito_contratado,&#xA;&#x9;&#x9;CASE WHEN CredVagas.DataVal_CredV &lt;= GETDATE() THEN 1 ELSE 0 END AS Creditos_expirados,&#xA;&#x9;&#x9;TipoCredVagas.Descr_CredVtipo AS Tipo_credito_contratado, &#xA;&#x9;&#x9;StatusCredVagas.Descr_CredVstatus AS Status_credito_contratado, &#xA;&#x9;&#x9;CredVagas.RespContrato_CredV, &#xA;&#x9;&#x9;CredVagas.Obs_CredV&#xA;INTO&#x9;[stage].[VAGAS_DW].[Dados_Taxa_uso_Recrutador]&#xA;FROM&#x9;[hrh-data].[dbo].[Clientes] AS Cli&#x9;&#x9;&#xA;&#x9;&#x9;LEFT JOIN [hrh-data].[dbo].[Creditos_VAGAS] AS CredVagas&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ON Cli.Cod_cli = CredVagas.CodCli_CredV&#xA;&#x9;&#x9;LEFT JOIN [hrh-data].[dbo].[Creditos_VAGAS_TipoCredito] AS TipoCredVagas&#x9;&#x9;ON CredVagas.TipoCredito_CredV = TipoCredVagas.Cod_CredVtipo&#xA;&#x9;&#x9;LEFT JOIN [hrh-data].[dbo].[Creditos_VAGAS_statusCredito] AS StatusCredVagas&#x9;ON CredVagas.Status_CredV = StatusCredVagas.Cod_CredVstatus&#xA;&#x9;&#x9;LEFT JOIN [hrh-data].[dbo].[Funcionarios] AS Func&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ON CredVagas.CodFuncResp_CredV = Func.Cod_func&#xA;&#x9;&#x9;LEFT JOIN [hrh-data].[dbo].[ManutUsuarios] AS ManutUsuarios&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ON CredVagas.CodUsuManut_CredV = ManutUsuarios.Cod_usuman&#xA;WHERE&#x9;EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[stage].[VAGAS_DW].[TMP_CLIENTES_SENSEDATA] AS Cli_sdt_A1&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;Cli.IdContaCRM_cli = Cli_sdt_A1.Id_ClienteCRM COLLATE SQL_Latin1_General_CP1_CI_AI&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND (Cli_sdt_A1.TIPO_CONTA = 'cliente_recrutador'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; OR Cli_sdt_A1.CATEGORIA_CONTA = 'cliente_recrutador'))&#xA;&#x9;&#x9;AND TipoCredVagas.Descr_CredVtipo = 'Compra de créditos'&#xA;&#x9;&#x9;AND&#x9;StatusCredVagas.Descr_CredVstatus = 'Liberado' ;&#xA;&#xA;&#xA;-- Taxa de uso do Recrutador ajustado (carregado no ambiente de produção 22/10/2020):&#xA;DROP TABLE IF EXISTS [VAGAS_DW].[TAB_TAXA_USO_RECRUTADOR]&#xA;SELECT&#x9;*,&#xA;&#x9;&#x9;IIF(A.QTD_CREDITOS_USADO = 0, 0, CONVERT(FLOAT, A.QTD_CREDITOS_USADO) / A.QTD_CREDITOS_CONTRATADO) AS TAXA_USO_RECRUTADOR&#xA;INTO&#x9;[VAGAS_DW].[TAB_TAXA_USO_RECRUTADOR]&#xA;FROM&#x9;(&#xA;&#x9;SELECT&#x9;Cod_cli,&#xA;&#x9;&#x9;&#x9;SUM(TX_A.Qtd_credito_contratado) AS Qtd_creditos_contratado,&#xA;&#x9;&#x9;&#x9;SUM(TX_A.Qtd_credito_usado) AS Qtd_creditos_usado&#xA;&#x9;FROM&#x9;[stage].[VAGAS_DW].[Dados_Taxa_uso_Recrutador] AS TX_A&#xA;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;Cod_cli ) AS A ;&#xA;&#xA;&#xA;&#xA;-- Consulta CustomData:&#xA;WITH  MaxPerfilUso AS&#xA;      (  &#xA;      SELECT A1.CodCli_cliPerfUso AS Cod_cli ,&#xA;&#x9;&#x9;&#x9; MAX(A1.Cod_cliPerfUso) Maxcod_CliPerfUso  &#xA;      FROM&#x9; [hrh-data].[dbo].[Clientes-PerfilUso] AS A1&#xA;      GROUP BY&#xA;&#x9;&#x9;&#x9; A1.CodCli_cliPerfUso  &#xA;      ) ,&#xA;&#x9;  BCE AS&#xA;&#x9;  (&#xA;&#x9;  SELECT A1.CodCliente_candCli AS Cod_cli ,&#xA;&#x9;&#x9;&#x9; COUNT(*) AS Qtd_BCE&#xA;&#x9;  FROM&#x9; [hrh-data].[dbo].[CandidatoxCliente] AS A1&#xA;&#x9;  WHERE&#x9; A1.Estado_CandCli &gt; 0&#xA;&#x9;  GROUP BY&#xA;&#x9;&#x9;&#x9;  A1.CodCliente_candCli&#xA;&#x9;  ) ,&#xA;&#x9;  Vagas AS&#xA;&#x9;  (&#xA;&#x9;  SELECT A1.CodCliente_vaga AS Cod_cli ,&#xA;&#x9;&#x9;&#x9; ROUND(COUNT(*)/IIF(A3.Cod_cli IS NULL, 6.0, A3.Qtd_Meses_ClienteNovo * 1.0), 2) AS MEDIA_Vagas_Ult_6_Meses ,&#xA;&#x9;&#x9;&#x9; COUNT(*) AS Qtd_Vagas_Ult_6_Meses&#xA;&#x9;  FROM&#x9; [hrh-data].[dbo].[Vagas] AS A1&#x9;INNER JOIN [hrh-data].[dbo].[Divisoes] AS A2 ON A1.CodDivVeic_vaga = A2.Cod_div&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN #NovosClientes AS A3 ON A1.CodCliente_vaga = A3.Cod_cli&#xA;&#x9;  WHERE  A1.ColetaCur_vaga = 0&#xA;&#x9;&#x9;     AND A1.VagaComExt_Vaga = 0&#xA;&#x9;&#x9;&#x9; AND A1.TipoProcesso_vaga = 0&#xA;&#x9;&#x9;&#x9; AND A1.VagaModelo_vaga = 0 &#xA;&#x9;&#x9;&#x9; AND LEFT(A1.Cargo_vaga,5) &lt;&gt; 'demo '  &#xA;&#x9;&#x9;&#x9; AND LEFT(A1.Cargo_vaga,5) &lt;&gt; 'demo-' -- &#xA;&#x9;&#x9;&#x9; AND A2.CodNavEx_div &lt;&gt; 300 -- Excluir RI&#xA;&#x9;&#x9;&#x9; AND A1.DtCriacao_vaga &gt;= @Data_inicio&#xA;&#x9;&#x9;&#x9; AND A1.DtCriacao_vaga &lt; @Data_fim&#xA;&#x9;  GROUP BY &#xA;&#x9;&#x9;&#x9; A1.CodCliente_vaga ,&#xA;&#x9;&#x9;&#x9; A3.Cod_cli ,&#xA;&#x9;&#x9;&#x9; A3.Qtd_Meses_ClienteNovo&#xA;&#x9; ) ,&#xA;&#x9; Extracao_BCC AS&#xA;&#x9; (&#xA;&#x9; SELECT A1.CodCliente_pedido AS Cod_cli ,&#xA;&#x9;&#x9;&#x9;ROUND(COUNT(*)/20/IIF(A3.Cod_cli IS NULL, 6.0, A3.Qtd_Meses_ClienteNovo * 1.0), 2) AS MEDIA_Extracao_BCC_Ult_6_meses ,&#xA;&#x9;        COUNT(*)/20 AS Qtd_processos&#xA;&#x9; FROM   [hrh-data].[dbo].[Pedidos] AS A1&#x9;INNER JOIN [hrh-data].[dbo].[Pedidos-itens] AS A2 ON A1.Cod_pedido = A2.CodPed_itemPed&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN #NovosClientes AS A3 ON A1.CodCliente_pedido = A3.Cod_cli&#xA;&#x9; WHERE&#x9;A2.EstadoCand_itemPed &gt;= 2 &#xA;&#x9;&#x9;&#x9;AND A1.Dt_pedido &gt;= @Data_inicio&#xA;&#x9;&#x9;&#x9;AND A1.Dt_pedido &lt; @Data_fim&#xA;&#x9; GROUP BY&#xA;&#x9;&#x9;&#x9;A1.CodCliente_pedido ,&#xA;&#x9;&#x9;&#x9;A3.Cod_cli ,&#xA;&#x9;&#x9;&#x9;A3.Qtd_Meses_ClienteNovo&#xA;&#x9; ) ,&#xA;&#x9; Remocoes_BCE AS&#xA;&#x9; (&#xA;&#x9; SELECT &#xA;&#x9;&#x9; Subquery.Cod_cli ,&#xA;&#x9;&#x9; COUNT(*) AS QtdeRemocoes_Ult_6_meses,&#xA;&#x9;&#x9; SUM(Subquery.QtdeCVsRemovidos) as QtdeCVsRemovidos_Ult_6_meses&#xA;&#x9; FROM (&#xA;&#x9;&#x9;&#x9;SELECT AA2.Cod_cli,&#xA;&#x9;&#x9;&#x9;&#x9;   COUNT(AA1.Cod_remBCE) AS QtdeRemocoes,&#xA;&#x9;&#x9;&#x9;&#x9;   COUNT(AA4.CodCand_remStG) AS QtdeCVsRemovidos&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;FROM   [hrh-data].[dbo].[RemBCE] AS AA1&#x9;INNER JOIN [hrh-data].[dbo].[Clientes] AS AA2 ON AA2.Cod_cli = AA1.CodCliente_remBCE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN [hrh-data].[dbo].[Funcionarios] AS AA3 ON AA3.Cod_func = AA1.CodFunc_rembce&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN [hrh-data].[dbo].[RemBCE_StatusG] AS AA4 ON AA4.CodRemBCE_remStG = AA1.Cod_remBCE&#xA;&#x9;&#x9;&#x9;WHERE  AA1.Data_remBCE &gt;= @Data_inicio&#xA;&#x9;&#x9;&#x9;&#x9;   AND AA1.Data_remBCE &lt; @Data_fim&#xA;&#x9;&#x9;&#x9;GROUP BY &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AA1.Cod_remBCE, &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AA2.Cod_cli&#xA;&#x9;&#x9;&#x9;) AS Subquery&#xA;&#x9; GROUP BY&#xA;&#x9;&#x9;&#x9;Subquery.Cod_cli&#xA;&#x9;  )&#xA;SELECT  A.Ident_Cli AS Cliente_VAGAS,&#xA;&#x9;    A.Cod_Cli AS Cod_Cli,&#xA;&#x9;&#x9;A.IdContaCRM_cli AS IdConta_CRM ,&#xA;&#x9;    ISNULL(C.QtdeMinVagas_cliPerfUso, 0) AS Minimo_RE ,&#xA;        ISNULL(C.QtdeMaxVagas_cliPerfUso, 0) AS Maximo_RE ,&#xA;&#x9;&#x9;A.CapacidadeBCAAtual_cli AS [Capacidade_BCE] ,&#xA;&#x9;&#x9;BCE.Qtd_BCE ,&#xA;&#x9;&#x9;FORMAT(CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN A.CapacidadeBCAAtual_cli &lt;&gt; 0 &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN ROUND(CONVERT(FLOAT, BCE.Qtd_BCE)/A.CapacidadeBCAAtual_cli, 4) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE 1 &#xA;&#x9;&#x9;&#x9;&#x9;END, 'P2') AS [% Uso BCE] ,&#xA;&#x9;&#x9;ISNULL(D.Qtd_Meses_ClienteNovo, 0) AS Qtd_Meses_ClienteNovo ,&#xA;&#x9;&#x9;ISNULL(E.Qtd_Vagas_Ult_6_Meses, 0) AS Qtd_Vagas_Ult_6_Meses ,&#xA;&#x9;&#x9;CONVERT(FLOAT, ISNULL(E.MEDIA_Vagas_Ult_6_Meses, 0.0)) AS MEDIA_Vagas_Ult_6_Meses ,&#xA;&#x9;&#x9;ISNULL(F.Qtd_processos,0) AS Qtd_processos_Extracao_BCC_Ult_6_meses ,&#xA;&#x9;&#x9;CONVERT(FLOAT, ISNULL(F.MEDIA_Extracao_BCC_Ult_6_meses,0.0)) AS MEDIA_Extracao_BCC_Ult_6_meses ,&#xA;&#x9;&#x9;CONVERT(FLOAT, ISNULL(E.MEDIA_Vagas_Ult_6_Meses, 0.0)) + CONVERT(FLOAT, ISNULL(F.MEDIA_Extracao_BCC_Ult_6_meses,0.0)) AS PerfilUso_6Meses ,&#xA;&#x9;&#x9;FORMAT(IIF(C.QtdeMaxVagas_cliPerfUso &gt; 0,&#xA;&#x9;&#x9;&#x9;(CONVERT(FLOAT, ISNULL(E.MEDIA_Vagas_Ult_6_Meses, 0.0)) + CONVERT(FLOAT, ISNULL(F.MEDIA_Extracao_BCC_Ult_6_meses, 0.0)))/C.QtdeMaxVagas_cliPerfUso, 0), 'P2')  AS TaxaUso ,&#xA;&#x9;&#x9;ISNULL(G.QtdeRemocoes_Ult_6_meses,0) AS QtdeRemocoes_Ult_6_meses ,&#xA;&#x9;&#x9;ISNULL(G.QtdeCVsRemovidos_Ult_6_meses,0) AS QtdeCVsRemovidos_Ult_6_meses ,&#xA;&#x9;&#x9;CONVERT(DATE, DATEADD(DAY, -1, GETDATE())) AS DATA_REFERENCIA, &#xA;&#x9;&#x9;FORMAT(ROUND(ISNULL(H.TAXA_USO_RECRUTADOR,0),2), 'P2') AS TAXA_USO_RECRUTADOR&#xA;INTO STAGE.VAGAS_DW.TMP_CUSTOM_DATA_SENSEDATA&#xA;FROM&#x9;[hrh-data].[dbo].[Clientes] AS A&#x9;&#x9;LEFT OUTER JOIN MaxPerfilUso AS B ON A.Cod_cli = B.Cod_cli&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN [hrh-data].dbo.[Clientes-PerfilUso] C ON C.Cod_cliPerfUso = B.Maxcod_CliPerfUso&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN BCE ON A.Cod_cli = BCE.Cod_cli&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN #NovosClientes AS D ON A.Cod_cli = D.Cod_cli&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN Vagas AS E ON A.Cod_cli = E.Cod_cli&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN Extracao_BCC AS F ON A.Cod_cli = F.Cod_cli&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN Remocoes_BCE AS G ON A.Cod_cli = G.Cod_cli&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN [stage].[VAGAS_DW].[TAB_TAXA_USO_RECRUTADOR] AS H ON A.Cod_cli= H.COD_CLI&#xA;WHERE&#x9;EXISTS (SELECT&#x9;*&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[VAGAS_DW].[VAGAS_DW].[CLIENTES] AS A1&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;A.Cod_cli = A1.COD_CLI&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND A1.EX_CLIENTE = 0) &#xA;&#x9;&#x9;AND NOT (A.Ident_cli LIKE '%Teste%'&#xA;&#x9;&#x9;&#x9;&#x9; OR A.Ident_cli LIKE '%Fict[íi]cia%') ;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Criar tabelas temporárias (bkp)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:DelayValidation="True"
      DTS:Description="Execute SQL Task"
      DTS:Disabled="True"
      DTS:DTSID="{a85fb448-5436-46c0-b370-231a81dded41}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Criar tabelas temporárias (bkp)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{01D8D567-93B2-4E49-A51A-28782164D7C4}"
          SQLTask:SqlStatementSource="DROP TABLE IF EXISTS STAGE.VAGAS_DW.TMP_CUSTOM_DATA_SENSEDATA&#xA;GO&#xA;&#xA;DECLARE @Data_inicio DATE = DATEADD(DAY, 1, DATEADD(DAY, DAY(DATEADD(MONTH, -6, CONVERT(DATE, GETDATE()))) *-1, DATEADD(MONTH, -6, CONVERT(DATE, GETDATE())))),&#xA;  @Data_fim DATE = DATEADD(MONTH, 6, CONVERT(SMALLDATETIME,CONVERT(VARCHAR,DATEADD(MONTH,-6,GETDATE()) - DAY(DATEADD(MONTH,-6,GETDATE())) + 1,112))) ;&#xA;&#xA;IF OBJECT_ID ('tempdb.dbo.#NovosClientes') IS NOT NULL&#xA;DROP TABLE #NovosClientes ;&#xA;&#xA;SELECT A.CONTAID ,&#xA;  B.COD_CLI ,&#xA;  A.DataFechamento ,&#xA;  DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, A.DataFechamento)) *-1, CONVERT(DATE, A.DataFechamento))) AS Data_Normalizada ,&#xA;  DATEDIFF(MONTH, DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, A.DataFechamento)) *-1, CONVERT(DATE, A.DataFechamento))), @Data_fim) AS Qtd_Meses_ClienteNovo&#xA;INTO #NovosClientes&#xA;FROM [VAGAS_DW].[VAGAS_DW].[OPORTUNIDADES] AS A  LEFT OUTER JOIN [VAGAS_DW].[VAGAS_DW].[CLIENTES] AS B ON A.CONTAID = B.CONTA_ID&#xA;WHERE A.FASE = 'fechado_e_ganho'&#xA;  AND A.RECORRENTE = 1&#xA;  AND NOT EXISTS (SELECT *&#xA;      FROM [VAGAS_DW].[VAGAS_DW].[OPORTUNIDADES] AS AA1&#xA;      WHERE A.CONTAID = AA1.CONTAID&#xA;        AND AA1.FASE = 'fechado_e_ganho'&#xA;        AND AA1.RECORRENTE = 1&#xA;        AND AA1.OportunidadeID &lt;&gt; A.OportunidadeID)&#xA;  AND A.DataFechamento &gt;= @Data_inicio&#xA;  AND A.DataFechamento &lt; @Data_fim&#xA;  AND EXISTS (SELECT *&#xA;     FROM [VAGAS_DW].[CLIENTES] AS A1&#xA;     WHERE A.CONTAID = A1.CONTA_ID&#xA;       AND A1.EX_CLIENTE = 0) &#xA;GROUP BY&#xA;  &#xA;  A.CONTAID ,&#xA;  B.COD_CLI ,&#xA;  A.DataFechamento ,&#xA;  DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, A.DataFechamento)) *-1, CONVERT(DATE, A.DataFechamento))) ,&#xA;  DATEDIFF(MONTH, DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, A.DataFechamento)) *-1, CONVERT(DATE, A.DataFechamento))), @Data_fim)&#xA;UNION ALL&#xA;SELECT A.CONTAID ,&#xA;  B.COD_CLI ,&#xA;  UltOppRec.DATAFECHAMENTO ,&#xA;  DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, UltOppRec.DataFechamento)) *-1, CONVERT(DATE, UltOppRec.DataFechamento))) AS Data_Normalizada ,&#xA;  DATEDIFF(MONTH, DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, UltOppRec.DataFechamento)) *-1, CONVERT(DATE, UltOppRec.DataFechamento))), @Data_fim)&#xA;FROM [VAGAS_DW].[VAGAS_DW].[OPORTUNIDADES] AS A  OUTER APPLY (SELECT TOP 1 *&#xA;                  FROM [VAGAS_DW].[VAGAS_DW].[OPORTUNIDADES] AS A1&#xA;                  WHERE A.CONTAID = A1.CONTAID&#xA;                    AND A1.Fase = 'fechado_e_ganho'&#xA;                   AND A1.RECORRENTE = 1&#xA;                   AND A1.OportunidadeCategoria = 'rescisão'&#xA;                  ORDER BY&#xA;                   A1.DataFechamento DESC) AS UltOppRescisao&#xA;              OUTER APPLY (SELECT TOP 1 *&#xA;                  FROM [VAGAS_DW].[VAGAS_DW].[OPORTUNIDADES] AS A1&#xA;                  WHERE A.CONTAID = A1.CONTAID&#xA;                   AND A1.Fase = 'fechado_e_ganho'&#xA;                   AND A1.RECORRENTE = 1&#xA;                   AND A1.OportunidadeCategoria &lt;&gt; 'rescisão'&#xA;                   AND A1.DataFechamento &gt; UltOppRescisao.DataFechamento&#xA;                  ORDER BY&#xA;                   A1.DataFechamento ASC) AS UltOppRec&#xA;              LEFT OUTER JOIN [VAGAS_DW].[VAGAS_DW].[CLIENTES] AS B ON A.CONTAID = B.CONTA_ID&#xA;WHERE A.FASE = 'fechado_e_ganho'&#xA;  AND A.RECORRENTE = 1&#xA;  AND UltOppRec.DataFechamento IS NOT NULL&#xA;  AND UltOppRec.DataFechamento &gt;= @Data_inicio&#xA;  AND UltOppRec.DataFechamento &lt; @Data_fim&#xA;  AND EXISTS (SELECT *&#xA;     FROM [VAGAS_DW].[CLIENTES] AS A1&#xA;     WHERE A.CONTAID = A1.CONTA_ID&#xA;       AND A1.EX_CLIENTE = 0)&#xA;GROUP BY&#xA;  A.CONTAID ,&#xA;  B.COD_CLI ,&#xA;  UltOppRec.DataFechamento ,&#xA;  DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, UltOppRec.DataFechamento)) *-1, CONVERT(DATE, UltOppRec.DataFechamento))) ,&#xA;  DATEDIFF(MONTH, DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, UltOppRec.DataFechamento)) *-1, CONVERT(DATE, UltOppRec.DataFechamento))), @Data_fim) ;&#xA;-- (120 rows affected)&#xA;&#xA;-- Consulta CustomData:&#xA;WITH  MaxPerfilUso AS&#xA;      (  &#xA;      SELECT A1.CodCli_cliPerfUso AS Cod_cli ,&#xA;    MAX(A1.Cod_cliPerfUso) Maxcod_CliPerfUso  &#xA;      FROM  [hrh-data].[dbo].[Clientes-PerfilUso] AS A1&#xA;      GROUP BY&#xA;    A1.CodCli_cliPerfUso  &#xA;      ) ,&#xA;   BCE AS&#xA;   (&#xA;   SELECT A1.CodCliente_candCli AS Cod_cli ,&#xA;    COUNT(*) AS Qtd_BCE&#xA;   FROM  [hrh-data].[dbo].[CandidatoxCliente] AS A1&#xA;   WHERE  A1.Estado_CandCli &gt; 0&#xA;   GROUP BY&#xA;     A1.CodCliente_candCli&#xA;   ) ,&#xA;   Vagas AS&#xA;   (&#xA;   SELECT A1.CodCliente_vaga AS Cod_cli ,&#xA;    ROUND(COUNT(*)/IIF(A3.Cod_cli IS NULL, 6.0, A3.Qtd_Meses_ClienteNovo * 1.0), 2) AS MEDIA_Vagas_Ult_6_Meses ,&#xA;    COUNT(*) AS Qtd_Vagas_Ult_6_Meses&#xA;   FROM  [hrh-data].[dbo].[Vagas] AS A1 INNER JOIN [hrh-data].[dbo].[Divisoes] AS A2 ON A1.CodDivVeic_vaga = A2.Cod_div&#xA;           LEFT OUTER JOIN #NovosClientes AS A3 ON A1.CodCliente_vaga = A3.Cod_cli&#xA;   WHERE  A1.ColetaCur_vaga = 0&#xA;       AND A1.VagaComExt_Vaga = 0&#xA;    AND A1.TipoProcesso_vaga = 0&#xA;    AND A1.VagaModelo_vaga = 0 &#xA;    AND LEFT(A1.Cargo_vaga,5) &lt;&gt; 'demo '  &#xA;    AND LEFT(A1.Cargo_vaga,5) &lt;&gt; 'demo-' -- &#xA;    AND A2.CodNavEx_div &lt;&gt; 300 -- Excluir RI&#xA;    AND A1.DtCriacao_vaga &gt;= @Data_inicio&#xA;    AND A1.DtCriacao_vaga &lt; @Data_fim&#xA;   GROUP BY &#xA;    A1.CodCliente_vaga ,&#xA;    A3.Cod_cli ,&#xA;    A3.Qtd_Meses_ClienteNovo&#xA;  ) ,&#xA;  Extracao_BCC AS&#xA;  (&#xA;  SELECT A1.CodCliente_pedido AS Cod_cli ,&#xA;   ROUND(COUNT(*)/20/IIF(A3.Cod_cli IS NULL, 6.0, A3.Qtd_Meses_ClienteNovo * 1.0), 2) AS MEDIA_Extracao_BCC_Ult_6_meses ,&#xA;         COUNT(*)/20 AS Qtd_processos&#xA;  FROM   [hrh-data].[dbo].[Pedidos] AS A1 INNER JOIN [hrh-data].[dbo].[Pedidos-itens] AS A2 ON A1.Cod_pedido = A2.CodPed_itemPed&#xA;            LEFT OUTER JOIN #NovosClientes AS A3 ON A1.CodCliente_pedido = A3.Cod_cli&#xA;  WHERE A2.EstadoCand_itemPed &gt;= 2 &#xA;   AND A1.Dt_pedido &gt;= @Data_inicio&#xA;   AND A1.Dt_pedido &lt; @Data_fim&#xA;  GROUP BY&#xA;   A1.CodCliente_pedido ,&#xA;   A3.Cod_cli ,&#xA;   A3.Qtd_Meses_ClienteNovo&#xA;  ) ,&#xA;  Remocoes_BCE AS&#xA;  (&#xA;  SELECT &#xA;   Subquery.Cod_cli ,&#xA;   COUNT(*) AS QtdeRemocoes_Ult_6_meses,&#xA;   SUM(Subquery.QtdeCVsRemovidos) as QtdeCVsRemovidos_Ult_6_meses&#xA;  FROM (&#xA;   SELECT AA2.Cod_cli,&#xA;       COUNT(AA1.Cod_remBCE) AS QtdeRemocoes,&#xA;       COUNT(AA4.CodCand_remStG) AS QtdeCVsRemovidos                &#xA;   FROM   [hrh-data].[dbo].[RemBCE] AS AA1 INNER JOIN [hrh-data].[dbo].[Clientes] AS AA2 ON AA2.Cod_cli = AA1.CodCliente_remBCE&#xA;             INNER JOIN [hrh-data].[dbo].[Funcionarios] AS AA3 ON AA3.Cod_func = AA1.CodFunc_rembce&#xA;             INNER JOIN [hrh-data].[dbo].[RemBCE_StatusG] AS AA4 ON AA4.CodRemBCE_remStG = AA1.Cod_remBCE&#xA;   WHERE  AA1.Data_remBCE &gt;= @Data_inicio&#xA;       AND AA1.Data_remBCE &lt; @Data_fim&#xA;   GROUP BY &#xA;     AA1.Cod_remBCE, &#xA;     AA2.Cod_cli&#xA;   ) AS Subquery&#xA;  GROUP BY&#xA;   Subquery.Cod_cli&#xA;   )&#xA;SELECT  A.Ident_Cli AS Cliente_VAGAS,&#xA;     A.Cod_Cli AS Cod_Cli,&#xA;  A.IdContaCRM_cli AS IdConta_CRM ,&#xA;     ISNULL(C.QtdeMinVagas_cliPerfUso, 0) AS Minimo_RE ,&#xA;        ISNULL(C.QtdeMaxVagas_cliPerfUso, 0) AS Maximo_RE ,&#xA;  A.CapacidadeBCAAtual_cli AS [Capacidade_BCE] ,&#xA;  BCE.Qtd_BCE ,&#xA;  FORMAT(CASE&#xA;     WHEN A.CapacidadeBCAAtual_cli &lt;&gt; 0 &#xA;      THEN ROUND(CONVERT(FLOAT, BCE.Qtd_BCE)/A.CapacidadeBCAAtual_cli, 4) &#xA;     ELSE 1 &#xA;    END, 'P2') AS [% Uso BCE] ,&#xA;  ISNULL(D.Qtd_Meses_ClienteNovo, 0) AS Qtd_Meses_ClienteNovo ,&#xA;  ISNULL(E.Qtd_Vagas_Ult_6_Meses, 0) AS Qtd_Vagas_Ult_6_Meses ,&#xA;  CONVERT(FLOAT, ISNULL(E.MEDIA_Vagas_Ult_6_Meses, 0.0)) AS MEDIA_Vagas_Ult_6_Meses ,&#xA;  ISNULL(F.Qtd_processos,0) AS Qtd_processos_Extracao_BCC_Ult_6_meses ,&#xA;  CONVERT(FLOAT, ISNULL(F.MEDIA_Extracao_BCC_Ult_6_meses,0.0)) AS MEDIA_Extracao_BCC_Ult_6_meses ,&#xA;  CONVERT(FLOAT, ISNULL(E.MEDIA_Vagas_Ult_6_Meses, 0.0)) + CONVERT(FLOAT, ISNULL(F.MEDIA_Extracao_BCC_Ult_6_meses,0.0)) AS PerfilUso_6Meses ,&#xA;  FORMAT(IIF(C.QtdeMaxVagas_cliPerfUso &gt; 0,&#xA;   (CONVERT(FLOAT, ISNULL(E.MEDIA_Vagas_Ult_6_Meses, 0.0)) + CONVERT(FLOAT, ISNULL(F.MEDIA_Extracao_BCC_Ult_6_meses, 0.0)))/C.QtdeMaxVagas_cliPerfUso, 0), 'P2')  AS TaxaUso ,&#xA;  ISNULL(G.QtdeRemocoes_Ult_6_meses,0) AS QtdeRemocoes_Ult_6_meses ,&#xA;  ISNULL(G.QtdeCVsRemovidos_Ult_6_meses,0) AS QtdeCVsRemovidos_Ult_6_meses ,&#xA;  CONVERT(DATE, DATEADD(DAY, -1, GETDATE())) AS DATA_REFERENCIA, &#xA;  FORMAT(ROUND(ISNULL(H.TAXA_USO_RECRUTADOR,0),2), 'P2') AS TAXA_USO_RECRUTADOR&#xA;INTO STAGE.VAGAS_DW.TMP_CUSTOM_DATA_SENSEDATA&#xA;FROM [hrh-data].[dbo].[Clientes] AS A  LEFT OUTER JOIN MaxPerfilUso AS B ON A.Cod_cli = B.Cod_cli&#xA;      LEFT OUTER JOIN [hrh-data].dbo.[Clientes-PerfilUso] C ON C.Cod_cliPerfUso = B.Maxcod_CliPerfUso&#xA;      LEFT OUTER JOIN BCE ON A.Cod_cli = BCE.Cod_cli&#xA;      LEFT OUTER JOIN #NovosClientes AS D ON A.Cod_cli = D.Cod_cli&#xA;      LEFT OUTER JOIN Vagas AS E ON A.Cod_cli = E.Cod_cli&#xA;      LEFT OUTER JOIN Extracao_BCC AS F ON A.Cod_cli = F.Cod_cli&#xA;      LEFT OUTER JOIN Remocoes_BCE AS G ON A.Cod_cli = G.Cod_cli&#xA;      LEFT OUTER JOIN [VAGAS_DW].[TAB_TAXA_USO_RECRUTADOR] AS H ON A.Cod_cli= H.COD_CLI&#xA;WHERE EXISTS (SELECT *&#xA;    FROM [VAGAS_DW].[VAGAS_DW].[CLIENTES] AS A1&#xA;    WHERE A.Cod_cli = A1.COD_CLI&#xA;      AND A1.EX_CLIENTE = 0) &#xA;  AND NOT (A.Ident_cli LIKE '%Teste%'&#xA;     OR A.Ident_cli LIKE '%Fict[íi]cia%') ;&#xA;&#xA;&#xA;&#xA;&#xA;-- Rotina de carga da Taxa de uso do recrutador na sensedata:&#xA;DROP TABLE IF EXISTS STAGE.[VAGAS_DW].[TMP_CICLO_CONTRATACAO_CREDITO] ;&#xA;DROP TABLE IF EXISTS STAGE.[VAGAS_DW].[TMP_CICLO_CONTRATACAO_CRED] ;&#xA;DROP TABLE IF EXISTS [VAGAS_DW].[CREDITOS_CONTRAT_USO] ;&#xA;DROP TABLE IF EXISTS [VAGAS_DW].[CREDITOS_SENSEDATA] ;&#xA;DROP TABLE IF EXISTS [VAGAS_DW].[TAB_TAXA_USO_RECRUTADOR] ;&#xA;&#xA;-- Ciclo de contratação (12 Meses):&#xA;SELECT A.CodCli_CredV AS COD_CLI ,&#xA;  CONVERT(DATE, A.Data_CredV) AS DATA_CONTRATACAO ,&#xA;  CONVERT(DATE, A.DataVal_CredV) AS DATA_VALIDADE ,&#xA;  A.Cod_CredV AS COD_CONTRATACAO ,&#xA;  (SELECT TOP 1 A1.Cod_CredV&#xA;   FROM [hrh-data].[dbo].[Creditos_VAGAS] AS A1 WITH(NOLOCK)&#xA;   WHERE A.CodCli_CredV = A1.CodCli_CredV&#xA;    AND A.DataVal_CredV = A1.DataVal_CredV&#xA;    AND A.Credito_CredV = A1.Credito_CredV&#xA;   ORDER BY&#xA;    A1.Cod_CredV) AS COD_INICIO_CICLO ,&#xA;  A.Credito_CredV AS CREDITO_CONTRATADO ,&#xA;  A.Usados_CredV AS CREDITO_USADO&#xA;INTO STAGE.[VAGAS_DW].[TMP_CICLO_CONTRATACAO_CREDITO]&#xA;FROM [hrh-data].[dbo].[Creditos_VAGAS] AS A WITH(NOLOCK)&#xA;ORDER BY&#xA;  COD_CLI ,&#xA;  COD_INICIO_CICLO ;&#xA;&#xA;&#xA;-- Visão consolidada do ciclo de contratação:&#xA;SELECT *&#xA;INTO STAGE.[VAGAS_DW].[TMP_CICLO_CONTRATACAO_CRED]&#xA;FROM STAGE.[VAGAS_DW].[TMP_CICLO_CONTRATACAO_CREDITO] AS A&#xA;WHERE EXISTS (SELECT *&#xA;       FROM STAGE.[VAGAS_DW].[TMP_CICLO_CONTRATACAO_CREDITO] AS A1&#xA;    WHERE A.COD_CLI = A1.COD_CLI&#xA;      AND A.COD_INICIO_CICLO = A1.COD_INICIO_CICLO&#xA;      AND (DATEDIFF(MONTH, A.DATA_CONTRATACAO, A1.DATA_CONTRATACAO) IN (-1,1))&#xA;      AND DAY(A.DATA_CONTRATACAO) = DAY(A1.DATA_CONTRATACAO)) ;&#xA;&#xA;&#xA;-- Tabela com a quantidade de crédito Recorrente e Pontual:  &#xA;SELECT A.COD_CLI,&#xA;  A.DATA_CONTRATACAO,&#xA;  A.DATA_VALIDADE,&#xA;  A.COD_CONTRATACAO,&#xA;  A.COD_INICIO_CICLO,&#xA;  A.CREDITO_CONTRATADO,&#xA;  A.CREDITO_USADO,&#xA;  TIPO = 'RECORRENTE'&#xA;INTO [VAGAS_DW].[CREDITOS_CONTRAT_USO]&#xA;FROM STAGE.VAGAS_DW.TMP_CICLO_CONTRATACAO_CRED AS A&#xA;UNION ALL&#xA;SELECT A.CodCli_CredV,&#xA;  CONVERT(DATE, A.Data_CredV),&#xA;  CONVERT(DATE, A.DataVal_CredV),&#xA;  A.Cod_CredV,&#xA;  A.Cod_CredV,&#xA;  A.Credito_CredV,&#xA;  A.Usados_CredV,&#xA;  'PONTUAL'&#xA;FROM [hrh-data].[dbo].[Creditos_VAGAS] AS A WITH(NOLOCK)&#xA;WHERE NOT EXISTS (SELECT *&#xA;     FROM STAGE.[VAGAS_DW].[TMP_CICLO_CONTRATACAO_CRED] AS A1&#xA;     WHERE A.Cod_CredV = A1.COD_CONTRATACAO) ;&#xA;&#xA;-- Relação de créditos contratados versus usado:&#xA;SELECT A.COD_CLI ,&#xA;  SUM(A.CREDITO_CONTRATADO) AS QTD_CREDITOS_CONTRATADO ,&#xA;  SUM(A.CREDITO_USADO) AS QTD_CREDITOS_USADO&#xA;INTO [VAGAS_DW].[CREDITOS_SENSEDATA]&#xA;FROM [VAGAS_DW].[CREDITOS_CONTRAT_USO] AS A&#xA;WHERE A.TIPO = 'RECORRENTE'&#xA;  AND A.COD_INICIO_CICLO = (SELECT MAX(A1.COD_INICIO_CICLO)&#xA;          FROM [VAGAS_DW].[CREDITOS_CONTRAT_USO] AS A1&#xA;          WHERE A.COD_CLI = A1.COD_CLI&#xA;          AND A1.TIPO = 'RECORRENTE') &#xA;GROUP BY&#xA;  A.COD_CLI ;&#xA;&#xA;&#xA;-- Taxa de uso do Recrutador:&#xA;SELECT A.COD_CLI ,&#xA;  IIF(A.QTD_CREDITOS_USADO = 0, 0, CONVERT(FLOAT, A.QTD_CREDITOS_USADO) / A.QTD_CREDITOS_CONTRATADO) AS TAXA_USO_RECRUTADOR&#xA;INTO [VAGAS_DW].[TAB_TAXA_USO_RECRUTADOR] &#xA;FROM [VAGAS_DW].[CREDITOS_SENSEDATA] AS A ;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Exceção"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarefa Executar SQL"
      DTS:Disabled="True"
      DTS:DTSID="{FA69C51C-BBF0-43C8-8D20-5E71ACE7D418}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Exceção"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{01D8D567-93B2-4E49-A51A-28782164D7C4}"
          SQLTask:SqlStatementSource="------------------------------------------------------------------&#xA;-- Ajustes dos registros da conta Oi devido a mudança de id_vagas:&#xA;------------------------------------------------------------------&#xA;-- Alteração do Id vagas de &quot;Oi&quot; pra &quot;Oi SA&quot;&#xA;&#xA;&#xA;DECLARE&#x9;@Data_inicio DATE = DATEADD(DAY, 1, DATEADD(DAY, DAY(DATEADD(MONTH, -6, CONVERT(DATE, GETDATE()))) *-1, DATEADD(MONTH, -6, CONVERT(DATE, GETDATE())))),&#xA;&#x9;&#x9;@Data_fim DATE = DATEADD(MONTH, 6, CONVERT(SMALLDATETIME,CONVERT(VARCHAR,DATEADD(MONTH,-6,GETDATE()) - DAY(DATEADD(MONTH,-6,GETDATE())) + 1,112))) ;&#xA;&#xA;IF OBJECT_ID ('tempdb.dbo.#NovosClientes') IS NOT NULL&#xA;DROP TABLE #NovosClientes ;&#xA;&#xA;SELECT&#x9;A.CONTAID ,&#xA;&#x9;&#x9;B.COD_CLI ,&#xA;&#x9;&#x9;A.DataFechamento ,&#xA;&#x9;&#x9;DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, A.DataFechamento)) *-1, CONVERT(DATE, A.DataFechamento))) AS Data_Normalizada ,&#xA;&#x9;&#x9;DATEDIFF(MONTH, DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, A.DataFechamento)) *-1, CONVERT(DATE, A.DataFechamento))), @Data_fim) AS Qtd_Meses_ClienteNovo&#xA;INTO&#x9;#NovosClientes&#xA;FROM&#x9;[VAGAS_DW].[VAGAS_DW].[OPORTUNIDADES] AS A&#x9;&#x9;LEFT OUTER JOIN [VAGAS_DW].[VAGAS_DW].[CLIENTES] AS B ON A.CONTAID = B.CONTA_ID&#xA;WHERE&#x9;A.FASE = 'fechado_e_ganho'&#xA;&#x9;&#x9;AND A.RECORRENTE = 1&#xA;&#x9;&#x9;AND NOT EXISTS (SELECT *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[VAGAS_DW].[VAGAS_DW].[OPORTUNIDADES] AS AA1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;A.CONTAID = AA1.CONTAID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND AA1.FASE = 'fechado_e_ganho'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND AA1.RECORRENTE = 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND AA1.OportunidadeID &lt;&gt; A.OportunidadeID)&#xA;&#x9;&#x9;AND A.DataFechamento &gt;= @Data_inicio&#xA;&#x9;&#x9;AND A.DataFechamento &lt; @Data_fim&#xA;&#x9;&#x9;AND EXISTS (SELECT&#x9;*&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[VAGAS_DW].[CLIENTES] AS A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;A.CONTAID = A1.CONTA_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND A1.EX_CLIENTE = 0) &#xA;GROUP BY&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;A.CONTAID ,&#xA;&#x9;&#x9;B.COD_CLI ,&#xA;&#x9;&#x9;A.DataFechamento ,&#xA;&#x9;&#x9;DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, A.DataFechamento)) *-1, CONVERT(DATE, A.DataFechamento))) ,&#xA;&#x9;&#x9;DATEDIFF(MONTH, DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, A.DataFechamento)) *-1, CONVERT(DATE, A.DataFechamento))), @Data_fim)&#xA;UNION ALL&#xA;SELECT&#x9;A.CONTAID ,&#xA;&#x9;&#x9;B.COD_CLI ,&#xA;&#x9;&#x9;UltOppRec.DATAFECHAMENTO ,&#xA;&#x9;&#x9;DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, UltOppRec.DataFechamento)) *-1, CONVERT(DATE, UltOppRec.DataFechamento))) AS Data_Normalizada ,&#xA;&#x9;&#x9;DATEDIFF(MONTH, DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, UltOppRec.DataFechamento)) *-1, CONVERT(DATE, UltOppRec.DataFechamento))), @Data_fim)&#xA;FROM&#x9;[VAGAS_DW].[VAGAS_DW].[OPORTUNIDADES] AS A&#x9;&#x9;OUTER APPLY&#x9;(SELECT&#x9;TOP 1 *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[VAGAS_DW].[VAGAS_DW].[OPORTUNIDADES] AS A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;A.CONTAID = A1.CONTAID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; &#x9;&#x9;&#x9;AND A1.Fase = 'fechado_e_ganho'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND A1.RECORRENTE = 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND A1.OportunidadeCategoria = 'rescisão'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ORDER BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;A1.DataFechamento DESC) AS UltOppRescisao&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OUTER APPLY (SELECT&#x9;TOP 1 *&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[VAGAS_DW].[VAGAS_DW].[OPORTUNIDADES] AS A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;A.CONTAID = A1.CONTAID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND A1.Fase = 'fechado_e_ganho'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND A1.RECORRENTE = 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND A1.OportunidadeCategoria &lt;&gt; 'rescisão'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND A1.DataFechamento &gt; UltOppRescisao.DataFechamento&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ORDER BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;A1.DataFechamento ASC) AS UltOppRec&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN [VAGAS_DW].[VAGAS_DW].[CLIENTES] AS B ON A.CONTAID = B.CONTA_ID&#xA;WHERE&#x9;A.FASE = 'fechado_e_ganho'&#xA;&#x9;&#x9;AND A.RECORRENTE = 1&#xA;&#x9;&#x9;AND UltOppRec.DataFechamento IS NOT NULL&#xA;&#x9;&#x9;AND UltOppRec.DataFechamento &gt;= @Data_inicio&#xA;&#x9;&#x9;AND UltOppRec.DataFechamento &lt; @Data_fim&#xA;&#x9;&#x9;AND EXISTS (SELECT&#x9;*&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#x9;[VAGAS_DW].[CLIENTES] AS A1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#x9;A.CONTAID = A1.CONTA_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND A1.EX_CLIENTE = 0)&#xA;GROUP BY&#xA;&#x9;&#x9;A.CONTAID ,&#xA;&#x9;&#x9;B.COD_CLI ,&#xA;&#x9;&#x9;UltOppRec.DataFechamento ,&#xA;&#x9;&#x9;DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, UltOppRec.DataFechamento)) *-1, CONVERT(DATE, UltOppRec.DataFechamento))) ,&#xA;&#x9;&#x9;DATEDIFF(MONTH, DATEADD(DAY, 1, DATEADD(DAY, DAY(CONVERT(DATE, UltOppRec.DataFechamento)) *-1, CONVERT(DATE, UltOppRec.DataFechamento))), @Data_fim) ;&#xA;-- (120 rows affected)&#xA;&#xA;-- Consulta CustomData:&#xA;WITH  MaxPerfilUso AS&#xA;&#x9;&#x9;(  &#xA;&#x9;&#x9;SELECT A1.CodCli_cliPerfUso AS Cod_cli ,&#xA;&#x9;&#x9;&#x9;&#x9;MAX(A1.Cod_cliPerfUso) Maxcod_CliPerfUso  &#xA;&#x9;&#x9;FROM&#x9; [hrh-data].[dbo].[Clientes-PerfilUso] AS A1&#xA;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;A1.CodCli_cliPerfUso  &#xA;&#x9;&#x9;) ,&#xA;&#x9;&#x9;BCE AS&#xA;&#x9;&#x9;(&#xA;&#x9;&#x9;SELECT A1.CodCliente_candCli AS Cod_cli ,&#xA;&#x9;&#x9;&#x9;&#x9;COUNT(*) AS Qtd_BCE&#xA;&#x9;&#x9;FROM&#x9; [hrh-data].[dbo].[CandidatoxCliente] AS A1&#xA;&#x9;&#x9;WHERE&#x9; A1.Estado_CandCli &gt; 0&#xA;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;A1.CodCliente_candCli&#xA;&#x9;&#x9;) ,&#xA;&#x9;&#x9;Vagas AS&#xA;&#x9;&#x9;(&#xA;&#x9;&#x9;SELECT A1.CodCliente_vaga AS Cod_cli ,&#xA;&#x9;&#x9;&#x9;&#x9;ROUND(COUNT(*)/IIF(A3.Cod_cli IS NULL, 6.0, A3.Qtd_Meses_ClienteNovo * 1.0), 2) AS MEDIA_Vagas_Ult_6_Meses ,&#xA;&#x9;&#x9;&#x9;&#x9;COUNT(*) AS Qtd_Vagas_Ult_6_Meses&#xA;&#x9;&#x9;FROM&#x9; [hrh-data].[dbo].[Vagas] AS A1&#x9;INNER JOIN [hrh-data].[dbo].[Divisoes] AS A2 ON A1.CodDivVeic_vaga = A2.Cod_div&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN #NovosClientes AS A3 ON A1.CodCliente_vaga = A3.Cod_cli&#xA;&#x9;&#x9;WHERE  A1.ColetaCur_vaga = 0&#xA;&#x9;&#x9;&#x9;&#x9;AND A1.VagaComExt_Vaga = 0&#xA;&#x9;&#x9;&#x9;&#x9;AND A1.TipoProcesso_vaga = 0&#xA;&#x9;&#x9;&#x9;&#x9;AND A1.VagaModelo_vaga = 0 &#xA;&#x9;&#x9;&#x9;&#x9;AND LEFT(A1.Cargo_vaga,5) &lt;&gt; 'demo '  &#xA;&#x9;&#x9;&#x9;&#x9;AND LEFT(A1.Cargo_vaga,5) &lt;&gt; 'demo-' -- &#xA;&#x9;&#x9;&#x9;&#x9;AND A2.CodNavEx_div &lt;&gt; 300 -- Excluir RI&#xA;&#x9;&#x9;&#x9;&#x9;AND A1.DtCriacao_vaga &gt;= @Data_inicio&#xA;&#x9;&#x9;&#x9;&#x9;AND A1.DtCriacao_vaga &lt; @Data_fim&#xA;&#x9;&#x9;GROUP BY &#xA;&#x9;&#x9;&#x9;&#x9;A1.CodCliente_vaga ,&#xA;&#x9;&#x9;&#x9;&#x9;A3.Cod_cli ,&#xA;&#x9;&#x9;&#x9;&#x9;A3.Qtd_Meses_ClienteNovo&#xA;&#x9;&#x9;) ,&#xA;&#x9;&#x9;Extracao_BCC AS&#xA;&#x9;&#x9;(&#xA;&#x9;&#x9;SELECT A1.CodCliente_pedido AS Cod_cli ,&#xA;&#x9;&#x9;&#x9;ROUND(COUNT(*)/20/IIF(A3.Cod_cli IS NULL, 6.0, A3.Qtd_Meses_ClienteNovo * 1.0), 2) AS MEDIA_Extracao_BCC_Ult_6_meses ,&#xA;&#x9;&#x9;&#x9;COUNT(*)/20 AS Qtd_processos&#xA;&#x9;&#x9;FROM   [hrh-data].[dbo].[Pedidos] AS A1&#x9;INNER JOIN [hrh-data].[dbo].[Pedidos-itens] AS A2 ON A1.Cod_pedido = A2.CodPed_itemPed&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN #NovosClientes AS A3 ON A1.CodCliente_pedido = A3.Cod_cli&#xA;&#x9;&#x9;WHERE&#x9;A2.EstadoCand_itemPed &gt;= 2 &#xA;&#x9;&#x9;&#x9;AND A1.Dt_pedido &gt;= @Data_inicio&#xA;&#x9;&#x9;&#x9;AND A1.Dt_pedido &lt; @Data_fim&#xA;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;A1.CodCliente_pedido ,&#xA;&#x9;&#x9;&#x9;A3.Cod_cli ,&#xA;&#x9;&#x9;&#x9;A3.Qtd_Meses_ClienteNovo&#xA;&#x9;&#x9;) ,&#xA;&#x9;&#x9;Remocoes_BCE AS&#xA;&#x9;&#x9;(&#xA;&#x9;&#x9;SELECT &#xA;&#x9;&#x9;&#x9;Subquery.Cod_cli ,&#xA;&#x9;&#x9;&#x9;COUNT(*) AS QtdeRemocoes_Ult_6_meses,&#xA;&#x9;&#x9;&#x9;SUM(Subquery.QtdeCVsRemovidos) as QtdeCVsRemovidos_Ult_6_meses&#xA;&#x9;&#x9;FROM (&#xA;&#x9;&#x9;&#x9;SELECT AA2.Cod_cli,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(AA1.Cod_remBCE) AS QtdeRemocoes,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(AA4.CodCand_remStG) AS QtdeCVsRemovidos&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;FROM   [hrh-data].[dbo].[RemBCE] AS AA1&#x9;INNER JOIN [hrh-data].[dbo].[Clientes] AS AA2 ON AA2.Cod_cli = AA1.CodCliente_remBCE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN [hrh-data].[dbo].[Funcionarios] AS AA3 ON AA3.Cod_func = AA1.CodFunc_rembce&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN [hrh-data].[dbo].[RemBCE_StatusG] AS AA4 ON AA4.CodRemBCE_remStG = AA1.Cod_remBCE&#xA;&#x9;&#x9;&#x9;WHERE  AA1.Data_remBCE &gt;= @Data_inicio&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND AA1.Data_remBCE &lt; @Data_fim&#xA;&#x9;&#x9;&#x9;GROUP BY &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AA1.Cod_remBCE, &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AA2.Cod_cli&#xA;&#x9;&#x9;&#x9;) AS Subquery&#xA;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;Subquery.Cod_cli&#xA;&#x9;&#x9;)&#xA;insert into STAGE.VAGAS_DW.TMP_CUSTOM_DATA_SENSEDATA&#xA;SELECT  A.Ident_Cli AS Cliente_VAGAS,&#xA;&#x9;&#x9;A.Cod_Cli AS Cod_Cli,&#xA;&#x9;&#x9;A.IdContaCRM_cli AS IdConta_CRM ,&#xA;&#x9;&#x9;ISNULL(C.QtdeMinVagas_cliPerfUso, 0) AS Minimo_RE ,&#xA;&#x9;&#x9;ISNULL(C.QtdeMaxVagas_cliPerfUso, 0) AS Maximo_RE ,&#xA;&#x9;&#x9;A.CapacidadeBCAAtual_cli AS [Capacidade_BCE] ,&#xA;&#x9;&#x9;BCE.Qtd_BCE ,&#xA;&#x9;&#x9;FORMAT(CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN A.CapacidadeBCAAtual_cli &lt;&gt; 0 &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN ROUND(CONVERT(FLOAT, BCE.Qtd_BCE)/A.CapacidadeBCAAtual_cli, 4) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE 1 &#xA;&#x9;&#x9;&#x9;&#x9;END, 'P2') AS [% Uso BCE] ,&#xA;&#x9;&#x9;ISNULL(D.Qtd_Meses_ClienteNovo, 0) AS Qtd_Meses_ClienteNovo ,&#xA;&#xA;&#xA;&#xA;&#x9;&#x9;ISNULL(E.Qtd_Vagas_Ult_6_Meses, 0) AS Qtd_Vagas_Ult_6_Meses ,&#xA;&#x9;&#x9;CONVERT(FLOAT, ISNULL(E.MEDIA_Vagas_Ult_6_Meses, 0.0)) AS MEDIA_Vagas_Ult_6_Meses ,&#xA;&#x9;&#x9;ISNULL(F.Qtd_processos,0) AS Qtd_processos_Extracao_BCC_Ult_6_meses ,&#xA;&#x9;&#x9;CONVERT(FLOAT, ISNULL(F.MEDIA_Extracao_BCC_Ult_6_meses,0.0)) AS MEDIA_Extracao_BCC_Ult_6_meses ,&#xA;&#x9;&#x9;CONVERT(FLOAT, ISNULL(E.MEDIA_Vagas_Ult_6_Meses, 0.0)) + CONVERT(FLOAT, ISNULL(F.MEDIA_Extracao_BCC_Ult_6_meses,0.0)) AS PerfilUso_6Meses ,&#xA;&#x9;&#x9;FORMAT(IIF(C.QtdeMaxVagas_cliPerfUso &gt; 0,&#xA;&#x9;&#x9;&#x9;(CONVERT(FLOAT, ISNULL(E.MEDIA_Vagas_Ult_6_Meses, 0.0)) + CONVERT(FLOAT, ISNULL(F.MEDIA_Extracao_BCC_Ult_6_meses, 0.0)))/C.QtdeMaxVagas_cliPerfUso, 0), 'P2')  AS TaxaUso ,&#xA;&#x9;&#x9;ISNULL(G.QtdeRemocoes_Ult_6_meses,0) AS QtdeRemocoes_Ult_6_meses ,&#xA;&#x9;&#x9;ISNULL(G.QtdeCVsRemovidos_Ult_6_meses,0) AS QtdeCVsRemovidos_Ult_6_meses ,&#xA;&#x9;&#x9;CONVERT(DATE, DATEADD(DAY, -1, GETDATE())) AS DATA_REFERENCIA, &#xA;&#x9;&#x9;FORMAT(ROUND(ISNULL(H.TAXA_USO_RECRUTADOR,0),2), 'P2') AS TAXA_USO_RECRUTADOR&#xA;FROM&#x9;[hrh-data].[dbo].[Clientes] AS A&#x9;&#x9;LEFT OUTER JOIN MaxPerfilUso AS B ON A.Cod_cli = B.Cod_cli&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN [hrh-data].dbo.[Clientes-PerfilUso] C ON C.Cod_cliPerfUso = B.Maxcod_CliPerfUso&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN BCE ON A.Cod_cli = BCE.Cod_cli&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN #NovosClientes AS D ON A.Cod_cli = D.Cod_cli&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN Vagas AS E ON A.Cod_cli = E.Cod_cli&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN Extracao_BCC AS F ON A.Cod_cli = F.Cod_cli&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN Remocoes_BCE AS G ON A.Cod_cli = G.Cod_cli&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN [VAGAS_DW].[TAB_TAXA_USO_RECRUTADOR] AS H ON A.Cod_cli= H.COD_CLI&#xA;WHERE&#x9;A.Cod_cli = 3266" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Exportar CSV"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:DelayValidation="True"
      DTS:Description="Tarefa Fluxo de Dados"
      DTS:DTSID="{2BB98D98-0DE6-4E37-A0B5-6F5A489640CF}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="Exportar CSV"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\Exportar CSV\CSV Custom Data"
              componentClassID="Microsoft.FlatFileDestination"
              contactInfo="Destino de Arquivo Simples;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation;  Todos os Direitos Reservados; http://www.microsoft.com/sql/support;0"
              description="Destino de Arquivo Simples"
              localeId="1046"
              name="CSV Custom Data">
              <properties>
                <property
                  dataType="System.Boolean"
                  description="Especifica se os dados substituirão o arquivo de destino ou serão anexados a ele."
                  name="Overwrite">true</property>
                <property
                  dataType="System.Null"
                  description="Especifica o texto a ser gravado no arquivo de destino antes da gravação de quaisquer dados."
                  expressionType="Notify"
                  name="Header" />
              </properties>
              <connections>
                <connection
                  refId="Package\Exportar CSV\CSV Custom Data.Connections[FlatFileConnection]"
                  connectionManagerID="Package.ConnectionManagers[CSV Custom Data]"
                  connectionManagerRefId="Package.ConnectionManagers[CSV Custom Data]"
                  name="FlatFileConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples]"
                  hasSideEffects="true"
                  name="Entrada de Destino de Arquivo Simples">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].Columns[Cliente_VAGAS]"
                      cachedDataType="wstr"
                      cachedLength="20"
                      cachedName="Cliente_VAGAS"
                      externalMetadataColumnId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Cliente_VAGAS]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Cliente_VAGAS]" />
                    <inputColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].Columns[Cod_Cli]"
                      cachedDataType="i4"
                      cachedName="Cod_Cli"
                      externalMetadataColumnId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Cod_Cli]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Cod_Cli]" />
                    <inputColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].Columns[IdConta_CRM]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="40"
                      cachedName="IdConta_CRM"
                      externalMetadataColumnId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[IdConta_CRM]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[IdConta_CRM]" />
                    <inputColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].Columns[Minimo_RE]"
                      cachedDataType="i4"
                      cachedName="Minimo_RE"
                      externalMetadataColumnId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Minimo_RE]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Minimo_RE]" />
                    <inputColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].Columns[Maximo_RE]"
                      cachedDataType="i4"
                      cachedName="Maximo_RE"
                      externalMetadataColumnId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Maximo_RE]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Maximo_RE]" />
                    <inputColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].Columns[Capacidade_BCE]"
                      cachedDataType="i4"
                      cachedName="Capacidade_BCE"
                      externalMetadataColumnId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Capacidade_BCE]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Capacidade_BCE]" />
                    <inputColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].Columns[Qtd_BCE]"
                      cachedDataType="i4"
                      cachedName="Qtd_BCE"
                      externalMetadataColumnId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Qtd_BCE]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Qtd_BCE]" />
                    <inputColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].Columns[% Uso BCE]"
                      cachedDataType="wstr"
                      cachedLength="4000"
                      cachedName="% Uso BCE"
                      externalMetadataColumnId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[% Uso BCE]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[% Uso BCE]" />
                    <inputColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].Columns[Qtd_Meses_ClienteNovo]"
                      cachedDataType="i4"
                      cachedName="Qtd_Meses_ClienteNovo"
                      externalMetadataColumnId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Qtd_Meses_ClienteNovo]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Qtd_Meses_ClienteNovo]" />
                    <inputColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].Columns[Qtd_Vagas_Ult_6_Meses]"
                      cachedDataType="i4"
                      cachedName="Qtd_Vagas_Ult_6_Meses"
                      externalMetadataColumnId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Qtd_Vagas_Ult_6_Meses]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Qtd_Vagas_Ult_6_Meses]" />
                    <inputColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].Columns[MEDIA_Vagas_Ult_6_Meses]"
                      cachedDataType="r8"
                      cachedName="MEDIA_Vagas_Ult_6_Meses"
                      externalMetadataColumnId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[MEDIA_Vagas_Ult_6_Meses]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[MEDIA_Vagas_Ult_6_Meses]" />
                    <inputColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].Columns[Qtd_processos_Extracao_BCC_Ult_6_meses]"
                      cachedDataType="i4"
                      cachedName="Qtd_processos_Extracao_BCC_Ult_6_meses"
                      externalMetadataColumnId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Qtd_processos_Extracao_BCC_Ult_6_meses]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Qtd_processos_Extracao_BCC_Ult_6_meses]" />
                    <inputColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].Columns[MEDIA_Extracao_BCC_Ult_6_meses]"
                      cachedDataType="r8"
                      cachedName="MEDIA_Extracao_BCC_Ult_6_meses"
                      externalMetadataColumnId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[MEDIA_Extracao_BCC_Ult_6_meses]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[MEDIA_Extracao_BCC_Ult_6_meses]" />
                    <inputColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].Columns[PerfilUso_6Meses]"
                      cachedDataType="r8"
                      cachedName="PerfilUso_6Meses"
                      externalMetadataColumnId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[PerfilUso_6Meses]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[PerfilUso_6Meses]" />
                    <inputColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].Columns[TaxaUso]"
                      cachedDataType="wstr"
                      cachedLength="4000"
                      cachedName="TaxaUso"
                      externalMetadataColumnId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[TaxaUso]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[TaxaUso]" />
                    <inputColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].Columns[QtdeRemocoes_Ult_6_meses]"
                      cachedDataType="i4"
                      cachedName="QtdeRemocoes_Ult_6_meses"
                      externalMetadataColumnId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[QtdeRemocoes_Ult_6_meses]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[QtdeRemocoes_Ult_6_meses]" />
                    <inputColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].Columns[QtdeCVsRemovidos_Ult_6_meses]"
                      cachedDataType="i4"
                      cachedName="QtdeCVsRemovidos_Ult_6_meses"
                      externalMetadataColumnId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[QtdeCVsRemovidos_Ult_6_meses]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[QtdeCVsRemovidos_Ult_6_meses]" />
                    <inputColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].Columns[DATA_REFERENCIA]"
                      cachedDataType="wstr"
                      cachedLength="10"
                      cachedName="DATA_REFERENCIA"
                      externalMetadataColumnId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[DATA_REFERENCIA]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[DATA_REFERENCIA]" />
                    <inputColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].Columns[TAXA_USO_RECRUTADOR]"
                      cachedDataType="wstr"
                      cachedLength="4000"
                      cachedName="TAXA_USO_RECRUTADOR"
                      externalMetadataColumnId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[TAXA_USO_RECRUTADOR]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[TAXA_USO_RECRUTADOR]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Cliente_VAGAS]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="Cliente_VAGAS" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Cod_Cli]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="Cod_Cli" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[IdConta_CRM]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="IdConta_CRM" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Minimo_RE]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="Minimo_RE" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Maximo_RE]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="Maximo_RE" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Capacidade_BCE]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="Capacidade_BCE" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Qtd_BCE]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="Qtd_BCE" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[% Uso BCE]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="% Uso BCE" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Qtd_Meses_ClienteNovo]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="Qtd_Meses_ClienteNovo" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Qtd_Vagas_Ult_6_Meses]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="Qtd_Vagas_Ult_6_Meses" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[MEDIA_Vagas_Ult_6_Meses]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="MEDIA_Vagas_Ult_6_Meses" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[Qtd_processos_Extracao_BCC_Ult_6_meses]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="Qtd_processos_Extracao_BCC_Ult_6_meses" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[MEDIA_Extracao_BCC_Ult_6_meses]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="MEDIA_Extracao_BCC_Ult_6_meses" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[PerfilUso_6Meses]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="PerfilUso_6Meses" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[TaxaUso]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="TaxaUso" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[QtdeRemocoes_Ult_6_meses]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="QtdeRemocoes_Ult_6_meses" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[QtdeCVsRemovidos_Ult_6_meses]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="QtdeCVsRemovidos_Ult_6_meses" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[DATA_REFERENCIA]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="DATA_REFERENCIA" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples].ExternalColumns[TAXA_USO_RECRUTADOR]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="TAXA_USO_RECRUTADOR" />
                  </externalMetadataColumns>
                </input>
              </inputs>
            </component>
            <component
              refId="Package\Exportar CSV\Origem OLE DB"
              componentClassID="Microsoft.OLEDBSource"
              contactInfo="Origem OLE DB;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation;  Todos os Direitos Reservados; http://www.microsoft.com/sql/support;7"
              description="Origem OLE DB"
              name="Origem OLE DB"
              usesDispositions="true"
              version="7">
              <properties>
                <property
                  dataType="System.Int32"
                  description="O tempo em segundos antes que um comando expire. Zero indica uma expiração infinita."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Especifica o nome do objeto de banco de dados usado para abrir um conjunto de linhas."
                  name="OpenRowset">[VAGAS_DW].[TMP_CUSTOM_DATA_SENSEDATA]</property>
                <property
                  dataType="System.String"
                  description="Especifica a variável que contém o nome do objeto de banco de dados usado para abrir um conjunto de linhas."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="O comando SQL a ser executado."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                <property
                  dataType="System.String"
                  description="A variável que contém o comando SQL a ser executado."
                  name="SqlCommandVariable"></property>
                <property
                  dataType="System.Int32"
                  description="Especifica a página de código de coluna a ser usada quando não há informações de página de código disponíveis a partir da fonte de dados."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forca o uso do valor da propriedade DefaultCodePage durante a descrição dos dados de caractere."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Especifica o modo usado para acessar o banco de dados."
                  name="AccessMode"
                  typeConverter="AccessMode">0</property>
                <property
                  dataType="System.String"
                  description="Os mapeamentos entre os parâmetros no comando SQL e as variáveis."
                  name="ParameterMapping"></property>
              </properties>
              <connections>
                <connection
                  refId="Package\Exportar CSV\Origem OLE DB.Connections[OleDbConnection]"
                  connectionManagerID="{C9C5C2E3-4F23-4A32-8949-107BB2A1C923}:external"
                  connectionManagerRefId="Project.ConnectionManagers[STAGE]"
                  description="A conexão de tempo de execução OLE DB usada para acessar o banco de dados."
                  name="OleDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB]"
                  name="Saída de Origem OLE DB">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Cliente_VAGAS]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[Cliente_VAGAS]"
                      length="20"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Cliente_VAGAS]"
                      name="Cliente_VAGAS"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Cod_Cli]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[Cod_Cli]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Cod_Cli]"
                      name="Cod_Cli"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[IdConta_CRM]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[IdConta_CRM]"
                      length="40"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[IdConta_CRM]"
                      name="IdConta_CRM"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Minimo_RE]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[Minimo_RE]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Minimo_RE]"
                      name="Minimo_RE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Maximo_RE]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[Maximo_RE]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Maximo_RE]"
                      name="Maximo_RE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Capacidade_BCE]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[Capacidade_BCE]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Capacidade_BCE]"
                      name="Capacidade_BCE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Qtd_BCE]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[Qtd_BCE]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Qtd_BCE]"
                      name="Qtd_BCE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[% Uso BCE]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[% Uso BCE]"
                      length="4000"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[% Uso BCE]"
                      name="% Uso BCE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Qtd_Meses_ClienteNovo]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[Qtd_Meses_ClienteNovo]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Qtd_Meses_ClienteNovo]"
                      name="Qtd_Meses_ClienteNovo"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Qtd_Vagas_Ult_6_Meses]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[Qtd_Vagas_Ult_6_Meses]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Qtd_Vagas_Ult_6_Meses]"
                      name="Qtd_Vagas_Ult_6_Meses"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[MEDIA_Vagas_Ult_6_Meses]"
                      dataType="r8"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[MEDIA_Vagas_Ult_6_Meses]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[MEDIA_Vagas_Ult_6_Meses]"
                      name="MEDIA_Vagas_Ult_6_Meses"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Qtd_processos_Extracao_BCC_Ult_6_meses]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[Qtd_processos_Extracao_BCC_Ult_6_meses]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[Qtd_processos_Extracao_BCC_Ult_6_meses]"
                      name="Qtd_processos_Extracao_BCC_Ult_6_meses"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[MEDIA_Extracao_BCC_Ult_6_meses]"
                      dataType="r8"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[MEDIA_Extracao_BCC_Ult_6_meses]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[MEDIA_Extracao_BCC_Ult_6_meses]"
                      name="MEDIA_Extracao_BCC_Ult_6_meses"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[PerfilUso_6Meses]"
                      dataType="r8"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[PerfilUso_6Meses]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[PerfilUso_6Meses]"
                      name="PerfilUso_6Meses"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[TaxaUso]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[TaxaUso]"
                      length="4000"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[TaxaUso]"
                      name="TaxaUso"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[QtdeRemocoes_Ult_6_meses]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[QtdeRemocoes_Ult_6_meses]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[QtdeRemocoes_Ult_6_meses]"
                      name="QtdeRemocoes_Ult_6_meses"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[QtdeCVsRemovidos_Ult_6_meses]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[QtdeCVsRemovidos_Ult_6_meses]"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[QtdeCVsRemovidos_Ult_6_meses]"
                      name="QtdeCVsRemovidos_Ult_6_meses"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[DATA_REFERENCIA]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[DATA_REFERENCIA]"
                      length="10"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[DATA_REFERENCIA]"
                      name="DATA_REFERENCIA"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[TAXA_USO_RECRUTADOR]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversão"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[TAXA_USO_RECRUTADOR]"
                      length="4000"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].Columns[TAXA_USO_RECRUTADOR]"
                      name="TAXA_USO_RECRUTADOR"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[Cliente_VAGAS]"
                      dataType="wstr"
                      length="20"
                      name="Cliente_VAGAS" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[Cod_Cli]"
                      dataType="i4"
                      name="Cod_Cli" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[IdConta_CRM]"
                      codePage="1252"
                      dataType="str"
                      length="40"
                      name="IdConta_CRM" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[Minimo_RE]"
                      dataType="i4"
                      name="Minimo_RE" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[Maximo_RE]"
                      dataType="i4"
                      name="Maximo_RE" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[Capacidade_BCE]"
                      dataType="i4"
                      name="Capacidade_BCE" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[Qtd_BCE]"
                      dataType="i4"
                      name="Qtd_BCE" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[% Uso BCE]"
                      dataType="wstr"
                      length="4000"
                      name="% Uso BCE" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[Qtd_Meses_ClienteNovo]"
                      dataType="i4"
                      name="Qtd_Meses_ClienteNovo" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[Qtd_Vagas_Ult_6_Meses]"
                      dataType="i4"
                      name="Qtd_Vagas_Ult_6_Meses" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[MEDIA_Vagas_Ult_6_Meses]"
                      dataType="r8"
                      name="MEDIA_Vagas_Ult_6_Meses" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[Qtd_processos_Extracao_BCC_Ult_6_meses]"
                      dataType="i4"
                      name="Qtd_processos_Extracao_BCC_Ult_6_meses" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[MEDIA_Extracao_BCC_Ult_6_meses]"
                      dataType="r8"
                      name="MEDIA_Extracao_BCC_Ult_6_meses" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[PerfilUso_6Meses]"
                      dataType="r8"
                      name="PerfilUso_6Meses" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[TaxaUso]"
                      dataType="wstr"
                      length="4000"
                      name="TaxaUso" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[QtdeRemocoes_Ult_6_meses]"
                      dataType="i4"
                      name="QtdeRemocoes_Ult_6_meses" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[QtdeCVsRemovidos_Ult_6_meses]"
                      dataType="i4"
                      name="QtdeCVsRemovidos_Ult_6_meses" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[DATA_REFERENCIA]"
                      dataType="dbDate"
                      name="DATA_REFERENCIA" />
                    <externalMetadataColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB].ExternalColumns[TAXA_USO_RECRUTADOR]"
                      dataType="wstr"
                      length="4000"
                      name="TAXA_USO_RECRUTADOR" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB]"
                  isErrorOut="true"
                  name="Saída de Erro de Origem OLE DB">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[Cliente_VAGAS]"
                      dataType="wstr"
                      length="20"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[Cliente_VAGAS]"
                      name="Cliente_VAGAS" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[Cod_Cli]"
                      dataType="i4"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[Cod_Cli]"
                      name="Cod_Cli" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[IdConta_CRM]"
                      codePage="1252"
                      dataType="str"
                      length="40"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[IdConta_CRM]"
                      name="IdConta_CRM" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[Minimo_RE]"
                      dataType="i4"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[Minimo_RE]"
                      name="Minimo_RE" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[Maximo_RE]"
                      dataType="i4"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[Maximo_RE]"
                      name="Maximo_RE" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[Capacidade_BCE]"
                      dataType="i4"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[Capacidade_BCE]"
                      name="Capacidade_BCE" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[Qtd_BCE]"
                      dataType="i4"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[Qtd_BCE]"
                      name="Qtd_BCE" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[% Uso BCE]"
                      dataType="wstr"
                      length="4000"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[% Uso BCE]"
                      name="% Uso BCE" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[Qtd_Meses_ClienteNovo]"
                      dataType="i4"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[Qtd_Meses_ClienteNovo]"
                      name="Qtd_Meses_ClienteNovo" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[Qtd_Vagas_Ult_6_Meses]"
                      dataType="i4"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[Qtd_Vagas_Ult_6_Meses]"
                      name="Qtd_Vagas_Ult_6_Meses" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[MEDIA_Vagas_Ult_6_Meses]"
                      dataType="r8"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[MEDIA_Vagas_Ult_6_Meses]"
                      name="MEDIA_Vagas_Ult_6_Meses" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[Qtd_processos_Extracao_BCC_Ult_6_meses]"
                      dataType="i4"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[Qtd_processos_Extracao_BCC_Ult_6_meses]"
                      name="Qtd_processos_Extracao_BCC_Ult_6_meses" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[MEDIA_Extracao_BCC_Ult_6_meses]"
                      dataType="r8"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[MEDIA_Extracao_BCC_Ult_6_meses]"
                      name="MEDIA_Extracao_BCC_Ult_6_meses" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[PerfilUso_6Meses]"
                      dataType="r8"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[PerfilUso_6Meses]"
                      name="PerfilUso_6Meses" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[TaxaUso]"
                      dataType="wstr"
                      length="4000"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[TaxaUso]"
                      name="TaxaUso" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[QtdeRemocoes_Ult_6_meses]"
                      dataType="i4"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[QtdeRemocoes_Ult_6_meses]"
                      name="QtdeRemocoes_Ult_6_meses" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[QtdeCVsRemovidos_Ult_6_meses]"
                      dataType="i4"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[QtdeCVsRemovidos_Ult_6_meses]"
                      name="QtdeCVsRemovidos_Ult_6_meses" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[DATA_REFERENCIA]"
                      dataType="dbDate"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[DATA_REFERENCIA]"
                      name="DATA_REFERENCIA" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[TAXA_USO_RECRUTADOR]"
                      dataType="wstr"
                      length="4000"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[TAXA_USO_RECRUTADOR]"
                      name="TAXA_USO_RECRUTADOR" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Erro de Origem OLE DB].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Exportar CSV.Paths[Saída de Origem OLE DB]"
              endId="Package\Exportar CSV\CSV Custom Data.Inputs[Entrada de Destino de Arquivo Simples]"
              name="Saída de Origem OLE DB"
              startId="Package\Exportar CSV\Origem OLE DB.Outputs[Saída de Origem OLE DB]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Obter metadados"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{FE38934F-F697-4D06-A060-09CFA32F33CD}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Obter metadados"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{01D8D567-93B2-4E49-A51A-28782164D7C4}"
          SQLTask:SqlStatementSource="SELECT VALOR &#xA;FROM [VAGAS_DW].[INTEGRACAO_SENSEDATA]&#xA;WHERE PACOTE = 'CUSTOM DATA' AND ATRIBUTO = 'ULTIMA_DATA'"
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="VALOR"
            SQLTask:DtsVariableName="User::DATA_CARGA_INICIO" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Salvar metadados"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{5388234D-7C8C-4BBC-9CF6-C349CC3FE0F0}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Salvar metadados"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{01D8D567-93B2-4E49-A51A-28782164D7C4}"
          SQLTask:SqlStatementSource="UPDATE [VAGAS_DW].[INTEGRACAO_SENSEDATA]&#xA;SET VALOR = (SELECT MAX(DATA_REFERENCIA) FROM STAGE.VAGAS_DW.TMP_CUSTOM_DATA_SENSEDATA)&#xA;WHERE PACOTE = 'CUSTOM DATA' AND ATRIBUTO = 'ULTIMA_DATA'" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Upload S3 Bucket"
      DTS:CreationName="Microsoft.ExecutePackageTask"
      DTS:Description="Tarefa Executar Pacote"
      DTS:DTSID="{7EF66B8B-EF9C-46A1-9212-D6CB912D9643}"
      DTS:ExecutableType="Microsoft.ExecutePackageTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Upload S3 Bucket"
      DTS:TaskContact="Microsoft Corporation; Microsoft SQL Server; Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:ObjectData>
        <ExecutePackageTask>
          <UseProjectReference>True</UseProjectReference>
          <PackageName>CargaPython.dtsx</PackageName>
          <ParameterAssignment>
            <ParameterName>CSV_NAME</ParameterName>
            <BindedVariableOrParameterName>$Package::CSV_NAME</BindedVariableOrParameterName>
          </ParameterAssignment>
        </ExecutePackageTask>
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{54EBF0E8-D1A5-484F-BC3A-F44138C14260}"
      DTS:From="Package\Exportar CSV"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\Upload S3 Bucket" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 3]"
      DTS:CreationName=""
      DTS:DTSID="{10B7840D-A975-427D-8596-B1CA03CA5AA0}"
      DTS:From="Package\Upload S3 Bucket"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 3"
      DTS:To="Package\Salvar metadados" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 4]"
      DTS:CreationName=""
      DTS:DTSID="{30913667-20AD-4271-BEF8-90A002FB2192}"
      DTS:From="Package\Obter metadados"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 4"
      DTS:To="Package\Criar tabelas temporárias" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restrição]"
      DTS:CreationName=""
      DTS:DTSID="{59E23DEA-C18B-42B9-8F47-820D35B29A8C}"
      DTS:From="Package\Criar tabelas temporárias"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restrição"
      DTS:To="Package\Exceção" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restrição 1]"
      DTS:CreationName=""
      DTS:DTSID="{42571260-0F5F-4DCA-9F02-64145D3AF70F}"
      DTS:From="Package\Exceção"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restrição 1"
      DTS:To="Package\Exportar CSV" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--Esta seção CDATA contém as informações de layout do pacote. A seção inclui informações como coordenadas (x,y), largura e altura.-->
<!--Se você editar manualmente esta seção e cometer algum erro, poderá excluí-la. -->
<!--O pacote ainda poderá ser carregado normalmente, mas as informações de layout anteriores serão perdidas e o designer reorganizará automaticamente os elementos na superfície de design.-->
<Objects
  Version="8">
  <!--Cada nó abaixo conterá propriedades que não afetam o comportamento em tempo de execução.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="16" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="197,42"
          Id="Package\Criar tabelas temporárias"
          TopLeft="381,97.5" />
        <NodeLayout
          Size="117,42"
          Id="Package\Exceção"
          TopLeft="297,192" />
        <NodeLayout
          Size="141,42"
          Id="Package\Exportar CSV"
          TopLeft="404,269.5" />
        <NodeLayout
          Size="160,42"
          Id="Package\Obter metadados"
          TopLeft="394.5,0.5" />
        <NodeLayout
          Size="163,42"
          Id="Package\Salvar metadados"
          TopLeft="396,459.5" />
        <NodeLayout
          Size="162,42"
          Id="Package\Upload S3 Bucket"
          TopLeft="393.5,367.5" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="474.5,311.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,56"
              Start="0,0"
              End="0,48.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,48.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 3]"
          TopLeft="476,409.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,50"
              Start="0,0"
              End="0,42.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,42.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 4]"
          TopLeft="477,42.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,55"
              Start="0,0"
              End="0,47.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,47.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restrição]"
          TopLeft="479.5,139.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-124,52.5"
              Start="0,0"
              End="-124,45">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,22.25" />
                  <mssgle:CubicBezierSegment
                    Point1="0,22.25"
                    Point2="0,26.25"
                    Point3="-4,26.25" />
                  <mssgle:LineSegment
                    End="-120,26.25" />
                  <mssgle:CubicBezierSegment
                    Point1="-120,26.25"
                    Point2="-124,26.25"
                    Point3="-124,30.25" />
                  <mssgle:LineSegment
                    End="-124,45" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restrição 1]"
          TopLeft="355.5,234">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="119,35.5"
              Start="0,0"
              End="119,28">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,13.75" />
                  <mssgle:CubicBezierSegment
                    Point1="0,13.75"
                    Point2="0,17.75"
                    Point3="4,17.75" />
                  <mssgle:LineSegment
                    End="115,17.75" />
                  <mssgle:CubicBezierSegment
                    Point1="115,17.75"
                    Point2="119,17.75"
                    Point3="119,21.75" />
                  <mssgle:LineSegment
                    End="119,28" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <NodeLayout
          Size="226,42"
          Id="Package\Criar tabelas temporárias (bkp)"
          TopLeft="667,100.5" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <TaskHost
    design-time-name="Package\Exportar CSV">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="152,42"
          Id="Package\Exportar CSV\Origem OLE DB"
          TopLeft="424,68" />
        <NodeLayout
          Size="162,42"
          Id="Package\Exportar CSV\CSV Custom Data"
          TopLeft="421,206" />
        <EdgeLayout
          Id="Package\Exportar CSV.Paths[Saída de Origem OLE DB]"
          TopLeft="501,110">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,96"
              Start="0,0"
              End="0,88.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,88.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Exportar CSV\Origem OLE DB">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
      <Property>
        <Name>TableInfoObjectType</Name>
        <Value
          type="q2:string">Table</Value>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>
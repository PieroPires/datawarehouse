<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Body>
    <ReportItems>
      <Tablix Name="table1">
        <TablixBody>
          <TablixColumns>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>2.4375in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>3.84375in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.53125in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.10417in</Width>
            </TablixColumn>
          </TablixColumns>
          <TablixRows>
            <TablixRow>
              <Height>0.21in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox2">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Ano/Mês</Value>
                              <Style>
                                <FontFamily>Trebuchet MS</FontFamily>
                                <FontSize>9pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                                <Color>White</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>textbox2</rd:DefaultName>
                      <Style>
                        <BackgroundColor>#006eb6</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox3">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Cliente</Value>
                              <Style>
                                <FontFamily>Trebuchet MS</FontFamily>
                                <FontSize>9pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                                <Color>White</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>textbox3</rd:DefaultName>
                      <Style>
                        <BackgroundColor>#006eb6</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox4">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Mensagem</Value>
                              <Style>
                                <FontFamily>Trebuchet MS</FontFamily>
                                <FontSize>9pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                                <Color>White</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>textbox4</rd:DefaultName>
                      <Style>
                        <BackgroundColor>#006eb6</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox5">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Estado</Value>
                              <Style>
                                <FontFamily>Trebuchet MS</FontFamily>
                                <FontSize>9pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                                <Color>White</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>textbox5</rd:DefaultName>
                      <Style>
                        <BackgroundColor>#006eb6</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox6">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Total</Value>
                              <Style>
                                <FontFamily>Trebuchet MS</FontFamily>
                                <FontSize>9pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                                <Color>White</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>textbox6</rd:DefaultName>
                      <Style>
                        <BackgroundColor>#006eb6</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.21in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Ano_Mes">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Ano_Mes.Value</Value>
                              <Style>
                                <FontFamily>Trebuchet MS</FontFamily>
                                <FontSize>9pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Ano_Mes</rd:DefaultName>
                      <Style>
                        <BackgroundColor>=IIf((RowNumber("table1") mod 2), "Gainsboro", "White")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Cliente">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Cliente.Value</Value>
                              <Style>
                                <FontFamily>Trebuchet MS</FontFamily>
                                <FontSize>9pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Cliente</rd:DefaultName>
                      <Style>
                        <BackgroundColor>=IIf((RowNumber("table1") mod 2), "Gainsboro", "White")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Mensagem">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Mensagem.Value</Value>
                              <Style>
                                <FontFamily>Trebuchet MS</FontFamily>
                                <FontSize>9pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Mensagem</rd:DefaultName>
                      <Style>
                        <BackgroundColor>=IIf((RowNumber("table1") mod 2), "Gainsboro", "White")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Estado">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Estado.Value</Value>
                              <Style>
                                <FontFamily>Trebuchet MS</FontFamily>
                                <FontSize>9pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Estado</rd:DefaultName>
                      <Style>
                        <BackgroundColor>=IIf((RowNumber("table1") mod 2), "Gainsboro", "White")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Qtd_enviadas">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Qtd_enviadas.Value</Value>
                              <Style>
                                <FontFamily>Trebuchet MS</FontFamily>
                                <FontSize>9pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Qtd_enviadas</rd:DefaultName>
                      <Style>
                        <BackgroundColor>=IIf((RowNumber("table1") mod 2), "Gainsboro", "White")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
          </TablixRows>
        </TablixBody>
        <TablixColumnHierarchy>
          <TablixMembers>
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
          </TablixMembers>
        </TablixColumnHierarchy>
        <TablixRowHierarchy>
          <TablixMembers>
            <TablixMember>
              <KeepWithGroup>After</KeepWithGroup>
              <RepeatOnNewPage>true</RepeatOnNewPage>
              <KeepTogether>true</KeepTogether>
            </TablixMember>
            <TablixMember>
              <Group Name="table1_Details_Group">
                <DataElementName>Detail</DataElementName>
              </Group>
              <TablixMembers>
                <TablixMember />
              </TablixMembers>
              <DataElementName>Detail_Collection</DataElementName>
              <DataElementOutput>Output</DataElementOutput>
              <KeepTogether>true</KeepTogether>
            </TablixMember>
          </TablixMembers>
        </TablixRowHierarchy>
        <DataSetName>DATASET_Clientes_mensagem_padrao</DataSetName>
        <Top>0.17639cm</Top>
        <Left>0.65279cm</Left>
        <Height>0.42in</Height>
        <Width>9.91667in</Width>
        <Style>
          <Border>
            <Color>LightGrey</Color>
            <Style>Solid</Style>
          </Border>
        </Style>
      </Tablix>
    </ReportItems>
    <Height>1.6002cm</Height>
    <Style />
  </Body>
  <Width>34.2149cm</Width>
  <Page>
    <PageHeader>
      <Height>1.30541cm</Height>
      <PrintOnFirstPage>true</PrintOnFirstPage>
      <PrintOnLastPage>true</PrintOnLastPage>
      <ReportItems>
        <Textbox Name="textbox1">
          <CanGrow>true</CanGrow>
          <KeepTogether>true</KeepTogether>
          <Paragraphs>
            <Paragraph>
              <TextRuns>
                <TextRun>
                  <Value>Clientes com mensagem padrão enviada ou chamado removido</Value>
                  <Style>
                    <FontFamily>Trebuchet MS</FontFamily>
                    <FontSize>15pt</FontSize>
                    <FontWeight>Bold</FontWeight>
                  </Style>
                </TextRun>
              </TextRuns>
              <Style>
                <TextAlign>Left</TextAlign>
              </Style>
            </Paragraph>
            <Paragraph>
              <TextRuns>
                <TextRun>
                  <Value />
                  <Style>
                    <FontFamily>Trebuchet MS</FontFamily>
                    <FontWeight>Normal</FontWeight>
                  </Style>
                </TextRun>
              </TextRuns>
              <Style>
                <TextAlign>Left</TextAlign>
              </Style>
            </Paragraph>
          </Paragraphs>
          <rd:DefaultName>textbox1</rd:DefaultName>
          <Left>0.65279cm</Left>
          <Height>0.51394in</Height>
          <Width>6.35417in</Width>
          <Style>
            <PaddingLeft>2pt</PaddingLeft>
            <PaddingRight>2pt</PaddingRight>
            <PaddingTop>2pt</PaddingTop>
            <PaddingBottom>2pt</PaddingBottom>
          </Style>
        </Textbox>
        <Textbox Name="Textbox9">
          <CanGrow>true</CanGrow>
          <KeepTogether>true</KeepTogether>
          <Paragraphs>
            <Paragraph>
              <TextRuns>
                <TextRun>
                  <Value>Qualitativo</Value>
                  <Style>
                    <FontWeight>Bold</FontWeight>
                    <Color>White</Color>
                  </Style>
                </TextRun>
              </TextRuns>
              <Style>
                <TextAlign>Center</TextAlign>
              </Style>
            </Paragraph>
          </Paragraphs>
          <rd:DefaultName>Textbox9</rd:DefaultName>
          <ActionInfo>
            <Actions>
              <Action>
                <Drillthrough>
                  <ReportName>Clientes com mensagem padrão enviada ou chamado removido (qualitativo)</ReportName>
                </Drillthrough>
              </Action>
            </Actions>
          </ActionInfo>
          <Top>0.15557cm</Top>
          <Left>21.69266cm</Left>
          <Height>0.25in</Height>
          <Width>1.16098in</Width>
          <ZIndex>1</ZIndex>
          <Style>
            <Border>
              <Style>None</Style>
            </Border>
            <BackgroundColor>#469ad2</BackgroundColor>
            <PaddingLeft>2pt</PaddingLeft>
            <PaddingRight>2pt</PaddingRight>
            <PaddingTop>2pt</PaddingTop>
            <PaddingBottom>2pt</PaddingBottom>
          </Style>
        </Textbox>
        <Textbox Name="Textbox10">
          <CanGrow>true</CanGrow>
          <KeepTogether>true</KeepTogether>
          <Paragraphs>
            <Paragraph>
              <TextRuns>
                <TextRun>
                  <Value>Quantitativo</Value>
                  <Style>
                    <FontWeight>Bold</FontWeight>
                    <Color>White</Color>
                  </Style>
                </TextRun>
              </TextRuns>
              <Style>
                <TextAlign>Center</TextAlign>
              </Style>
            </Paragraph>
          </Paragraphs>
          <rd:DefaultName>Textbox9</rd:DefaultName>
          <Top>0.15557cm</Top>
          <Left>24.78266cm</Left>
          <Height>0.25in</Height>
          <Width>1.16098in</Width>
          <ZIndex>2</ZIndex>
          <Style>
            <Border>
              <Style>None</Style>
            </Border>
            <BackgroundColor>#006eb6</BackgroundColor>
            <PaddingLeft>2pt</PaddingLeft>
            <PaddingRight>2pt</PaddingRight>
            <PaddingTop>2pt</PaddingTop>
            <PaddingBottom>2pt</PaddingBottom>
          </Style>
        </Textbox>
      </ReportItems>
      <Style>
        <Border>
          <Style>None</Style>
        </Border>
      </Style>
    </PageHeader>
    <PageFooter>
      <Height>1.92264cm</Height>
      <PrintOnFirstPage>true</PrintOnFirstPage>
      <PrintOnLastPage>true</PrintOnLastPage>
      <ReportItems>
        <Textbox Name="Textbox7">
          <CanGrow>true</CanGrow>
          <KeepTogether>true</KeepTogether>
          <Paragraphs>
            <Paragraph>
              <TextRuns>
                <TextRun>
                  <Value>Página </Value>
                  <Style>
                    <FontFamily>Trebuchet MS</FontFamily>
                    <FontSize>9pt</FontSize>
                  </Style>
                </TextRun>
                <TextRun>
                  <Value>=Globals!PageNumber</Value>
                  <Style>
                    <FontFamily>Trebuchet MS</FontFamily>
                    <FontSize>9pt</FontSize>
                  </Style>
                </TextRun>
                <TextRun>
                  <Value> de </Value>
                  <Style>
                    <FontFamily>Trebuchet MS</FontFamily>
                    <FontSize>9pt</FontSize>
                  </Style>
                </TextRun>
                <TextRun>
                  <Value>=Globals!TotalPages</Value>
                  <Style>
                    <FontFamily>Trebuchet MS</FontFamily>
                    <FontSize>9pt</FontSize>
                  </Style>
                </TextRun>
              </TextRuns>
              <Style />
            </Paragraph>
            <Paragraph>
              <TextRuns>
                <TextRun>
                  <Value>Executado em: </Value>
                  <Style>
                    <FontFamily>Trebuchet MS</FontFamily>
                    <FontSize>9pt</FontSize>
                  </Style>
                </TextRun>
                <TextRun>
                  <Value>=Globals!ExecutionTime</Value>
                  <Style>
                    <FontFamily>Trebuchet MS</FontFamily>
                    <FontSize>9pt</FontSize>
                    <Format>dd/MM/yyyy HH:mm:ss</Format>
                  </Style>
                </TextRun>
              </TextRuns>
              <Style />
            </Paragraph>
          </Paragraphs>
          <rd:DefaultName>Textbox7</rd:DefaultName>
          <Top>0.14111cm</Top>
          <Left>0.65276cm</Left>
          <Height>1.33174cm</Height>
          <Width>3.01042in</Width>
          <Style>
            <Border>
              <Style>None</Style>
            </Border>
            <PaddingLeft>2pt</PaddingLeft>
            <PaddingRight>2pt</PaddingRight>
            <PaddingTop>2pt</PaddingTop>
            <PaddingBottom>2pt</PaddingBottom>
          </Style>
        </Textbox>
      </ReportItems>
      <Style>
        <Border>
          <Style>None</Style>
        </Border>
      </Style>
    </PageFooter>
    <PageHeight>21.0058cm</PageHeight>
    <PageWidth>36.2149cm</PageWidth>
    <LeftMargin>1cm</LeftMargin>
    <RightMargin>1cm</RightMargin>
    <TopMargin>1cm</TopMargin>
    <BottomMargin>1cm</BottomMargin>
    <ColumnSpacing>1.27cm</ColumnSpacing>
    <Style />
  </Page>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="OTRS">
      <DataSourceReference>OTRS</DataSourceReference>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>77de56d7-4085-4912-9e79-8e2bdf249e1a</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DATASET_Clientes_mensagem_padrao">
      <Query>
        <DataSourceName>OTRS</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="?">
            <Value>=Parameters!Ano.Value</Value>
          </QueryParameter>
          <QueryParameter Name="?">
            <Value>=Parameters!Mes.Value</Value>
            <rd:UserDefined>true</rd:UserDefined>
          </QueryParameter>
        </QueryParameters>
        <CommandText>select	left(DtAlteracao, 7) as 'Ano/Mes'
		, Cliente
        , Mensagem
        , Estado
        , count(Mensagem) as Qtd_enviadas
from( 
		 select	distinct 
				cast(max(th.change_time) as date) as DtAlteracao #Ultima da de alteração do chamado no histórico de chamados
				, t.tn as Protocolo #Número do protocolo (interface otrs)
				, case	when dfv.value_text='1' then 'Itaú'
						when dfv.value_text='2' then 'Deloitte'
						when dfv.value_text='3' then 'IEL/PR'
						when dfv.value_text='4' then 'EY'
						when dfv.value_text='5' then 'Samsung'
						when dfv.value_text='6' then 'Porto Seguro'
						when dfv.value_text='7' then 'Cia de Talentos'
						when dfv.value_text='8' then 'CDB'
						when dfv.value_text='9' then 'Page Talent'
						when dfv.value_text='10' then 'Meta RH'
						when dfv.value_text='11' then 'Danone'
						when dfv.value_text='12' then 'Bimbo'
						when dfv.value_text='13' then 'Carpe Diem'
						when dfv.value_text='14' then 'Itrade'
						when dfv.value_text='15' then 'FFM'
						when dfv.value_text='16' then 'Oi'
						when dfv.value_text='17' then 'Tim'
						when dfv.value_text='18' then 'Vallourec'
						when dfv.value_text='19' then 'Scania'
						when dfv.value_text='20' then 'Zilor'
						when dfv.value_text='21' then 'Targo'
						when dfv.value_text='22' then 'Grupo Fleury'
						when dfv.value_text='23' then 'CV Novo'
						when dfv.value_text='24' then 'KPMG'
						when dfv.value_text='25' then 'John Deere'
						when dfv.value_text='26' then 'Nextel'
						when dfv.value_text='27' then 'Guarani'
						when dfv.value_text='28' then 'Teleperformance'
						when dfv.value_text='29' then 'Odebrecht'
						when dfv.value_text='30' then 'Sanofi'
						when dfv.value_text='31' then 'Albert Einstein'
						when dfv.value_text='32' then 'Trajetória RH'
						when dfv.value_text='33' then 'Unimed florianopolis'
						when dfv.value_text='34' then 'Hermes Pardini'
						when dfv.value_text='35' then 'Capgemini'
						when dfv.value_text='36' then 'Contax'	
						when dfv.value_text='37' then 'ONS'
						when dfv.value_text='38' then 'RH Inter'
						when dfv.value_text='39' then 'DASA'
						when dfv.value_text='40' then 'Padrão Removido'
						when dfv.value_text='41' then 'Rio 2016'
						when dfv.value_text='42' then 'Bosch'
						when dfv.value_text='43' then 'BRF'		
						when dfv.value_text='44' then 'Viva Talentos'	 
						when dfv.value_text='45' then 'CV por e-mail'	 
                        when dfv.value_text='46' then 'Salomão Zoppi'
                        when dfv.value_text='47' then 'FEETA'	end as 'Cliente' #Nome do cliente com mensagem padrão
				, st.name as Mensagem #Mensagem padrão
				, case	when ts.name = 'closed successful' then 'Fechado com sucesso' 
						when ts.name = 'open' then 'Aberto'	else ts.name end as Estado
			from 
				 ticket_history as th #tabela de histórico do chamado
				 , ticket as t #tabela de chamados
				 , standard_template as st #tabela com as mensagens padrões
				 , ticket_state as ts #tabela com o estado de fechamento do chamado
				 , dynamic_field_value as dfv #tabela com o valor do campo dinâmico
				 , dynamic_field 	as df	#tabela com o campo dinâmico
			where 
				 th.name like 'ResponseTemplate%' #filtro na tabela de histórico para retornar apenas mensagem padrão  
				 and th.ticket_id = t.id #relacionamento implícito ticket_history com ticket
				 and t.ticket_state_id = ts.id #relacionamento implícito de ticket com ticket_state
				 and dfv.object_id	=	t.id #relacionamento de dynamic_field_value com dynamic_field
				 and (dfv.field_id 	= df.id and df.object_type = 'Ticket') #relacionamento de dynamic_field_id com dynamic_field para o objeto Ticket
				 and df.id = 4 #filtro para retorno de campo dinâmico referente a Cliente 
				 and st.id = LEFT(TRIM(LEADING 'ResponseTemplate ('FROM th.name),LOCATE('/',TRIM(LEADING 'ResponseTemplate (' FROM th.name))-1)  #Retorna o código da mensagem padrão na tabela de histórico para fazer o relacionamento implícito entre ticket_history e standard_template
			group by t.tn, st.name, case 	when ts.name = 'closed successful' then 'Fechado com sucesso' 
											when ts.name = 'open' then 'Aberto'	else ts.name end  
				, case	when dfv.value_text='1' then 'Itaú'
						when dfv.value_text='2' then 'Deloitte'
						when dfv.value_text='3' then 'IEL/PR'
						when dfv.value_text='4' then 'EY'
						when dfv.value_text='5' then 'Samsung'
						when dfv.value_text='6' then 'Porto Seguro'
						when dfv.value_text='7' then 'Cia de Talentos'
						when dfv.value_text='8' then 'CDB'
						when dfv.value_text='9' then 'Page Talent'
						when dfv.value_text='10' then 'Meta RH'
						when dfv.value_text='11' then 'Danone'
						when dfv.value_text='12' then 'Bimbo'
						when dfv.value_text='13' then 'Carpe Diem'
						when dfv.value_text='14' then 'Itrade'
						when dfv.value_text='15' then 'FFM'
						when dfv.value_text='16' then 'Oi'
						when dfv.value_text='17' then 'Tim'
						when dfv.value_text='18' then 'Vallourec'
						when dfv.value_text='19' then 'Scania'
						when dfv.value_text='20' then 'Zilor'
						when dfv.value_text='21' then 'Targo'
						when dfv.value_text='22' then 'Grupo Fleury'
						when dfv.value_text='23' then 'CV Novo'
						when dfv.value_text='24' then 'KPMG'
						when dfv.value_text='25' then 'John Deere'
						when dfv.value_text='26' then 'Nextel'
						when dfv.value_text='27' then 'Guarani'
						when dfv.value_text='28' then 'Teleperformance'
						when dfv.value_text='29' then 'Odebrecht'
						when dfv.value_text='30' then 'Sanofi'
						when dfv.value_text='31' then 'Albert Einstein'
						when dfv.value_text='32' then 'Trajetória RH'
						when dfv.value_text='33' then 'Unimed florianopolis'
						when dfv.value_text='34' then 'Hermes Pardini'
						when dfv.value_text='35' then 'Capgemini'
						when dfv.value_text='36' then 'Contax'	
						when dfv.value_text='37' then 'ONS'
						when dfv.value_text='38' then 'RH Inter'
						when dfv.value_text='39' then 'DASA'
						when dfv.value_text='40' then 'Padrão Removido'
						when dfv.value_text='41' then 'Rio 2016'
						when dfv.value_text='42' then 'Bosch'
						when dfv.value_text='43' then 'BRF'		
						when dfv.value_text='44' then 'Viva Talentos'	 
						when dfv.value_text='45' then 'CV por e-mail'	 
                        when dfv.value_text='46' then 'Salomão Zoppi'
                        when dfv.value_text='47' then 'FEETA'	end

		union all
				 
		#Chamados sem mensagem padrão:       
		  select distinct 
				 cast(max(th.change_time) as date) as DtAlteracao
				 , t.tn as Protocolo
				 , case	when dfv.value_text='1' then 'Itaú'
						when dfv.value_text='2' then 'Deloitte'
						when dfv.value_text='3' then 'IEL/PR'
						when dfv.value_text='4' then 'EY'
						when dfv.value_text='5' then 'Samsung'
						when dfv.value_text='6' then 'Porto Seguro'
						when dfv.value_text='7' then 'Cia de Talentos'
						when dfv.value_text='8' then 'CDB'
						when dfv.value_text='9' then 'Page Talent'
						when dfv.value_text='10' then 'Meta RH'
						when dfv.value_text='11' then 'Danone'
						when dfv.value_text='12' then 'Bimbo'
						when dfv.value_text='13' then 'Carpe Diem'
						when dfv.value_text='14' then 'Itrade'
						when dfv.value_text='15' then 'FFM'
						when dfv.value_text='16' then 'Oi'
						when dfv.value_text='17' then 'Tim'
						when dfv.value_text='18' then 'Vallourec'
						when dfv.value_text='19' then 'Scania'
						when dfv.value_text='20' then 'Zilor'
						when dfv.value_text='21' then 'Targo'
						when dfv.value_text='22' then 'Grupo Fleury'
						when dfv.value_text='23' then 'CV Novo'
						when dfv.value_text='24' then 'KPMG'
						when dfv.value_text='25' then 'John Deere'
						when dfv.value_text='26' then 'Nextel'
						when dfv.value_text='27' then 'Guarani'
						when dfv.value_text='28' then 'Teleperformance'
						when dfv.value_text='29' then 'Odebrecht'
						when dfv.value_text='30' then 'Sanofi'
						when dfv.value_text='31' then 'Albert Einstein'
						when dfv.value_text='32' then 'Trajetória RH'
						when dfv.value_text='33' then 'Unimed florianopolis'
						when dfv.value_text='34' then 'Hermes Pardini'
						when dfv.value_text='35' then 'Capgemini'
						when dfv.value_text='36' then 'Contax'	
						when dfv.value_text='37' then 'ONS'
						when dfv.value_text='38' then 'RH Inter'
						when dfv.value_text='39' then 'DASA'
						when dfv.value_text='40' then 'Padrão Removido'
						when dfv.value_text='41' then 'Rio 2016'
						when dfv.value_text='42' then 'Bosch'
						when dfv.value_text='43' then 'BRF'		
						when dfv.value_text='44' then 'Viva Talentos'	 
						when dfv.value_text='45' then 'CV por e-mail'	 
                        when dfv.value_text='46' then 'Salomão Zoppi'
                        when dfv.value_text='47' then 'FEETA'	end as 'Cliente'
				 , 'N/C' as Mensagem
				 , case when ts.name = 'closed successful' then 'Fechado com sucesso' 
						when ts.name = 'open' then 'Aberto'	else ts.name end as Estado
			from 
				 ticket_history as th
				 , ticket as t
				 , ticket_state as ts
				 , dynamic_field_value as dfv 
				 , dynamic_field 	as df	
			where 
				 th.ticket_id = t.id 
				 and t.ticket_state_id = ts.id
				 and dfv.object_id	=	t.id
				 and (dfv.field_id 	= df.id and df.object_type = 'Ticket')
				 and df.id = 4
				 and t.ticket_state_id in (2, 10, 11)   #estado de fechamento do chamado (Fechado com Sucesso, Remover, Duplicado)
				 and th.change_by != 1 #Chamado não tenha sido alterado pelo root
				 and t.tn not in #Cláusula que restringe que o número do chamado não deve estar no select interno abaixo
				 (		select distinct t.tn
						from 
							ticket_history as th
							, ticket as t
							, standard_template as st
						where 
							 th.name like 'ResponseTemplate%' 
							 and th.ticket_id = t.id 
							 and st.id = LEFT(TRIM(LEADING 'ResponseTemplate ('FROM th.name),LOCATE('/',TRIM(LEADING 'ResponseTemplate (' FROM th.name))-1)  
							 and t.ticket_state_id in (2, 10, 11)
							 and th.change_by != 1
				) 
		group by t.tn
				, case	when dfv.value_text='1' then 'Itaú'
						when dfv.value_text='2' then 'Deloitte'
						when dfv.value_text='3' then 'IEL/PR'
						when dfv.value_text='4' then 'EY'
						when dfv.value_text='5' then 'Samsung'
						when dfv.value_text='6' then 'Porto Seguro'
						when dfv.value_text='7' then 'Cia de Talentos'
						when dfv.value_text='8' then 'CDB'
						when dfv.value_text='9' then 'Page Talent'
						when dfv.value_text='10' then 'Meta RH'
						when dfv.value_text='11' then 'Danone'
						when dfv.value_text='12' then 'Bimbo'
						when dfv.value_text='13' then 'Carpe Diem'
						when dfv.value_text='14' then 'Itrade'
						when dfv.value_text='15' then 'FFM'
						when dfv.value_text='16' then 'Oi'
						when dfv.value_text='17' then 'Tim'
						when dfv.value_text='18' then 'Vallourec'
						when dfv.value_text='19' then 'Scania'
						when dfv.value_text='20' then 'Zilor'
						when dfv.value_text='21' then 'Targo'
						when dfv.value_text='22' then 'Grupo Fleury'
						when dfv.value_text='23' then 'CV Novo'
						when dfv.value_text='24' then 'KPMG'
						when dfv.value_text='25' then 'John Deere'
						when dfv.value_text='26' then 'Nextel'
						when dfv.value_text='27' then 'Guarani'
						when dfv.value_text='28' then 'Teleperformance'
						when dfv.value_text='29' then 'Odebrecht'
						when dfv.value_text='30' then 'Sanofi'
						when dfv.value_text='31' then 'Albert Einstein'
						when dfv.value_text='32' then 'Trajetória RH'
						when dfv.value_text='33' then 'Unimed florianopolis'
						when dfv.value_text='34' then 'Hermes Pardini'
						when dfv.value_text='35' then 'Capgemini'
						when dfv.value_text='36' then 'Contax'	
						when dfv.value_text='37' then 'ONS'
						when dfv.value_text='38' then 'RH Inter'
						when dfv.value_text='39' then 'DASA'
						when dfv.value_text='40' then 'Padrão Removido'
						when dfv.value_text='41' then 'Rio 2016'
						when dfv.value_text='42' then 'Bosch'
						when dfv.value_text='43' then 'BRF'		
						when dfv.value_text='44' then 'Viva Talentos'	 
						when dfv.value_text='45' then 'CV por e-mail'	 
                        when dfv.value_text='46' then 'Salomão Zoppi'
                        when dfv.value_text='47' then 'FEETA'	end 
                        , case	when ts.name = 'closed successful' then 'Fechado com sucesso' 
								when ts.name = 'open' then 'Aberto'	else ts.name end
		) as subquery
        where year(DtAlteracao) = ?
			  and month(DtAlteracao) = ?
			  #and Cliente in (ifnull(@Cliente, Cliente)) #multivalorado
			  #and Mensagem in (ifnull(@Mensagem, Mensagem)) #multivalorado
			  #and Estado in (ifnull(@Estado, Estado)) #multivalorado
		group by left(DtAlteracao, 7), Cliente, Mensagem, Estado
		order by left(DtAlteracao, 7) asc, Cliente asc, Mensagem asc;</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="Ano_Mes">
          <DataField>Ano/Mes</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Cliente">
          <DataField>Cliente</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Mensagem">
          <DataField>Mensagem</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Estado">
          <DataField>Estado</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Qtd_enviadas">
          <DataField>Qtd_enviadas</DataField>
          <rd:TypeName>System.Int64</rd:TypeName>
        </Field>
      </Fields>
      <Filters>
        <Filter>
          <FilterExpression>=Fields!Cliente.Value</FilterExpression>
          <Operator>In</Operator>
          <FilterValues>
            <FilterValue>=Parameters!Cliente.Value</FilterValue>
          </FilterValues>
        </Filter>
        <Filter>
          <FilterExpression>=Fields!Mensagem.Value</FilterExpression>
          <Operator>In</Operator>
          <FilterValues>
            <FilterValue>=Parameters!Mensagem.Value</FilterValue>
          </FilterValues>
        </Filter>
        <Filter>
          <FilterExpression>=Fields!Estado.Value</FilterExpression>
          <Operator>In</Operator>
          <FilterValues>
            <FilterValue>=Parameters!Estado.Value</FilterValue>
          </FilterValues>
        </Filter>
      </Filters>
    </DataSet>
    <DataSet Name="DATASET_Ano">
      <Query>
        <DataSourceName>OTRS</DataSourceName>
        <CommandText>select	distinct year(th.change_time) as Ano
from	ticket_history as th;</CommandText>
      </Query>
      <Fields>
        <Field Name="Ano">
          <DataField>Ano</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="DATASET_Mes">
      <Query>
        <DataSourceName>OTRS</DataSourceName>
        <CommandText>select 1 as id, 'Janeiro' as Mes
union
select 2, 'Fevereiro'
union
select 3, 'Março'
union
select 4, 'Abril'
union 
select 5, 'Maio'
union
select 6, 'Junho'
union 
select 7, 'Julho'
union
select 8, 'Agosto'
union 
select 9, 'Setembro'
union
select 10, 'Outubro'
union
select 11, 'Novembro'
union
select 12, 'Dezembro'</CommandText>
      </Query>
      <Fields>
        <Field Name="id">
          <DataField>id</DataField>
          <rd:TypeName>System.Int64</rd:TypeName>
        </Field>
        <Field Name="Mes">
          <DataField>Mes</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="DATASET_Clientes">
      <Query>
        <DataSourceName>OTRS</DataSourceName>
        <CommandText>select distinct
	case	when dfv.value_text='1' then 'Itaú'
			when dfv.value_text='2' then 'Deloitte'
			when dfv.value_text='3' then 'IEL/PR'
			when dfv.value_text='4' then 'EY'
			when dfv.value_text='5' then 'Samsung'
			when dfv.value_text='6' then 'Porto Seguro'
			when dfv.value_text='7' then 'Cia de Talentos'
			when dfv.value_text='8' then 'CDB'
			when dfv.value_text='9' then 'Page Talent'
			when dfv.value_text='10' then 'Meta RH'
			when dfv.value_text='11' then 'Danone'
			when dfv.value_text='12' then 'Bimbo'
			when dfv.value_text='13' then 'Carpe Diem'
			when dfv.value_text='14' then 'Itrade'
			when dfv.value_text='15' then 'FFM'
			when dfv.value_text='16' then 'Oi'
			when dfv.value_text='17' then 'Tim'
			when dfv.value_text='18' then 'Vallourec'
			when dfv.value_text='19' then 'Scania'
			when dfv.value_text='20' then 'Zilor'
			when dfv.value_text='21' then 'Targo'
			when dfv.value_text='22' then 'Grupo Fleury'
			when dfv.value_text='23' then 'CV Novo'
			when dfv.value_text='24' then 'KPMG'
			when dfv.value_text='25' then 'John Deere'
			when dfv.value_text='26' then 'Nextel'
			when dfv.value_text='27' then 'Guarani'
			when dfv.value_text='28' then 'Teleperformance'
			when dfv.value_text='29' then 'Odebrecht'
			when dfv.value_text='30' then 'Sanofi'
			when dfv.value_text='31' then 'Albert Einstein'
			when dfv.value_text='32' then 'Trajetória RH'
			when dfv.value_text='33' then 'Unimed florianopolis'
			when dfv.value_text='34' then 'Hermes Pardini'
			when dfv.value_text='35' then 'Capgemini'
			when dfv.value_text='36' then 'Contax'	
			when dfv.value_text='37' then 'ONS'
			when dfv.value_text='38' then 'RH Inter'
			when dfv.value_text='39' then 'DASA'
			when dfv.value_text='40' then 'Padrão Removido'
			when dfv.value_text='41' then 'Rio 2016'
			when dfv.value_text='42' then 'Bosch'
			when dfv.value_text='43' then 'BRF'		
			when dfv.value_text='44' then 'Viva Talentos'	 
			when dfv.value_text='45' then 'CV por e-mail'	 
            when dfv.value_text='46' then 'Salomão Zoppi'
			when dfv.value_text='47' then 'FEETA'	end as Nome_cliente
from	dynamic_field_value as dfv            
order by Nome_cliente asc;</CommandText>
      </Query>
      <Fields>
        <Field Name="Nome_cliente">
          <DataField>Nome_cliente</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="DATASET_Mensagem">
      <Query>
        <DataSourceName>OTRS</DataSourceName>
        <CommandText>select	st.name as Nome_Mensagem
from	standard_template as st
union all
select	'N/C'
order by Nome_Mensagem ;</CommandText>
      </Query>
      <Fields>
        <Field Name="Nome_Mensagem">
          <DataField>Nome_Mensagem</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="DATASET_Estado">
      <Query>
        <DataSourceName>OTRS</DataSourceName>
        <CommandText>select	case when ts.name = 'closed successful' then 'Fechado com sucesso' else ts.name end as Estado
from	ticket_state as ts
where	ts.id in (2, 10, 11)
order by Estado asc;</CommandText>
      </Query>
      <Fields>
        <Field Name="Estado">
          <DataField>Estado</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <ReportParameters>
    <ReportParameter Name="Ano">
      <DataType>String</DataType>
      <Prompt>Ano:</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>DATASET_Ano</DataSetName>
          <ValueField>Ano</ValueField>
          <LabelField>Ano</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="Mes">
      <DataType>String</DataType>
      <Prompt>Mes:</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>DATASET_Mes</DataSetName>
          <ValueField>id</ValueField>
          <LabelField>Mes</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="Cliente">
      <DataType>String</DataType>
      <Prompt>Cliente:</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>DATASET_Clientes</DataSetName>
          <ValueField>Nome_cliente</ValueField>
          <LabelField>Nome_cliente</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
    <ReportParameter Name="Mensagem">
      <DataType>String</DataType>
      <Prompt>Mensagem:</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>DATASET_Mensagem</DataSetName>
          <ValueField>Nome_Mensagem</ValueField>
          <LabelField>Nome_Mensagem</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
    <ReportParameter Name="Estado">
      <DataType>String</DataType>
      <Prompt>Estado:</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>DATASET_Estado</DataSetName>
          <ValueField>Estado</ValueField>
          <LabelField>Estado</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
  </ReportParameters>
  <Language>en-US</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportUnitType>Cm</rd:ReportUnitType>
  <rd:ReportID>64b092fe-a3c1-44fc-bcab-8fdca6bd57a6</rd:ReportID>
</Report>